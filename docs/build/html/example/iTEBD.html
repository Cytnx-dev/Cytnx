
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    
    <title>2. iTEBD &#8212; Cytnx  documentation</title>

    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-4.3.1-dist/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinxbootstrap4.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/bootstrap-4.3.1-dist/js/bootstrap.min.js"></script>
    <script src="../_static/sphinxbootstrap4.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. DMRG" href="DMRG.html" />
    <link rel="prev" title="1. Exact Diagonalization" href="ED.html" /> 
  </head><body>
  <nav class="navbar navbar-expand-md  fixed-top navbar-dark bg-dark flex-wrap">
    <button class="navbar-toggler ml-auto py-2" type="button" data-toggle="collapse" data-target="#exCollapsingNavbar2">
      &#9776;
    </button>
      <div class="navbar-collapse collapse" id="exCollapsingNavbar2">
           <a class="navbar-brand py-1" href="../index.html">
              <img class="logo" src="../_static/Icon_i.png" alt="Cytnx"/>
          </a>
          <ul class="navbar-nav mr-auto">
          
              <li class="nav-item dropdown d-none d-sm-block" id="navbar-pages">
                  <a class="nav-link dropdown-toggle" data-toggle="dropdown">Pages</a>
                  <ul class="dropdown-menu">
                  <ul>
<li class="toctree-l1"><a class="reference internal" href="../Intro.html">Introdoction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Intro.html#features">Features</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install Cytnx</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#conda-install">Conda install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#using-python-api">Using python API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#using-c-api">Using C++ API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#using-c-api-with-cmake">Using C++ API with CMake</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#build-cytnx-from-source">Build Cytnx from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#using-anaconda-conda-for-deps">Using anaconda/conda for deps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#compiling-process-auto-set-up">Compiling process [Auto set-up]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#compiling-process-manually-set-up">Compiling process [manually set-up]</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Guide.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guide/behavior.html">1. Objects behavior</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/behavior.html#everything-is-reference">1.1. Everything is reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/behavior.html#clone">1.2. clone</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/basic_obj/Tensor.html">2. Tensor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html">2.1. Create a Tensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#tensor-with-different-dtype-and-device">2.1.1. Tensor with different dtype and device</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#type-conversion">2.1.2. Type conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#transfer-btwn-devices">2.1.3. Transfer btwn devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#tensor-from-storage-v0-6-6">2.1.4. Tensor from Storage [v0.6.6+]</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_2_manip.html">2.2. Manipulate Tensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_2_manip.html#reshape">2.2.1. reshape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_2_manip.html#permute">2.2.2. permute</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html">2.3. Access elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html#get-elements">2.3.1. Get elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html#set-elememts">2.3.2. Set elememts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html#low-level-api-c-only">2.3.3. Low-level API (C++ only)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html">2.4. Tensor arithmetic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#type-promotion">2.4.1. Type promotion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#tensor-scalar-arithmetic">2.4.2. Tensor-scalar arithmetic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#tensor-tensor-arithmetic">2.4.3. Tensor-Tensor arithmetic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#equivalent-apis-c-only">2.4.4. Equivalent APIs (C++ only)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_5_numpy.html">2.5. To/From numpy.array</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_6_app.html">2.6. Append elements</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_7_io.html">2.7. Save/Load</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_7_io.html#save-a-tensor">2.7.1. Save a Tensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_7_io.html#load-a-tensor">2.7.2. Load a Tensor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_8_cp.html">2.8. When will data be copied?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_8_cp.html#reference-copy-of-object">2.8.1. Reference &amp; Copy of object</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_8_cp.html#permute">2.8.2. Permute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_8_cp.html#contiguous">2.8.3. Contiguous</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_8_cp.html#reshape">2.8.4. Reshape</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/basic_obj/Storage.html">3. Storage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html">3.1. Create a Storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html#type-conversion">3.1.1. Type conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html#transfer-btwn-devices">3.1.2. Transfer btwn devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html#get-storage-of-tensor">3.1.3. Get Storage of Tensor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_2_access.html">3.2. Access elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_2_access.html#get-set-element">3.2.1. Get/Set element</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_2_access.html#get-raw-pointer-c-only">3.2.2. Get raw-pointer (C++ only)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_3_expand.html">3.3. Increase size</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_3_expand.html#append">3.3.1. Append</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_3_expand.html#resize">3.3.2. Resize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_4_vec.html">3.4. From c++.vector</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html">3.5. Save/Load</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html#save-a-storage">3.5.1. Save a Storage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html#load-a-storage">3.5.2. Load a Storage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html#save-load-from-to-binary-only">3.5.3. save &amp; load from/to binary only</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/basic_obj/Scalar.html">4. Scalar</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Scalar.html#define-declare-a-scalar">4.1. Define/Declare a scalar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Scalar.html#change-data-type">4.2. Change data type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Scalar.html#application-scenarios">4.3. Application scenarios</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/linalg.html">5. Linear algebra</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/itersol.html">6. Iterative solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/itersol/LinOp.html">6.1. LinOp class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#pass-a-function">6.1.1. Pass a function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#inherit-the-linop-class">6.1.2. Inherit the LinOp class</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#ex-sparse-data-structure-with-mapping-function">6.1.3. Ex: sparse data structure with mapping function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#prestore-preconstruct-sparse-elements">6.1.4. Prestore/preconstruct sparse elements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/itersol/Lanczos.html">6.2. Lanczos solver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/cyx.html">7. Cytnx extensions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/TNotation.html">7.1. Tensor Notation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/TNotation.html#tensor-contraction">7.1.1. Tensor Contraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/TNotation.html#direction-of-bond">7.1.2. Direction of bond</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/Bond.html">7.2. Bond</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/Bond.html#create-a-bond">7.2.1. Create a Bond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/Bond.html#bond-with-direction">7.2.2. Bond with direction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/Bond.html#bond-with-symmetry">7.2.3. Bond with Symmetry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/Bond.html#multiple-symmetry">7.2.4. Multiple Symmetry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/UniTensor.html">7.3. UniTensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/UniTensor_create.html">7.3.1. Create UniTensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/UniTensor_getblk.html">7.3.2. Accessing the block(s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/UniTensor_tag.html">7.3.3. tagged UniTensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/UniTensor_manip.html">7.3.4. Manipulate UniTensor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/Network.html">7.4. Network</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/xlinalg.html">8. linalg extension</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../Examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ED.html">1. Exact Diagonalization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ED.html#bit-representation-of-basis-states">1.1. Bit representation of basis states</a></li>
<li class="toctree-l3"><a class="reference internal" href="ED.html#implementation">1.2. Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="ED.html#results">1.3. Results</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2. iTEBD</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#imaginary-time-evolution">2.1. Imaginary time evolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-procedure">2.2. Update procedure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="DMRG.html">3. DMRG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="DMRG.html#the-model-xy-chain">3.1. The model– XY chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="DMRG.html#basic-components">3.2. Basic components</a></li>
<li class="toctree-l3"><a class="reference internal" href="DMRG.html#preparing-the-mpo">3.3. Preparing the MPO</a></li>
<li class="toctree-l3"><a class="reference internal" href="DMRG.html#preparing-the-mps-and-enviroments">3.4. Preparing the MPS and enviroments</a></li>
<li class="toctree-l3"><a class="reference internal" href="DMRG.html#optimization-of-mps-update-sweep">3.5. Optimization of MPS (update sweep)</a></li>
<li class="toctree-l3"><a class="reference internal" href="DMRG.html#results">3.6. Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="iDMRG.html">4. iDMRG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="iDMRG.html#initialization">4.1. Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="iDMRG.html#update-procedure">4.2. Update procedure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="HOTRG.html">5. HOTRG</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Perf_tune.html">Performance tune</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../perf_tune/tensordot.html">Tensordot with input cache</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://kaihsin.github.io/Cytnx/docs/html/index.html">API Documentations</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/kaihsin/Cytnx">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1vuc_fTbwkL5t52glzvJ0nNRLPZxj5en6/view?usp=sharing">5-mins Blitz intro slide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Developer.html">Developer</a></li>
</ul>

                  </ul>
              </li>
              <li class="nav-item">
              
                  <a  class="nav-link" href="https://kaihsin.github.io/Cytnx/docs/html/index.html">API Doc</a></li>
              <li class="nav-item">
              
                  <a  class="nav-link" href="https://github.com/kaihsin/Cytnx">Github</a></li>
              <li class="nav-item">
              <a  class="nav-link" href="../%23.html">v0.7.3a</a></li>
          </ul>
          <div class="dropdown-divider d-block d-sm-none mb-4"></div>
             
<form class="form-inline" action="../search.html" method="get">
  <input type="text" name="q" class="form-control" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <!--<div class="row hidden-sm-up">
          <div class="collapse navbar-toggleable-xs container" id="exCollapsingNavbar2">
              <div class="container">
             　　 <a class="navbar-brand" href="../index.html">
                      <img class="logo" src="../_static/Icon_i.png" alt="Cytnx"/>
                  </a>
              </div>
              <ul class="nav navbar-nav">
                  <li>
                  
                      <a  class="nav-link" href="https://kaihsin.github.io/Cytnx/docs/html/index.html">API Doc</a></li>
                  <li>
                  
                      <a  class="nav-link" href="https://github.com/kaihsin/Cytnx">Github</a></li>
                  <li>
                  <a  class="nav-link" href="../%23.html">v0.7.3a</a></li>
              </ul>
              <div class="dropdown-divider"></div>
              <div class="navbar-text">search<div>
              
<form class="form-inline" action="../search.html" method="get">
  <input type="text" name="q" class="form-control" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          </div>
      </div>-->
    </nav>
  </div>

    <div class="related d-flex justify-content-between bg-light flex-wrap" role="navigation" aria-label="related navigation">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="../index.html">Cytnx  documentation</a></li>
                <li class="breadcrumb-item"><a href="../Examples.html"
                       
                         accesskey="U"
                         class="active"
                       >Examples</a></li>
            <li class="breadcrumb-item active"><span class="section-number">2. </span>iTEBD</li>
        </ol>
       <div>
          <div class="btn-group btn-group-sm" role="group" aria-label="Basic example">
               <a href="ED.html" title="Previous Chapter: 1. Exact Diagonalization" class="btn btn-primary" role="botton" accesskey="P">
                   &laquo; 1. Exact Diag...
               </a>
               <a href="DMRG.html" title="Next Chapter: 3. DMRG" class="btn btn-primary" role="botton" accesskey="N">
                   3. DMRG &raquo;
               </a>
           </div>
       </div>
    </div>

  <div class="main container-fluid">
    <div class="row"> 
      <div class="sphinxsidebar d-none d-md-block">
        <div class="sphinxsidebarwrapper">          
            <h4>Table Of Contents</h4>
            
            
              <div class="sidebartoctree">
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../Intro.html">Introdoction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Intro.html#features">Features</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install Cytnx</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#conda-install">Conda install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#using-python-api">Using python API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#using-c-api">Using C++ API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#using-c-api-with-cmake">Using C++ API with CMake</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#build-cytnx-from-source">Build Cytnx from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#using-anaconda-conda-for-deps">Using anaconda/conda for deps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#compiling-process-auto-set-up">Compiling process [Auto set-up]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#compiling-process-manually-set-up">Compiling process [manually set-up]</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Guide.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guide/behavior.html">1. Objects behavior</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/behavior.html#everything-is-reference">1.1. Everything is reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/behavior.html#clone">1.2. clone</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/basic_obj/Tensor.html">2. Tensor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html">2.1. Create a Tensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#tensor-with-different-dtype-and-device">2.1.1. Tensor with different dtype and device</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#type-conversion">2.1.2. Type conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#transfer-btwn-devices">2.1.3. Transfer btwn devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#tensor-from-storage-v0-6-6">2.1.4. Tensor from Storage [v0.6.6+]</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_2_manip.html">2.2. Manipulate Tensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_2_manip.html#reshape">2.2.1. reshape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_2_manip.html#permute">2.2.2. permute</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html">2.3. Access elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html#get-elements">2.3.1. Get elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html#set-elememts">2.3.2. Set elememts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html#low-level-api-c-only">2.3.3. Low-level API (C++ only)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html">2.4. Tensor arithmetic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#type-promotion">2.4.1. Type promotion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#tensor-scalar-arithmetic">2.4.2. Tensor-scalar arithmetic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#tensor-tensor-arithmetic">2.4.3. Tensor-Tensor arithmetic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#equivalent-apis-c-only">2.4.4. Equivalent APIs (C++ only)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_5_numpy.html">2.5. To/From numpy.array</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_6_app.html">2.6. Append elements</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_7_io.html">2.7. Save/Load</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_7_io.html#save-a-tensor">2.7.1. Save a Tensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_7_io.html#load-a-tensor">2.7.2. Load a Tensor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_8_cp.html">2.8. When will data be copied?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_8_cp.html#reference-copy-of-object">2.8.1. Reference &amp; Copy of object</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_8_cp.html#permute">2.8.2. Permute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_8_cp.html#contiguous">2.8.3. Contiguous</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_8_cp.html#reshape">2.8.4. Reshape</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/basic_obj/Storage.html">3. Storage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html">3.1. Create a Storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html#type-conversion">3.1.1. Type conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html#transfer-btwn-devices">3.1.2. Transfer btwn devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html#get-storage-of-tensor">3.1.3. Get Storage of Tensor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_2_access.html">3.2. Access elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_2_access.html#get-set-element">3.2.1. Get/Set element</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_2_access.html#get-raw-pointer-c-only">3.2.2. Get raw-pointer (C++ only)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_3_expand.html">3.3. Increase size</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_3_expand.html#append">3.3.1. Append</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_3_expand.html#resize">3.3.2. Resize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_4_vec.html">3.4. From c++.vector</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html">3.5. Save/Load</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html#save-a-storage">3.5.1. Save a Storage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html#load-a-storage">3.5.2. Load a Storage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html#save-load-from-to-binary-only">3.5.3. save &amp; load from/to binary only</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/basic_obj/Scalar.html">4. Scalar</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Scalar.html#define-declare-a-scalar">4.1. Define/Declare a scalar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Scalar.html#change-data-type">4.2. Change data type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Scalar.html#application-scenarios">4.3. Application scenarios</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/linalg.html">5. Linear algebra</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/itersol.html">6. Iterative solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/itersol/LinOp.html">6.1. LinOp class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#pass-a-function">6.1.1. Pass a function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#inherit-the-linop-class">6.1.2. Inherit the LinOp class</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#ex-sparse-data-structure-with-mapping-function">6.1.3. Ex: sparse data structure with mapping function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#prestore-preconstruct-sparse-elements">6.1.4. Prestore/preconstruct sparse elements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/itersol/Lanczos.html">6.2. Lanczos solver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/cyx.html">7. Cytnx extensions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/TNotation.html">7.1. Tensor Notation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/TNotation.html#tensor-contraction">7.1.1. Tensor Contraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/TNotation.html#direction-of-bond">7.1.2. Direction of bond</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/Bond.html">7.2. Bond</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/Bond.html#create-a-bond">7.2.1. Create a Bond</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/Bond.html#bond-with-direction">7.2.2. Bond with direction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/Bond.html#bond-with-symmetry">7.2.3. Bond with Symmetry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/Bond.html#multiple-symmetry">7.2.4. Multiple Symmetry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/UniTensor.html">7.3. UniTensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/UniTensor_create.html">7.3.1. Create UniTensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/UniTensor_getblk.html">7.3.2. Accessing the block(s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/UniTensor_tag.html">7.3.3. tagged UniTensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/UniTensor_manip.html">7.3.4. Manipulate UniTensor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/Network.html">7.4. Network</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/xlinalg.html">8. linalg extension</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../Examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ED.html">1. Exact Diagonalization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ED.html#bit-representation-of-basis-states">1.1. Bit representation of basis states</a></li>
<li class="toctree-l3"><a class="reference internal" href="ED.html#implementation">1.2. Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="ED.html#results">1.3. Results</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2. iTEBD</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#imaginary-time-evolution">2.1. Imaginary time evolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-procedure">2.2. Update procedure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="DMRG.html">3. DMRG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="DMRG.html#the-model-xy-chain">3.1. The model– XY chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="DMRG.html#basic-components">3.2. Basic components</a></li>
<li class="toctree-l3"><a class="reference internal" href="DMRG.html#preparing-the-mpo">3.3. Preparing the MPO</a></li>
<li class="toctree-l3"><a class="reference internal" href="DMRG.html#preparing-the-mps-and-enviroments">3.4. Preparing the MPS and enviroments</a></li>
<li class="toctree-l3"><a class="reference internal" href="DMRG.html#optimization-of-mps-update-sweep">3.5. Optimization of MPS (update sweep)</a></li>
<li class="toctree-l3"><a class="reference internal" href="DMRG.html#results">3.6. Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="iDMRG.html">4. iDMRG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="iDMRG.html#initialization">4.1. Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="iDMRG.html#update-procedure">4.2. Update procedure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="HOTRG.html">5. HOTRG</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Perf_tune.html">Performance tune</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../perf_tune/tensordot.html">Tensordot with input cache</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://kaihsin.github.io/Cytnx/docs/html/index.html">API Documentations</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/kaihsin/Cytnx">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1vuc_fTbwkL5t52glzvJ0nNRLPZxj5en6/view?usp=sharing">5-mins Blitz intro slide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Developer.html">Developer</a></li>
</ul>

              </div>
            
          
  <h4>Previous topic</h4>
  <p class="topless"><a href="ED.html"
                        title="previous chapter"><span class="section-number">1. </span>Exact Diagonalization</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="DMRG.html"
                        title="next chapter"><span class="section-number">3. </span>DMRG</a></p>
<div id="searchbox" style="display: none">
    <form class="form search" action="../search.html" method="get">
      <input type="text" name="q" class="form-control" placeholder="Search..." />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>

<script type="text/javascript">$('#searchbox').show(0);</script>
  <ul class="this-page-menu list-unstyled text-right">
    <li><a href="../_sources/example/iTEBD.rst.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
        </div>
      </div> 

      <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="itebd">
<h1><span class="section-number">2. </span>iTEBD<a class="headerlink" href="#itebd" title="Permalink to this headline">¶</a></h1>
<p><strong>By : Hsu Ke, Kai-Hsin Wu</strong></p>
<p>Time evolution block decimation is one of the most simple and sucessful Tensor network method <a class="bibtex reference internal" href="#itebd-vidal" id="id1">[Vid07]</a>. The core concept of this algorithm is to use the imaginary time evolution to find the best variational ansatz, usually in terms of Matrix product state (MPS).</p>
<p>Here, we use a 1D transverse field Ising model (TFIM) as a simple example to show how to implement iTEBD algorithm in Cytnx and get the infinite system size (variational) ground state.</p>
<p>Consider the Hamiltonain of TFIM:</p>
<div class="math">
<p><img src="../_images/math/3a80d325383b0e507f20ffe9fccf30dd2b64a1ea.png" alt="H = J\sum_{ij} \sigma^{z}_i\sigma^{z}_j - H_x\sum_i \sigma^{x}_i"/></p>
</div><p>where <img class="math" src="../_images/math/ce3f0bb97c9c7f72ed406b3c0d9940a240b13304.png" alt="\sigma^{x,z}"/> are the pauli matrices.
The infinite size ground state can be represent by MPS as variational ansatz, where the <em>virtual bonds</em> dimension <img class="math" src="../_images/math/52b130781cb6e2b47a5efb235ac1cb4162210d12.png" alt="\chi"/> effectively controls the number of variational parameters (shown as orange bonds), and the <em>physical bonds</em> dimension <img class="math" src="../_images/math/badad346f6fbe2e237af99bfbd9a93a4da53a3da.png" alt="d"/> is the real physical dimension (shown as the blue bonds. Here, for Ising spins <img class="math" src="../_images/math/70c185d024e038ba37d7018dc84eefd8616db41a.png" alt="d=2"/>).</p>
<p>Because the system has translational invariant, thus it is legit to choose unit-cell consist with two sites, and the infinite system ground state can be represented with only two sites MPS with local tensors <img class="math" src="../_images/math/17ca72775d1128f2596ed085770dff83acf1994d.png" alt="\Gamma_A"/> and <img class="math" src="../_images/math/bd37fd9ad58efa5555782b2dbfcdd4361959155c.png" alt="\Gamma_B"/> associate with the schmit basis and <img class="math" src="../_images/math/ae4a4ff6a04edd704c3af024c35da4d525293ff1.png" alt="\lambda_A"/>, <img class="math" src="../_images/math/2aabf014844c25aea519f1a026c22dc9db822208.png" alt="\lambda_B"/> are the diagonal matrices of Schmidt coefficients as shown in the following:</p>
<a class="reference internal image-reference" href="../_images/itebd_MPS.png"><img alt="../_images/itebd_MPS.png" class="align-center" src="../_images/itebd_MPS.png" style="width: 600px;" /></a>
<p>Let’s first create this two-site  MPS wave function (here, we set virtual bond dimension <img class="math" src="../_images/math/8abc784ccde5e4b0b30fdb7d8343db21c4a06bd6.png" alt="\chi = 10"/> as example)</p>
<ul class="simple">
<li><p>In python</p></li>
</ul>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cytnx</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">chi</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">UniTensor</span><span class="p">([</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">UniTensor</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">bonds</span><span class="p">(),</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="n">random</span><span class="o">.</span><span class="n">Make_normal</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">get_block_</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">random</span><span class="o">.</span><span class="n">Make_normal</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">get_block_</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">A</span><span class="o">.</span><span class="n">print_diagram</span><span class="p">()</span>
<span class="n">B</span><span class="o">.</span><span class="n">print_diagram</span><span class="p">()</span>

<span class="n">la</span> <span class="o">=</span> <span class="n">UniTensor</span><span class="p">([</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span><span class="n">is_diag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">lb</span> <span class="o">=</span> <span class="n">UniTensor</span><span class="p">([</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span><span class="n">is_diag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">la</span><span class="o">.</span><span class="n">put_block</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="n">chi</span><span class="p">))</span>
<span class="n">lb</span><span class="o">.</span><span class="n">put_block</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="n">chi</span><span class="p">))</span>

<span class="n">la</span><span class="o">.</span><span class="n">print_diagram</span><span class="p">()</span>
<span class="n">lb</span><span class="o">.</span><span class="n">print_diagram</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><p>In c++</p></li>
</ul>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cytnx.hpp&quot;</span><span class="cp"></span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">cytnx</span><span class="p">;</span>

<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">chi</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="k">auto</span> <span class="n">A</span> <span class="o">=</span> <span class="n">UniTensor</span><span class="p">({</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">)},{</span><span class="mi">-1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">-2</span><span class="p">},</span><span class="mi">1</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">B</span> <span class="o">=</span> <span class="n">UniTensor</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">bonds</span><span class="p">(),{</span><span class="mi">-3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">-4</span><span class="p">},</span><span class="mi">1</span><span class="p">);</span>
<span class="n">random</span><span class="o">::</span><span class="n">Make_normal</span><span class="p">(</span><span class="n">B</span><span class="p">.</span><span class="n">get_block_</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">);</span>
<span class="n">random</span><span class="o">::</span><span class="n">Make_normal</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">get_block_</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">);</span>
<span class="n">A</span><span class="p">.</span><span class="n">print_diagram</span><span class="p">();</span>
<span class="n">B</span><span class="p">.</span><span class="n">print_diagram</span><span class="p">();</span>

<span class="k">auto</span> <span class="n">la</span> <span class="o">=</span> <span class="n">UniTensor</span><span class="p">({</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">)},{</span><span class="mi">-2</span><span class="p">,</span><span class="mi">-3</span><span class="p">},</span><span class="mi">1</span><span class="p">,</span><span class="n">Type</span><span class="p">.</span><span class="n">Double</span><span class="p">,</span><span class="n">Device</span><span class="p">.</span><span class="n">cpu</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">lb</span> <span class="o">=</span> <span class="n">UniTensor</span><span class="p">({</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">)},{</span><span class="mi">-4</span><span class="p">,</span><span class="mi">-5</span><span class="p">},</span><span class="mi">1</span><span class="p">,</span><span class="n">Type</span><span class="p">.</span><span class="n">Double</span><span class="p">,</span><span class="n">Device</span><span class="p">.</span><span class="n">cpu</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
<span class="n">la</span><span class="p">.</span><span class="n">put_block</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="n">chi</span><span class="p">));</span>
<span class="n">lb</span><span class="p">.</span><span class="n">put_block</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="n">chi</span><span class="p">));</span>

<span class="n">la</span><span class="p">.</span><span class="n">print_diagram</span><span class="p">();</span>
<span class="n">lb</span><span class="p">.</span><span class="n">print_diagram</span><span class="p">();</span>
</pre></div>
</td></tr></table></div>
<p>Output &gt;&gt;</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-----------------------
tensor Name :
tensor Rank : 3
block_form  : false
is_diag     : False
on device   : cytnx device: CPU
            -------------
           /             \
    -1 ____| 10        2 |____ 0
           |             |
           |          10 |____ -2
           \             /
            -------------
-----------------------
tensor Name :
tensor Rank : 3
block_form  : false
is_diag     : False
on device   : cytnx device: CPU
            -------------
           /             \
    -3 ____| 10        2 |____ 1
           |             |
           |          10 |____ -4
           \             /
            -------------
-----------------------
tensor Name :
tensor Rank : 2
block_form  : false
is_diag     : True
on device   : cytnx device: CPU
            -------------
           /             \
    -2 ____| 10       10 |____ -3
           \             /
            -------------
-----------------------
tensor Name :
tensor Rank : 2
block_form  : false
is_diag     : True
on device   : cytnx device: CPU
            -------------
           /             \
    -4 ____| 10       10 |____ -5
           \             /
            -------------
</pre></div>
</div>
<p>Here, we use <strong>random::Make_normal</strong> to initialize the elements of UniTensor <em>A</em> and <em>B</em> with normal distribution as initial MPS wavefuncion.
The <em>la</em>, <em>lb</em> are the weight matrix (schmit coefficients), hence only diagonal elements contains non-zero values. Thus, we set <strong>is_diag=True</strong> to only store diagonal entries.
We then initialize the elements to be all one for this weight matrices.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In general, there are other ways you can set-up a trial initial MPS wavefunction, as long as not all the elements are zero.</p>
</div>
<div class="section" id="imaginary-time-evolution">
<h2><span class="section-number">2.1. </span>Imaginary time evolution<a class="headerlink" href="#imaginary-time-evolution" title="Permalink to this headline">¶</a></h2>
<p>To optimize the MPS for the ground state wave function, in TEBD, we perform imaginary time evolution with Hamiltonian <img class="math" src="../_images/math/cb5de54f699cf4b3c7c1a3e87313d11d536c0d88.png" alt="H"/> with evolution operator <img class="math" src="../_images/math/fcedc25030b70c3797d0cea5c3d331d0bcaa32f9.png" alt="e^{\tau H}"/>.
The manybody Hamiltonian is then decomposed into local two-sites evolution operator (or sometimes also called gate in quantum computation language) via
Trotter-Suzuki decomposition, where <img class="math" src="../_images/math/3d84f2bb873798ab8373c8e1116b97b17150dcfc.png" alt="U = e^{\tau H} \approx e^{\delta \tau H_{a}}e^{\delta \tau H_{b}} \cdots = U_a U_b"/>, <img class="math" src="../_images/math/73a9fe327915a6411d5622c6cc395603e0a14a2c.png" alt="U_{a,b} = e^{\delta \tau H_{a,b}}"/> are the local evolution operators with <img class="math" src="../_images/math/a8144f0742116176fb284b1b86e67a94d7900596.png" alt="H_a"/> and <img class="math" src="../_images/math/a2e069526944114f5a7fecaac2e260cb4fb043fe.png" alt="H_b"/> are the local two sites operator:</p>
<div class="math">
<p><img src="../_images/math/35c71ae8d4959b8284e0f147b27600b369e9c92e.png" alt="H_{a,b} = J\sigma^{z}_{A,B}\sigma^{z}_{B,A} - \frac{H_x}{2}(\sigma^{x}_A + \sigma^{x}_B)"/></p>
</div><p>This is equivalent as acting theses two-site gates consecutively on the MPS, which in terms of tensor notation looks like following Figure(a):</p>
<a class="reference internal image-reference" href="../_images/itebd_upd.png"><img alt="../_images/itebd_upd.png" class="align-center" src="../_images/itebd_upd.png" style="width: 500px;" /></a>
<p>Since we represent this infinite system MPS using the translational invariant, the Figure(a) can be further simplified into two step.
First, acting <img class="math" src="../_images/math/2363059a61e3ed5453b95a6de83aad3f7525f156.png" alt="U_a"/> as shown in Figure(1) then acting <img class="math" src="../_images/math/d1585c1af4e036c3f5a0e577a2a8fdc54953a8c7.png" alt="U_b"/> as shown in Figure(2). This two procedures then repeat until the energy is converged.</p>
<p>Here, let’s construct this imaginary time evolution operator with parameter <img class="math" src="../_images/math/636cc35d45eb12a3401c57f100a3c446f25b5953.png" alt="J=-1"/>, <img class="math" src="../_images/math/b83617f1d6b91090379d598d42a3bf0c56ca690f.png" alt="H_x = -0.3"/> and (imaginary) time step <img class="math" src="../_images/math/1aae7466a9f6dd8274ba90a156145c6d97b5e28d.png" alt="\delta \tau = 0.1"/></p>
<ul class="simple">
<li><p>In python</p></li>
</ul>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">J</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
<span class="n">Hx</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="c1">## Create single site operator</span>
<span class="n">Sz</span> <span class="o">=</span> <span class="n">physics</span><span class="o">.</span><span class="n">pauli</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">()</span>
<span class="n">Sx</span> <span class="o">=</span> <span class="n">physics</span><span class="o">.</span><span class="n">pauli</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">()</span>
<span class="n">I</span>  <span class="o">=</span> <span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Sz</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Sx</span><span class="p">)</span>


<span class="c1">## Construct the local Hamiltonian</span>
<span class="n">TFterm</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">Kron</span><span class="p">(</span><span class="n">Sx</span><span class="p">,</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">linalg</span><span class="o">.</span><span class="n">Kron</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">Sx</span><span class="p">)</span>
<span class="n">ZZterm</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">Kron</span><span class="p">(</span><span class="n">Sz</span><span class="p">,</span><span class="n">Sz</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">Hx</span><span class="o">*</span><span class="n">TFterm</span> <span class="o">+</span> <span class="n">J</span><span class="o">*</span><span class="n">ZZterm</span>
<span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>


<span class="c1">## Build Evolution Operator</span>
<span class="n">eH</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">ExpH</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="o">-</span><span class="n">dt</span><span class="p">)</span> <span class="c1">## or equivantly ExpH(-dt*H)</span>
<span class="n">eH</span><span class="o">.</span><span class="n">reshape_</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">UniTensor</span><span class="p">(</span><span class="n">eH</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">U</span><span class="o">.</span><span class="n">print_diagram</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><p>In c++</p></li>
</ul>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">double</span> <span class="n">J</span> <span class="o">=</span> <span class="mf">-1.0</span><span class="p">;</span>
<span class="kt">double</span> <span class="n">Hx</span> <span class="o">=</span> <span class="mf">-0.3</span><span class="p">;</span>
<span class="kt">double</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>

<span class="c1">// Create single site operator</span>
<span class="k">auto</span> <span class="n">Sz</span> <span class="o">=</span> <span class="n">physics</span><span class="o">::</span><span class="n">pauli</span><span class="p">(</span><span class="sc">&#39;z&#39;</span><span class="p">).</span><span class="n">real</span><span class="p">();</span>
<span class="k">auto</span> <span class="n">Sx</span> <span class="o">=</span> <span class="n">physics</span><span class="o">::</span><span class="n">pauli</span><span class="p">(</span><span class="sc">&#39;x&#39;</span><span class="p">).</span><span class="n">real</span><span class="p">();</span>
<span class="k">auto</span> <span class="n">I</span>  <span class="o">=</span> <span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Sz</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Sx</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>


<span class="c1">// Construct the local Hamiltonian</span>
<span class="k">auto</span> <span class="n">TFterm</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">::</span><span class="n">Kron</span><span class="p">(</span><span class="n">Sx</span><span class="p">,</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">linalg</span><span class="o">::</span><span class="n">Kron</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">Sx</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">ZZterm</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">::</span><span class="n">Kron</span><span class="p">(</span><span class="n">Sz</span><span class="p">,</span><span class="n">Sz</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">H</span> <span class="o">=</span> <span class="n">Hx</span><span class="o">*</span><span class="n">TFterm</span> <span class="o">+</span> <span class="n">J</span><span class="o">*</span><span class="n">ZZterm</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">H</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>


<span class="c1">// Build Evolution Operator</span>
<span class="c1">// [Note] eH is cytnx.Tensor and U is UniTensor.</span>
<span class="k">auto</span> <span class="n">eH</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">::</span><span class="n">ExpH</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="o">-</span><span class="n">dt</span><span class="p">);</span> <span class="c1">//or equivantly ExpH(-dt*H)</span>
<span class="n">eH</span><span class="p">.</span><span class="n">reshape_</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">U</span> <span class="o">=</span> <span class="n">UniTensor</span><span class="p">(</span><span class="n">eH</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">U</span><span class="p">.</span><span class="n">print_diagram</span><span class="p">();</span>
</pre></div>
</td></tr></table></div>
<p>Output&gt;&gt;</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Total elem: 4
type  : Double (Float64)
cytnx device: CPU
Shape : (2,2)
[[1.00000e+00 0.00000e+00 ]
 [0.00000e+00 -1.00000e+00 ]]


Total elem: 4
type  : Double (Float64)
cytnx device: CPU
Shape : (2,2)
[[0.00000e+00 1.00000e+00 ]
 [1.00000e+00 0.00000e+00 ]]


Total elem: 16
type  : Double (Float64)
cytnx device: CPU
Shape : (4,4)
[[-1.00000e+00 3.00000e-01 3.00000e-01 0.00000e+00 ]
 [3.00000e-01 1.00000e+00 0.00000e+00 3.00000e-01 ]
 [3.00000e-01 0.00000e+00 1.00000e+00 3.00000e-01 ]
 [0.00000e+00 3.00000e-01 3.00000e-01 -1.00000e+00 ]]

-----------------------
tensor Name :
tensor Rank : 4
block_form  : false
is_diag     : False
on device   : cytnx device: CPU
            -------------
           /             \
     0 ____| 2         2 |____ 2
           |             |
     1 ____| 2         2 |____ 3
           \             /
            -------------
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>Since <img class="math" src="../_images/math/2363059a61e3ed5453b95a6de83aad3f7525f156.png" alt="U_a"/> and <img class="math" src="../_images/math/d1585c1af4e036c3f5a0e577a2a8fdc54953a8c7.png" alt="U_b"/> have the same content(matrix elements) but acting on different sites, we only need to define a single UniTensor.</p></li>
<li><p>Here as a simple example, we directly convert a <strong>cytnx.Tensor</strong> to <strong>cytnx.UniTensor</strong>, which we don’t impose any bra-ket constrain (direction of bonds). In general, it is also possible to give bond direction (which we refering to <em>tagged</em>) that constrain the bonds to be more physical. See Github example/iTEBD/iTEBD_tag.py for demonstration.</p></li>
<li><p>In general, the accurate ground state can be acquired with a higher order Trotter-Suzuki expansion, and with decreasing <img class="math" src="../_images/math/8a17be931fc7513e42c70062ac24c65407c44dca.png" alt="\delta \tau"/> along the iteraction. (See <a class="bibtex reference internal" href="#itebd-vidal" id="id2">[Vid07]</a> for further details), Here, for demonstration, we use fixed value of <img class="math" src="../_images/math/8a17be931fc7513e42c70062ac24c65407c44dca.png" alt="\delta \tau"/>.</p></li>
</ol>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Here, <strong>physics.pauli</strong> returns complex type <strong>cytnx.Tensor</strong>. Since we know pauli-z and pauli-x should be real, we use <em>.real()</em> to get the real part.</p>
</div>
</div>
<div class="section" id="update-procedure">
<h2><span class="section-number">2.2. </span>Update procedure<a class="headerlink" href="#update-procedure" title="Permalink to this headline">¶</a></h2>
<p>Now we have prepared the initial trial wavefunction in terms of MPS with two sites unit cell and the time evolution operator, we are ready to use the aformentioned scheme to find the (variational) ground state MPS.
At the beginning of each iteration, we evaluate the energy expectation value <img class="math" src="../_images/math/fb5cd6f89cf1e8d51b3e7ad23dab31ff16203855.png" alt="\langle \psi | H | \psi  \rangle / \langle \psi | \psi  \rangle"/>, and check the convergence, the network is straightforward:</p>
<a class="reference internal image-reference" href="../_images/itebd_contract.png"><img alt="../_images/itebd_contract.png" class="align-center" src="../_images/itebd_contract.png" style="width: 300px;" /></a>
<a class="reference internal image-reference" href="../_images/itebd_energy.png"><img alt="../_images/itebd_energy.png" class="align-center" src="../_images/itebd_energy.png" style="width: 450px;" /></a>
<ul class="simple">
<li><p>In python</p></li>
</ul>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="n">B</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="n">la</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
<span class="n">lb</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>

<span class="c1">## contract all</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">la</span><span class="p">),</span><span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">lb</span><span class="p">))</span>
<span class="c1">#X.print_diagram()</span>
<span class="n">lb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">new_label</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span><span class="n">X</span><span class="p">)</span>

<span class="n">Xt</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

<span class="c1">## calculate norm and energy for this step</span>
<span class="c1"># Note that X,Xt contract will result a rank-0 tensor, which can use item() toget element</span>
<span class="n">XNorm</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Xt</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">XH</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">H</span><span class="p">)</span>
<span class="n">XH</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">XHX</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">Xt</span><span class="p">,</span><span class="n">XH</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="c1">## rank-0</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">XHX</span><span class="o">/</span><span class="n">XNorm</span>

<span class="c1">## check if converged.</span>
<span class="k">if</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">Elast</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">CvgCrit</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Converged!]&quot;</span><span class="p">)</span>
    <span class="k">break</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step: </span><span class="si">%d</span><span class="s2"> Enr: </span><span class="si">%5.8f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">Elast</span><span class="p">))</span>
<span class="n">Elast</span> <span class="o">=</span> <span class="n">E</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><p>In c++</p></li>
</ul>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">-2</span><span class="p">});</span>
<span class="n">B</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">-4</span><span class="p">});</span>
<span class="n">la</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-2</span><span class="p">,</span><span class="mi">-3</span><span class="p">});</span>
<span class="n">lb</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-4</span><span class="p">,</span><span class="mi">-5</span><span class="p">});</span>


<span class="c1">// contract all</span>
<span class="n">UniTensor</span> <span class="n">X</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">la</span><span class="p">),</span><span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">lb</span><span class="p">));</span>
<span class="n">lb</span><span class="p">.</span><span class="n">set_label</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">-1</span><span class="p">);</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span><span class="n">X</span><span class="p">);</span>

<span class="n">UniTensor</span> <span class="n">Xt</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>

<span class="c1">//&gt; calculate norm and energy for this step</span>
<span class="c1">// Note that X,Xt contract will result a rank-0 tensor, which can use item() toget element</span>
<span class="n">Scalar</span> <span class="n">XNorm</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Xt</span><span class="p">).</span><span class="n">item</span><span class="p">();</span>
<span class="n">UniTensor</span> <span class="n">XH</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">H</span><span class="p">);</span>

<span class="n">XH</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-4</span><span class="p">,</span><span class="mi">-5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
<span class="n">Scalar</span> <span class="n">XHX</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">Xt</span><span class="p">,</span><span class="n">XH</span><span class="p">).</span><span class="n">item</span><span class="p">();</span>
<span class="kt">double</span> <span class="n">E</span> <span class="o">=</span> <span class="kt">double</span><span class="p">(</span><span class="n">XHX</span><span class="o">/</span><span class="n">XNorm</span><span class="p">);</span>

<span class="c1">//&gt; check if converged.</span>
<span class="k">if</span><span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">Elast</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">CvgCrit</span><span class="p">){</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;[Converged!]&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Step: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Enr: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Elast</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">Elast</span> <span class="o">=</span> <span class="n">E</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>in the next step we perform the two-sites imaginary time evolution, using the operator (or “gate”) eH we defined above:</p>
<a class="reference internal image-reference" href="../_images/itebd_envolve.png"><img alt="../_images/itebd_envolve.png" class="align-center" src="../_images/itebd_envolve.png" style="width: 700px;" /></a>
<p>we also performed SVD for the XeH here, this put the MPS into mixed canonical form and have a Schimit decomposition of the whole state where the singular values are simply the Schimit coefficients. The <strong>Svd_truncate</strong> is called such that the intermediate bonds with label (-6) and (-7) are properly truncate to the maximum virtual bond dimension <strong>chi</strong>.</p>
<ul class="simple">
<li><p>In python</p></li>
</ul>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">XeH</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">eH</span><span class="p">)</span>
<span class="n">XeH</span><span class="o">.</span><span class="n">permute_</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span><span class="n">by_label</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">XeH</span><span class="o">.</span><span class="n">set_rowrank</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">la</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">Svd_truncate</span><span class="p">(</span><span class="n">XeH</span><span class="p">,</span><span class="n">chi</span><span class="p">)</span>
<span class="n">Norm</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">Norm</span><span class="p">(</span><span class="n">la</span><span class="o">.</span><span class="n">get_block_</span><span class="p">())</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">la</span> <span class="o">*=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">Norm</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><p>In c++</p></li>
</ul>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">//&gt; Time evolution the MPS</span>
<span class="n">UniTensor</span> <span class="n">XeH</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">eH</span><span class="p">);</span>
<span class="n">XeH</span><span class="p">.</span><span class="n">permute_</span><span class="p">({</span><span class="mi">-4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">-5</span><span class="p">},</span><span class="mi">-1</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>

<span class="n">XeH</span><span class="p">.</span><span class="n">set_Rowrank</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">UniTensor</span><span class="o">&gt;</span> <span class="n">out</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">xlinalg</span><span class="o">::</span><span class="n">Svd_truncate</span><span class="p">(</span><span class="n">XeH</span><span class="p">,</span><span class="n">chi</span><span class="p">);</span>
<span class="n">la</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">A</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">B</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="n">Scalar</span> <span class="n">Norm</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">::</span><span class="n">linalg</span><span class="o">::</span><span class="n">Norm</span><span class="p">(</span><span class="n">la</span><span class="p">.</span><span class="n">get_block_</span><span class="p">()).</span><span class="n">item</span><span class="p">();</span>
<span class="n">la</span> <span class="o">*=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">Norm</span><span class="p">;</span> <span class="c1">//normalize</span>
</pre></div>
</td></tr></table></div>
<p>Note that we directly store the SVD results into A, B and la, this can be seen by comparing to our original MPS configuration:</p>
<a class="reference internal image-reference" href="../_images/itebd_what.png"><img alt="../_images/itebd_what.png" class="align-center" src="../_images/itebd_what.png" style="width: 500px;" /></a>
<p>to recover to orignial form, we put <img class="math" src="../_images/math/e037fe79141465fea7892aa8693a3ac11cb80717.png" alt="\lambda_B^{-1} \lambda_B"/> on both ends, which abosorb two <img class="math" src="../_images/math/c479d1466ae3f23441a08bd538256d7dc7eb968c.png" alt="\lambda_B^{-1}"/>:</p>
<a class="reference internal image-reference" href="../_images/itebd_recover.png"><img alt="../_images/itebd_recover.png" class="align-center" src="../_images/itebd_recover.png" style="width: 500px;" /></a>
<p>Now we have the envolved <img class="math" src="../_images/math/17ca72775d1128f2596ed085770dff83acf1994d.png" alt="\Gamma_A"/>, <img class="math" src="../_images/math/bd37fd9ad58efa5555782b2dbfcdd4361959155c.png" alt="\Gamma_B"/> and <img class="math" src="../_images/math/ae4a4ff6a04edd704c3af024c35da4d525293ff1.png" alt="\lambda_A"/>. Using the translation symmetry, we shift the whole chain to left by just exchange the <img class="math" src="../_images/math/b126c525ce2189cb014e59a6cc20c4829c3dac2d.png" alt="Gamma"/> and <img class="math" src="../_images/math/cefc603e5658facb747581f9567192993f21c7ab.png" alt="\lambda"/> pair and arrived at the new MPS for next iteration to update B-A sites using <img class="math" src="../_images/math/d1585c1af4e036c3f5a0e577a2a8fdc54953a8c7.png" alt="U_b"/>.</p>
<a class="reference internal image-reference" href="../_images/itebd_translation.png"><img alt="../_images/itebd_translation.png" class="align-center" src="../_images/itebd_translation.png" style="width: 300px;" /></a>
<ul class="simple">
<li><p>In python</p></li>
</ul>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># again, but A&#39; and B&#39; are updated</span>
<span class="n">A</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]);</span> <span class="n">A</span><span class="o">.</span><span class="n">set_rowrank</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">B</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">]);</span> <span class="n">B</span><span class="o">.</span><span class="n">set_rowrank</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="n">lb_inv</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">lb</span>

<span class="n">lb_inv</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># -1 to contract with A, 7 is arbitary here.</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">lb_inv</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>

<span class="n">lb_inv</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span> <span class="c1"># -4 to contract with B, 8 is arbitary here.</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">lb_inv</span><span class="p">)</span>

<span class="c1"># translation symmetry, exchange A and B site</span>
<span class="n">A</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span><span class="p">,</span><span class="n">A</span>
<span class="n">la</span><span class="p">,</span><span class="n">lb</span> <span class="o">=</span> <span class="n">lb</span><span class="p">,</span><span class="n">la</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><p>In c++</p></li>
</ul>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">-2</span><span class="p">});</span> <span class="n">A</span><span class="p">.</span><span class="n">set_Rowrank</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">B</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">-4</span><span class="p">});</span> <span class="n">B</span><span class="p">.</span><span class="n">set_Rowrank</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="n">UniTensor</span> <span class="n">lb_inv</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">lb</span><span class="p">;</span>

<span class="n">lb_inv</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">7</span><span class="p">,</span> <span class="mi">-1</span><span class="p">});</span> <span class="c1">// -1 to contract with A, 7 is arbitary here.</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">cyx</span><span class="p">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">lb_inv</span><span class="p">,</span><span class="n">A</span><span class="p">);</span>

<span class="n">lb_inv</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-4</span><span class="p">,</span> <span class="mi">8</span><span class="p">})</span> <span class="c1">// -4 to contract with B, 8 is arbitary here.</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">cyx</span><span class="p">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">lb_inv</span><span class="p">);</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">lb_inv</span><span class="p">,</span><span class="n">A</span><span class="p">);</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">lb_inv</span><span class="p">);</span>


<span class="c1">//&gt; translation symm, exchange A and B site</span>
<span class="n">UniTensor</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">A</span><span class="p">;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">B</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>

<span class="n">tmp</span> <span class="o">=</span> <span class="n">la</span><span class="p">;</span>
<span class="n">la</span> <span class="o">=</span> <span class="n">lb</span><span class="p">;</span> <span class="n">lb</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Let’s put everything together in a loop for iteration:</p>
<ul class="simple">
<li><p>In python</p></li>
</ul>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>

    <span class="n">A</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">B</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">la</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">lb</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>

    <span class="c1">## contract all</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">la</span><span class="p">),</span><span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">lb</span><span class="p">))</span>
    <span class="c1">#X.print_diagram()</span>
    <span class="n">lb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">new_label</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span><span class="n">X</span><span class="p">)</span>

    <span class="c1">## X =</span>
    <span class="c1">#           (0)  (1)</span>
    <span class="c1">#            |    |</span>
    <span class="c1">#  (-4) --lb-A-la-B-lb-- (-5)</span>
    <span class="c1">#</span>
    <span class="c1">#X.print_diagram()</span>

    <span class="n">Xt</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

    <span class="c1">## calculate norm and energy for this step</span>
    <span class="c1"># Note that X,Xt contract will result a rank-0 tensor, which can use item() toget element</span>
    <span class="n">XNorm</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Xt</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">XH</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">H</span><span class="p">)</span>
    <span class="n">XH</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">XHX</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">Xt</span><span class="p">,</span><span class="n">XH</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="c1">## rank-0</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">XHX</span><span class="o">/</span><span class="n">XNorm</span>

    <span class="c1">## check if converged.</span>
    <span class="k">if</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">Elast</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">CvgCrit</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Converged!]&quot;</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Step: </span><span class="si">%d</span><span class="s2"> Enr: </span><span class="si">%5.8f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">Elast</span><span class="p">))</span>
    <span class="n">Elast</span> <span class="o">=</span> <span class="n">E</span>

    <span class="c1">## Time evolution the MPS</span>
    <span class="n">XeH</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">eH</span><span class="p">)</span>
    <span class="n">XeH</span><span class="o">.</span><span class="n">permute_</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span><span class="n">by_label</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1">#XeH.print_diagram()</span>

    <span class="c1">## Do Svd + truncate</span>
    <span class="c1">##</span>
    <span class="c1">#        (2)   (3)                   (2)                                    (3)</span>
    <span class="c1">#         |     |          =&gt;         |         +   (-6)--s--(-7)  +         |</span>
    <span class="c1">#  (-4) --= XeH =-- (-5)        (-4)--U--(-6)                          (-7)--Vt--(-5)</span>
    <span class="c1">#</span>

    <span class="n">XeH</span><span class="o">.</span><span class="n">set_rowrank</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">la</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">Svd_truncate</span><span class="p">(</span><span class="n">XeH</span><span class="p">,</span><span class="n">chi</span><span class="p">)</span>
    <span class="n">Norm</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">Norm</span><span class="p">(</span><span class="n">la</span><span class="o">.</span><span class="n">get_block_</span><span class="p">())</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">la</span> <span class="o">*=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">Norm</span>
    <span class="c1">#A.print_diagram()</span>
    <span class="c1">#la.print_diagram()</span>
    <span class="c1">#B.print_diagram()</span>


    <span class="c1"># de-contract the lb tensor , so it returns to</span>
    <span class="c1">#</span>
    <span class="c1">#            |     |</span>
    <span class="c1">#       --lb-A&#39;-la-B&#39;-lb--</span>
    <span class="c1">#</span>
    <span class="c1"># again, but A&#39; and B&#39; are updated</span>
    <span class="n">A</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]);</span> <span class="n">A</span><span class="o">.</span><span class="n">set_rowrank</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">B</span><span class="o">.</span><span class="n">set_labels</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">]);</span> <span class="n">B</span><span class="o">.</span><span class="n">set_rowrank</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

    <span class="c1">#A.print_diagram()</span>
    <span class="c1">#B.print_diagram()</span>

    <span class="n">lb_inv</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">lb</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">lb_inv</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">lb_inv</span><span class="p">)</span>

    <span class="c1">#A.print_diagram()</span>
    <span class="c1">#B.print_diagram()</span>

    <span class="c1"># translation symmetry, exchange A and B site</span>
    <span class="n">A</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span><span class="p">,</span><span class="n">A</span>
    <span class="n">la</span><span class="p">,</span><span class="n">lb</span> <span class="o">=</span> <span class="n">lb</span><span class="p">,</span><span class="n">la</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><p>In c++</p></li>
</ul>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">//&gt; Evov:</span>
<span class="kt">double</span> <span class="n">Elast</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="k">for</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10000</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="n">A</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">-2</span><span class="p">});</span>
    <span class="n">B</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">-4</span><span class="p">});</span>
    <span class="n">la</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-2</span><span class="p">,</span><span class="mi">-3</span><span class="p">});</span>
    <span class="n">lb</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-4</span><span class="p">,</span><span class="mi">-5</span><span class="p">});</span>


    <span class="c1">// contract all</span>
    <span class="n">UniTensor</span> <span class="n">X</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">la</span><span class="p">),</span><span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">lb</span><span class="p">));</span>
    <span class="n">lb</span><span class="p">.</span><span class="n">set_label</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">-1</span><span class="p">);</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span><span class="n">X</span><span class="p">);</span>

    <span class="n">UniTensor</span> <span class="n">Xt</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>

    <span class="c1">//&gt; calculate norm and energy for this step</span>
    <span class="c1">// Note that X,Xt contract will result a rank-0 tensor, which can use item() toget element</span>
    <span class="kt">double</span> <span class="n">XNorm</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Xt</span><span class="p">).</span><span class="n">item</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">();</span>
    <span class="n">UniTensor</span> <span class="n">XH</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">H</span><span class="p">);</span>

    <span class="n">XH</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-4</span><span class="p">,</span><span class="mi">-5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">});</span>
    <span class="kt">double</span> <span class="n">XHX</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">Xt</span><span class="p">,</span><span class="n">XH</span><span class="p">).</span><span class="n">item</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">();</span>
    <span class="kt">double</span> <span class="n">E</span> <span class="o">=</span> <span class="n">XHX</span><span class="o">/</span><span class="n">XNorm</span><span class="p">;</span>

    <span class="c1">//&gt; check if converged.</span>
    <span class="k">if</span><span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">E</span><span class="o">-</span><span class="n">Elast</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">CvgCrit</span><span class="p">){</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;[Converged!]&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Step: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Enr: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">Elast</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="n">Elast</span> <span class="o">=</span> <span class="n">E</span><span class="p">;</span>

    <span class="c1">//&gt; Time evolution the MPS</span>
    <span class="n">UniTensor</span> <span class="n">XeH</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">eH</span><span class="p">);</span>
    <span class="n">XeH</span><span class="p">.</span><span class="n">permute_</span><span class="p">({</span><span class="mi">-4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">-5</span><span class="p">},</span><span class="mi">-1</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>

    <span class="c1">//&gt; Do Svd + truncate</span>
    <span class="n">XeH</span><span class="p">.</span><span class="n">set_Rowrank</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">UniTensor</span><span class="o">&gt;</span> <span class="n">out</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">xlinalg</span><span class="o">::</span><span class="n">Svd_truncate</span><span class="p">(</span><span class="n">XeH</span><span class="p">,</span><span class="n">chi</span><span class="p">);</span>
    <span class="n">la</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">A</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">B</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="kt">double</span> <span class="n">Norm</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">::</span><span class="n">linalg</span><span class="o">::</span><span class="n">Norm</span><span class="p">(</span><span class="n">la</span><span class="p">.</span><span class="n">get_block_</span><span class="p">()).</span><span class="n">item</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">();</span>
    <span class="n">la</span> <span class="o">*=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">Norm</span><span class="p">;</span> <span class="c1">//normalize</span>


    <span class="c1">// de-contract the lb tensor , so it returns to</span>
    <span class="c1">//</span>
    <span class="c1">//            |     |</span>
    <span class="c1">//       --lb-A&#39;-la-B&#39;-lb--</span>
    <span class="c1">//</span>
    <span class="c1">// again, but A&#39; and B&#39; are updated</span>
    <span class="n">A</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">-2</span><span class="p">});</span> <span class="n">A</span><span class="p">.</span><span class="n">set_Rowrank</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">B</span><span class="p">.</span><span class="n">set_labels</span><span class="p">({</span><span class="mi">-3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">-4</span><span class="p">});</span> <span class="n">B</span><span class="p">.</span><span class="n">set_Rowrank</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

    <span class="n">UniTensor</span> <span class="n">lb_inv</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">lb</span><span class="p">;</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">lb_inv</span><span class="p">,</span><span class="n">A</span><span class="p">);</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">Contract</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">lb_inv</span><span class="p">);</span>


    <span class="c1">//&gt; translation symm, exchange A and B site</span>
    <span class="n">UniTensor</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">A</span><span class="p">;</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">B</span><span class="p">;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="n">la</span><span class="p">;</span>
    <span class="n">la</span> <span class="o">=</span> <span class="n">lb</span><span class="p">;</span> <span class="n">lb</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p id="bibtex-bibliography-example/iTEBD-0"><dl class="citation">
<dt class="bibtex label" id="itebd-vidal"><span class="brackets">Vid07</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>)</span></dt>
<dd><p>G. Vidal. Classical simulation of infinite-size quantum lattice systems in one spatial dimension. <em>Phys. Rev. Lett.</em>, 98:070201, Feb 2007. URL: <a class="reference external" href="https://link.aps.org/doi/10.1103/PhysRevLett.98.070201">https://link.aps.org/doi/10.1103/PhysRevLett.98.070201</a>, <a class="reference external" href="https://doi.org/10.1103/PhysRevLett.98.070201">doi:10.1103/PhysRevLett.98.070201</a>.</p>
</dd>
</dl>
</p>
</div>
</div>


          </div>
        </div>
      </div>
    </div>
      <div class="clearer"></div>
      </div>
    </div>
<footer class="footer d-flex justify-content-between flex-wrap">
    <div class="copyright">
        <div>&copy; Copyright 2019-, Kai-Hsin Wu.</div>
      <div>Generated by <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.5.4 using <a href="https://github.com/myyasuda/sphinxbootstrap4theme">sphinxbootstrap4theme</a> 0.6.0.</div>
    </div>
    <div>
        <a href="#" class="btn btn-primary btn-sm" role="botton">Back to top</a>
    </div>
</footer>
  </body>
</html>