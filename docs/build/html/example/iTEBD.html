
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    
    <title>2. iTEBD &#8212; Cytnx  documentation</title>

    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-4.3.1-dist/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinxbootstrap4.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/bootstrap-4.3.1-dist/js/bootstrap.min.js"></script>
    <script src="../_static/sphinxbootstrap4.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. DMRG" href="DMRG.html" />
    <link rel="prev" title="1. Exact Diagonalization" href="ED.html" /> 
  </head><body>
  <nav class="navbar navbar-expand-md  fixed-top navbar-dark bg-dark flex-wrap">
    <button class="navbar-toggler ml-auto py-2" type="button" data-toggle="collapse" data-target="#exCollapsingNavbar2">
      &#9776;
    </button>
      <div class="navbar-collapse collapse" id="exCollapsingNavbar2">
           <a class="navbar-brand py-1" href="../index.html">
              <img class="logo" src="../_static/Icon_i.png" alt="Cytnx"/>
          </a>
          <ul class="navbar-nav mr-auto">
          
              <li class="nav-item dropdown d-none d-sm-block" id="navbar-pages">
                  <a class="nav-link dropdown-toggle" data-toggle="dropdown">Pages</a>
                  <ul class="dropdown-menu">
                  <ul>
<li class="toctree-l1"><a class="reference internal" href="../Intro.html">Introdoction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Intro.html#features">Features</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Guide.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guide/behavior.html">1. Objects behavior</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/behavior.html#eveything-is-reference">1.1. Eveything is reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/behavior.html#clone">1.2. clone</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/basic_obj/Tensor.html">2. Tensor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html">2.1. Create a Tensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#tensor-with-different-dtype-and-device">2.1.1. Tensor with different dtype and device</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#type-conversion">2.1.2. Type conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#transfer-btwn-devices">2.1.3. Transfer btwn devices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_2_manip.html">2.2. Manipulate Tensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_2_manip.html#reshape">2.2.1. reshape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_2_manip.html#permute">2.2.2. permute</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html">2.3. Access elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html#get-elements">2.3.1. Get elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html#set-elememts">2.3.2. Set elememts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html#low-level-api-c-only">2.3.3. Low-level API (C++ only)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html">2.4. Tensor arithmetic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#type-promotion">2.4.1. Type promotion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#tensor-scalar-arithmetic">2.4.2. Tensor-scalar arithmetic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#tensor-tensor-arithmetic">2.4.3. Tensor-Tensor arithmetic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#equivalent-apis-c-only">2.4.4. Equivalent APIs (C++ only)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_5_numpy.html">2.5. To/From numpy.array</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_6_app.html">2.6. Append elements</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_7_io.html">2.7. Save/Load</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_7_io.html#save-a-tensor">2.7.1. Save a Tensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_7_io.html#load-a-tensor">2.7.2. Load a Tensor</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/basic_obj/Storage.html">3. Storage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html">3.1. Create a Storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html#type-conversion">3.1.1. Type conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html#transfer-btwn-devices">3.1.2. Transfer btwn devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html#get-storage-of-tensor">3.1.3. Get Storage of Tensor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_2_access.html">3.2. Access elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_2_access.html#get-set-element">3.2.1. Get/Set element</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_2_access.html#get-raw-pointer-c-only">3.2.2. Get raw-pointer (C++ only)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_3_expand.html">3.3. Increase size</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_3_expand.html#append">3.3.1. Append</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_3_expand.html#resize">3.3.2. Resize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_4_vec.html">3.4. From c++.vector</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html">3.5. Save/Load</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html#save-a-storage">3.5.1. Save a Storage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html#load-a-storage">3.5.2. Load a Storage</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/linalg.html">4. Linear algebra</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/itersol.html">5. Iterative solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/itersol/LinOp.html">5.1. LinOp class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#pass-a-function">5.1.1. Pass a function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#inherit-the-linop-class">5.1.2. Inherit the LinOp class</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#ex-make-sparse-data-structure">5.1.3. Ex: make sparse data structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/itersol/Lanczos.html">5.2. Lanczos solver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/cyx.html">6. Cytnx extensions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/TNotation.html">6.1. Tensor Notation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/TNotation.html#tensor-contraction">6.1.1. Tensor Contraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/TNotation.html#direction-of-bond">6.1.2. Direction of bond</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/CyTensor.html">6.2. CyTensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/CyTensor_1_create.html">6.2.1. Create CyTensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/CyTensor_2_manip.html">6.2.2. Manipulate CyTensor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/Network.html">6.3. Network</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/Bond.html">6.4. Bond</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/xlinalg.html">7. linalg extension</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../Examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ED.html">1. Exact Diagonalization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ED.html#bit-representation-of-basis-states">1.1. Bit representation of basis states</a></li>
<li class="toctree-l3"><a class="reference internal" href="ED.html#implementation">1.2. Implementation</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2. iTEBD</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#imaginary-time-evolution">2.1. Imaginary time evolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-procedure">2.2. Update procedure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="DMRG.html">3. DMRG</a></li>
<li class="toctree-l2"><a class="reference internal" href="iDMRG.html">4. iDMRG</a></li>
<li class="toctree-l2"><a class="reference internal" href="HOTRG.html">5. HOTRG</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://kaihsin.github.io/Cytnx/docs/html/index.html">API Documentations</a></li>
<li class="toctree-l1"><a class="reference external" href="https://kaihsin.github.io/Cytnx/docs/html/index.html">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1rt6bXg_D8ogrwXiFcakLmNh8RamlikVr/view?usp=sharing">5-mins Blitz intro slide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Developer.html">Developer</a></li>
</ul>

                  </ul>
              </li>
              <li class="nav-item">
              
                  <a  class="nav-link" href="https://kaihsin.github.io/Cytnx/docs/html/index.html">API Doc</a></li>
              <li class="nav-item">
              
                  <a  class="nav-link" href="https://github.com/kaihsin/Cytnx">Github</a></li>
              <li class="nav-item">
              <a  class="nav-link" href="../">v0.5.5a</a></li>
          </ul>
          <div class="dropdown-divider d-block d-sm-none mb-4"></div>
             
<form class="form-inline" action="../search.html" method="get">
  <input type="text" name="q" class="form-control" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      </div>

      <!--<div class="row hidden-sm-up">
          <div class="collapse navbar-toggleable-xs container" id="exCollapsingNavbar2">
              <div class="container">
             　　 <a class="navbar-brand" href="../index.html">
                      <img class="logo" src="../_static/Icon_i.png" alt="Cytnx"/>
                  </a>
              </div>
              <ul class="nav navbar-nav">
                  <li>
                  
                      <a  class="nav-link" href="https://kaihsin.github.io/Cytnx/docs/html/index.html">API Doc</a></li>
                  <li>
                  
                      <a  class="nav-link" href="https://github.com/kaihsin/Cytnx">Github</a></li>
                  <li>
                  <a  class="nav-link" href="../">v0.5.5a</a></li>
              </ul>
              <div class="dropdown-divider"></div>
              <div class="navbar-text">search<div>
              
<form class="form-inline" action="../search.html" method="get">
  <input type="text" name="q" class="form-control" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          </div>
      </div>-->
    </nav>
  </div>

    <div class="related d-flex justify-content-between bg-light flex-wrap" role="navigation" aria-label="related navigation">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="../index.html">Cytnx  documentation</a></li>
                <li class="breadcrumb-item"><a href="../Examples.html"
                       
                         accesskey="U"
                         class="active"
                       >Examples</a></li>
            <li class="breadcrumb-item active"><span class="section-number">2. </span>iTEBD</li>
        </ol>
       <div>
          <div class="btn-group btn-group-sm" role="group" aria-label="Basic example">
               <a href="ED.html" title="Previous Chapter: 1. Exact Diagonalization" class="btn btn-primary" role="botton" accesskey="P">
                   &laquo; 1. Exact Diag...
               </a>
               <a href="DMRG.html" title="Next Chapter: 3. DMRG" class="btn btn-primary" role="botton" accesskey="N">
                   3. DMRG &raquo;
               </a>
           </div>
       </div>
    </div>

  <div class="main container-fluid">
    <div class="row"> 
      <div class="sphinxsidebar d-none d-md-block">
        <div class="sphinxsidebarwrapper">          
            <h4>Table Of Contents</h4>
            
            
              <div class="sidebartoctree">
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../Intro.html">Introdoction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Intro.html#features">Features</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Guide.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guide/behavior.html">1. Objects behavior</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/behavior.html#eveything-is-reference">1.1. Eveything is reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/behavior.html#clone">1.2. clone</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/basic_obj/Tensor.html">2. Tensor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html">2.1. Create a Tensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#tensor-with-different-dtype-and-device">2.1.1. Tensor with different dtype and device</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#type-conversion">2.1.2. Type conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_1_create.html#transfer-btwn-devices">2.1.3. Transfer btwn devices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_2_manip.html">2.2. Manipulate Tensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_2_manip.html#reshape">2.2.1. reshape</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_2_manip.html#permute">2.2.2. permute</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html">2.3. Access elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html#get-elements">2.3.1. Get elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html#set-elememts">2.3.2. Set elememts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_3_access.html#low-level-api-c-only">2.3.3. Low-level API (C++ only)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html">2.4. Tensor arithmetic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#type-promotion">2.4.1. Type promotion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#tensor-scalar-arithmetic">2.4.2. Tensor-scalar arithmetic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#tensor-tensor-arithmetic">2.4.3. Tensor-Tensor arithmetic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_4_arithmetic.html#equivalent-apis-c-only">2.4.4. Equivalent APIs (C++ only)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_5_numpy.html">2.5. To/From numpy.array</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_6_app.html">2.6. Append elements</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Tensor_7_io.html">2.7. Save/Load</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_7_io.html#save-a-tensor">2.7.1. Save a Tensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Tensor_7_io.html#load-a-tensor">2.7.2. Load a Tensor</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/basic_obj/Storage.html">3. Storage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html">3.1. Create a Storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html#type-conversion">3.1.1. Type conversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html#transfer-btwn-devices">3.1.2. Transfer btwn devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_1_create.html#get-storage-of-tensor">3.1.3. Get Storage of Tensor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_2_access.html">3.2. Access elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_2_access.html#get-set-element">3.2.1. Get/Set element</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_2_access.html#get-raw-pointer-c-only">3.2.2. Get raw-pointer (C++ only)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_3_expand.html">3.3. Increase size</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_3_expand.html#append">3.3.1. Append</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_3_expand.html#resize">3.3.2. Resize</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_4_vec.html">3.4. From c++.vector</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html">3.5. Save/Load</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html#save-a-storage">3.5.1. Save a Storage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/basic_obj/Storage_5_io.html#load-a-storage">3.5.2. Load a Storage</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/linalg.html">4. Linear algebra</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/itersol.html">5. Iterative solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/itersol/LinOp.html">5.1. LinOp class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#pass-a-function">5.1.1. Pass a function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#inherit-the-linop-class">5.1.2. Inherit the LinOp class</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/itersol/LinOp.html#ex-make-sparse-data-structure">5.1.3. Ex: make sparse data structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/itersol/Lanczos.html">5.2. Lanczos solver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/cyx.html">6. Cytnx extensions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/TNotation.html">6.1. Tensor Notation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/TNotation.html#tensor-contraction">6.1.1. Tensor Contraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/TNotation.html#direction-of-bond">6.1.2. Direction of bond</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/CyTensor.html">6.2. CyTensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/CyTensor_1_create.html">6.2.1. Create CyTensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cyx/CyTensor_2_manip.html">6.2.2. Manipulate CyTensor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/Network.html">6.3. Network</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/cyx/Bond.html">6.4. Bond</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guide/xlinalg.html">7. linalg extension</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../Examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ED.html">1. Exact Diagonalization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ED.html#bit-representation-of-basis-states">1.1. Bit representation of basis states</a></li>
<li class="toctree-l3"><a class="reference internal" href="ED.html#implementation">1.2. Implementation</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2. iTEBD</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#imaginary-time-evolution">2.1. Imaginary time evolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-procedure">2.2. Update procedure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="DMRG.html">3. DMRG</a></li>
<li class="toctree-l2"><a class="reference internal" href="iDMRG.html">4. iDMRG</a></li>
<li class="toctree-l2"><a class="reference internal" href="HOTRG.html">5. HOTRG</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://kaihsin.github.io/Cytnx/docs/html/index.html">API Documentations</a></li>
<li class="toctree-l1"><a class="reference external" href="https://kaihsin.github.io/Cytnx/docs/html/index.html">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drive.google.com/file/d/1rt6bXg_D8ogrwXiFcakLmNh8RamlikVr/view?usp=sharing">5-mins Blitz intro slide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Developer.html">Developer</a></li>
</ul>

              </div>
            
          
  <h4>Previous topic</h4>
  <p class="topless"><a href="ED.html"
                        title="previous chapter"><span class="section-number">1. </span>Exact Diagonalization</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="DMRG.html"
                        title="next chapter"><span class="section-number">3. </span>DMRG</a></p>
<div id="searchbox" style="display: none">
    <form class="form search" action="../search.html" method="get">
      <input type="text" name="q" class="form-control" placeholder="Search..." />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>

<script type="text/javascript">$('#searchbox').show(0);</script>
  <ul class="this-page-menu list-unstyled text-right">
    <li><a href="../_sources/example/iTEBD.rst.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
        </div>
      </div> 

      <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="itebd">
<h1><span class="section-number">2. </span>iTEBD<a class="headerlink" href="#itebd" title="Permalink to this headline">¶</a></h1>
<p>Time evolution block decimation is one of the most simple and sucessful Tensor network method <a class="bibtex reference internal" href="#itebd-vidal" id="id1">[Vid07]</a>. The core concept of this algorithm is to use the imaginary time evolution to find the best variational ansatz, usually in terms of Matrix product state (MPS).</p>
<p>Here, we use a 1D transverse field Ising model (TFIM) as a simple example to show how to implement iTEBD algorithm in Cytnx and get the infinite system size (variational) ground state.</p>
<p>Consider the Hamiltonain of TFIM:</p>
<div class="math">
<p><img src="../_images/math/3a80d325383b0e507f20ffe9fccf30dd2b64a1ea.png" alt="H = J\sum_{ij} \sigma^{z}_i\sigma^{z}_j - H_x\sum_i \sigma^{x}_i"/></p>
</div><p>where <img class="math" src="../_images/math/ce3f0bb97c9c7f72ed406b3c0d9940a240b13304.png" alt="\sigma^{x,z}"/> are the pauli matrices.
The infinite size ground state can be represent by MPS as variational ansatz, where the <em>virtual bonds</em> dimension <img class="math" src="../_images/math/52b130781cb6e2b47a5efb235ac1cb4162210d12.png" alt="\chi"/> effectively controls the number of variational parameters (shown as orange bonds), and the <em>physical bonds</em> dimension <img class="math" src="../_images/math/badad346f6fbe2e237af99bfbd9a93a4da53a3da.png" alt="d"/> is the real physical dimension (shown as the blue bonds. Here, for Ising spins <img class="math" src="../_images/math/70c185d024e038ba37d7018dc84eefd8616db41a.png" alt="d=2"/>).</p>
<p>Because the system has translational invariant, thus it is legit to choose unit-cell consist with two sites, and the infinite system ground state can be represented with only two sites MPS with local tensors <img class="math" src="../_images/math/17ca72775d1128f2596ed085770dff83acf1994d.png" alt="\Gamma_A"/> and <img class="math" src="../_images/math/bd37fd9ad58efa5555782b2dbfcdd4361959155c.png" alt="\Gamma_B"/> associate with the schmit basis and <img class="math" src="../_images/math/ae4a4ff6a04edd704c3af024c35da4d525293ff1.png" alt="\lambda_A"/>, <img class="math" src="../_images/math/2aabf014844c25aea519f1a026c22dc9db822208.png" alt="\lambda_B"/> are the diagonal matrices of Schmidt coefficients as shown in the following:</p>
<a class="reference internal image-reference" href="../_images/itebd_MPS.png"><img alt="../_images/itebd_MPS.png" class="align-center" src="../_images/itebd_MPS.png" style="width: 600px;" /></a>
<p>Let’s first create this two-site  MPS wave function (here, we set virtual bond dimension <img class="math" src="../_images/math/8abc784ccde5e4b0b30fdb7d8343db21c4a06bd6.png" alt="\chi = 10"/> as example)</p>
<ul class="simple">
<li><p>In python</p></li>
</ul>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cytnx</span>
<span class="kn">import</span> <span class="nn">cytnx.cytnx_extension</span> <span class="k">as</span> <span class="nn">cyx</span>

<span class="n">chi</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">.</span><span class="n">CyTensor</span><span class="p">([</span><span class="n">cyx</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span><span class="n">cyx</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">cyx</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">.</span><span class="n">CyTensor</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">bonds</span><span class="p">(),</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="n">cytnx</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Make_normal</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">get_block_</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">cytnx</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Make_normal</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">get_block_</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">A</span><span class="o">.</span><span class="n">print_diagram</span><span class="p">()</span>
<span class="n">B</span><span class="o">.</span><span class="n">print_diagram</span><span class="p">()</span>

<span class="n">la</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">.</span><span class="n">CyTensor</span><span class="p">([</span><span class="n">cyx</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span><span class="n">cyx</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span><span class="n">is_diag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">lb</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">.</span><span class="n">CyTensor</span><span class="p">([</span><span class="n">cyx</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span><span class="n">cyx</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span><span class="n">is_diag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">la</span><span class="o">.</span><span class="n">put_block</span><span class="p">(</span><span class="n">cytnx</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">chi</span><span class="p">))</span>
<span class="n">lb</span><span class="o">.</span><span class="n">put_block</span><span class="p">(</span><span class="n">cytnx</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">chi</span><span class="p">))</span>

<span class="n">la</span><span class="o">.</span><span class="n">print_diagram</span><span class="p">()</span>
<span class="n">lb</span><span class="o">.</span><span class="n">print_diagram</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><p>In c++</p></li>
</ul>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;cytnx.hpp&quot;</span><span class="cp"></span>
<span class="k">namespace</span> <span class="n">cyx</span> <span class="o">=</span> <span class="n">cytnx_extension</span><span class="p">;</span>

<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">chi</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="k">auto</span> <span class="n">A</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">CyTensor</span><span class="p">({</span><span class="n">cyx</span><span class="o">::</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span><span class="n">cyx</span><span class="o">::</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">cyx</span><span class="o">::</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">)},{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">},</span><span class="mi">1</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">B</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">CyTensor</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">bonds</span><span class="p">(),{</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">},</span><span class="mi">1</span><span class="p">);</span>
<span class="n">cytnx</span><span class="o">::</span><span class="n">random</span><span class="o">::</span><span class="n">Make_normal</span><span class="p">(</span><span class="n">B</span><span class="p">.</span><span class="n">get_block_</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">);</span>
<span class="n">cytnx</span><span class="o">::</span><span class="n">random</span><span class="o">::</span><span class="n">Make_normal</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">get_block_</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">);</span>
<span class="n">A</span><span class="p">.</span><span class="n">print_diagram</span><span class="p">();</span>
<span class="n">B</span><span class="p">.</span><span class="n">print_diagram</span><span class="p">();</span>

<span class="k">auto</span> <span class="n">la</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">CyTensor</span><span class="p">({</span><span class="n">cyx</span><span class="o">::</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span><span class="n">cyx</span><span class="o">::</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">)},{</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">},</span><span class="mi">1</span><span class="p">,</span><span class="n">Type</span><span class="p">.</span><span class="n">Double</span><span class="p">,</span><span class="n">Device</span><span class="p">.</span><span class="n">cpu</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">lb</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">::</span><span class="n">CyTensor</span><span class="p">({</span><span class="n">cyx</span><span class="o">::</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">),</span><span class="n">cyx</span><span class="o">::</span><span class="n">Bond</span><span class="p">(</span><span class="n">chi</span><span class="p">)},{</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">},</span><span class="mi">1</span><span class="p">,</span><span class="n">Type</span><span class="p">.</span><span class="n">Double</span><span class="p">,</span><span class="n">Device</span><span class="p">.</span><span class="n">cpu</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
<span class="n">la</span><span class="p">.</span><span class="n">put_block</span><span class="p">(</span><span class="n">cytnx</span><span class="o">::</span><span class="n">ones</span><span class="p">(</span><span class="n">chi</span><span class="p">));</span>
<span class="n">lb</span><span class="p">.</span><span class="n">put_block</span><span class="p">(</span><span class="n">cytnx</span><span class="o">::</span><span class="n">ones</span><span class="p">(</span><span class="n">chi</span><span class="p">));</span>

<span class="n">la</span><span class="p">.</span><span class="n">print_diagram</span><span class="p">();</span>
<span class="n">lb</span><span class="p">.</span><span class="n">print_diagram</span><span class="p">();</span>
</pre></div>
</td></tr></table></div>
<p>Output &gt;&gt;</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-----------------------
tensor Name :
tensor Rank : 3
block_form  : false
is_diag     : False
on device   : cytnx device: CPU
            -------------
           /             \
    -1 ____| 10        2 |____ 0
           |             |
           |          10 |____ -2
           \             /
            -------------
-----------------------
tensor Name :
tensor Rank : 3
block_form  : false
is_diag     : False
on device   : cytnx device: CPU
            -------------
           /             \
    -3 ____| 10        2 |____ 1
           |             |
           |          10 |____ -4
           \             /
            -------------
-----------------------
tensor Name :
tensor Rank : 2
block_form  : false
is_diag     : True
on device   : cytnx device: CPU
            -------------
           /             \
    -2 ____| 10       10 |____ -3
           \             /
            -------------
-----------------------
tensor Name :
tensor Rank : 2
block_form  : false
is_diag     : True
on device   : cytnx device: CPU
            -------------
           /             \
    -4 ____| 10       10 |____ -5
           \             /
            -------------
</pre></div>
</div>
<p>Here, we use <strong>random::Make_normal</strong> to initialize the elements of CyTensor <em>A</em> and <em>B</em> with normal distribution as initial MPS wavefuncion.
The <em>la</em>, <em>lb</em> are the weight matrix (schmit coefficients), hence only diagonal elements contains non-zero values. Thus, we set <strong>is_diag=True</strong> to only store diagonal entries.
We then initialize the elements to be all one for this weight matrices.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In general, there are other ways you can set-up a trial initial MPS wavefunction, as long as not all the elements are zero.</p>
</div>
<div class="section" id="imaginary-time-evolution">
<h2><span class="section-number">2.1. </span>Imaginary time evolution<a class="headerlink" href="#imaginary-time-evolution" title="Permalink to this headline">¶</a></h2>
<p>To optimize the MPS for the ground state wave function, in TEBD, we perform imaginary time evolution with Hamiltonian <img class="math" src="../_images/math/cb5de54f699cf4b3c7c1a3e87313d11d536c0d88.png" alt="H"/> with evolution operator <img class="math" src="../_images/math/fcedc25030b70c3797d0cea5c3d331d0bcaa32f9.png" alt="e^{\tau H}"/>.
The manybody Hamiltonian is then decomposed into local two-sites evolution operator (or sometimes also called gate in quantum computation language) via
Trotter-Suzuki decomposition, where <img class="math" src="../_images/math/3d84f2bb873798ab8373c8e1116b97b17150dcfc.png" alt="U = e^{\tau H} \approx e^{\delta \tau H_{a}}e^{\delta \tau H_{b}} \cdots = U_a U_b"/>, <img class="math" src="../_images/math/73a9fe327915a6411d5622c6cc395603e0a14a2c.png" alt="U_{a,b} = e^{\delta \tau H_{a,b}}"/> are the local evolution operators with <img class="math" src="../_images/math/a8144f0742116176fb284b1b86e67a94d7900596.png" alt="H_a"/> and <img class="math" src="../_images/math/a2e069526944114f5a7fecaac2e260cb4fb043fe.png" alt="H_b"/> are the local two sites operator:</p>
<div class="math">
<p><img src="../_images/math/35c71ae8d4959b8284e0f147b27600b369e9c92e.png" alt="H_{a,b} = J\sigma^{z}_{A,B}\sigma^{z}_{B,A} - \frac{H_x}{2}(\sigma^{x}_A + \sigma^{x}_B)"/></p>
</div><p>This is equivalent as acting theses two-site gates consecutively on the MPS, which in terms of tensor notation looks like following Figure(a):</p>
<a class="reference internal image-reference" href="../_images/itebd_upd.png"><img alt="../_images/itebd_upd.png" class="align-center" src="../_images/itebd_upd.png" style="width: 500px;" /></a>
<p>Since we represent this infinite system MPS using the translational invariant, the Figure(a) can be further simplified into two step.
First, acting <img class="math" src="../_images/math/2363059a61e3ed5453b95a6de83aad3f7525f156.png" alt="U_a"/> as shown in Figure(1) then acting <img class="math" src="../_images/math/d1585c1af4e036c3f5a0e577a2a8fdc54953a8c7.png" alt="U_b"/> as shown in Figure(2).</p>
<p>Let’s construct this imaginary time evolution operator with parameter <img class="math" src="../_images/math/636cc35d45eb12a3401c57f100a3c446f25b5953.png" alt="J=-1"/>, <img class="math" src="../_images/math/b83617f1d6b91090379d598d42a3bf0c56ca690f.png" alt="H_x = -0.3"/> and (imaginary) time step <img class="math" src="../_images/math/1aae7466a9f6dd8274ba90a156145c6d97b5e28d.png" alt="\delta \tau = 0.1"/></p>
<ul class="simple">
<li><p>In python</p></li>
</ul>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">J</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
<span class="n">Hx</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="c1">## Create single site operator</span>
<span class="n">Sz</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">pauli</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">()</span>
<span class="n">Sx</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">pauli</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">()</span>
<span class="n">I</span>  <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Sz</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Sx</span><span class="p">)</span>


<span class="c1">## Construct the local Hamiltonian</span>
<span class="n">TFterm</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">Kron</span><span class="p">(</span><span class="n">Sx</span><span class="p">,</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">Kron</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">Sx</span><span class="p">)</span>
<span class="n">ZZterm</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">Kron</span><span class="p">(</span><span class="n">Sz</span><span class="p">,</span><span class="n">Sz</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">Hx</span><span class="o">*</span><span class="n">TFterm</span> <span class="o">+</span> <span class="n">J</span><span class="o">*</span><span class="n">ZZterm</span>
<span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>


<span class="c1">## Build Evolution Operator</span>
<span class="n">eH</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">ExpH</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="o">-</span><span class="n">dt</span><span class="p">)</span> <span class="c1">## or equivantly ExpH(-dt*H)</span>
<span class="n">eH</span><span class="o">.</span><span class="n">reshape_</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">cyx</span><span class="o">.</span><span class="n">CyTensor</span><span class="p">(</span><span class="n">eH</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">U</span><span class="o">.</span><span class="n">print_diagram</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><p>In c++</p></li>
</ul>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">double</span> <span class="n">J</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>
<span class="kt">double</span> <span class="n">Hx</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">;</span>
<span class="kt">double</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>

<span class="c1">// Create single site operator</span>
<span class="k">auto</span> <span class="n">Sz</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">::</span><span class="n">physics</span><span class="o">::</span><span class="n">pauli</span><span class="p">(</span><span class="sc">&#39;z&#39;</span><span class="p">).</span><span class="n">real</span><span class="p">();</span>
<span class="k">auto</span> <span class="n">Sx</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">::</span><span class="n">physics</span><span class="o">::</span><span class="n">pauli</span><span class="p">(</span><span class="sc">&#39;x&#39;</span><span class="p">).</span><span class="n">real</span><span class="p">();</span>
<span class="k">auto</span> <span class="n">I</span>  <span class="o">=</span> <span class="n">cytnx</span><span class="o">::</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Sz</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Sx</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>


<span class="c1">// Construct the local Hamiltonian</span>
<span class="k">auto</span> <span class="n">TFterm</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">::</span><span class="n">linalg</span><span class="o">::</span><span class="n">Kron</span><span class="p">(</span><span class="n">Sx</span><span class="p">,</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">cytnx</span><span class="o">::</span><span class="n">linalg</span><span class="o">::</span><span class="n">Kron</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">Sx</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">ZZterm</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">::</span><span class="n">linalg</span><span class="o">::</span><span class="n">Kron</span><span class="p">(</span><span class="n">Sz</span><span class="p">,</span><span class="n">Sz</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">H</span> <span class="o">=</span> <span class="n">Hx</span><span class="o">*</span><span class="n">TFterm</span> <span class="o">+</span> <span class="n">J</span><span class="o">*</span><span class="n">ZZterm</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">H</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>


<span class="c1">// Build Evolution Operator</span>
<span class="c1">// [Note] eH is cytnx.Tensor and U is CyTensor.</span>
<span class="k">auto</span> <span class="n">eH</span> <span class="o">=</span> <span class="n">cytnx</span><span class="o">::</span><span class="n">linalg</span><span class="o">::</span><span class="n">ExpH</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="o">-</span><span class="n">dt</span><span class="p">);</span> <span class="c1">//or equivantly ExpH(-dt*H)</span>
<span class="n">eH</span><span class="p">.</span><span class="n">reshape_</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="k">auto</span> <span class="n">U</span> <span class="o">=</span> <span class="n">cyx</span><span class="p">.</span><span class="n">CyTensor</span><span class="p">(</span><span class="n">eH</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">U</span><span class="p">.</span><span class="n">print_diagram</span><span class="p">();</span>
</pre></div>
</td></tr></table></div>
<p>Output&gt;&gt;</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Total elem: 4
type  : Double (Float64)
cytnx device: CPU
Shape : (2,2)
[[1.00000e+00 0.00000e+00 ]
 [0.00000e+00 -1.00000e+00 ]]


Total elem: 4
type  : Double (Float64)
cytnx device: CPU
Shape : (2,2)
[[0.00000e+00 1.00000e+00 ]
 [1.00000e+00 0.00000e+00 ]]


Total elem: 16
type  : Double (Float64)
cytnx device: CPU
Shape : (4,4)
[[-1.00000e+00 3.00000e-01 3.00000e-01 0.00000e+00 ]
 [3.00000e-01 1.00000e+00 0.00000e+00 3.00000e-01 ]
 [3.00000e-01 0.00000e+00 1.00000e+00 3.00000e-01 ]
 [0.00000e+00 3.00000e-01 3.00000e-01 -1.00000e+00 ]]

-----------------------
tensor Name :
tensor Rank : 4
block_form  : false
is_diag     : False
on device   : cytnx device: CPU
            -------------
           /             \
     0 ____| 2         2 |____ 2
           |             |
     1 ____| 2         2 |____ 3
           \             /
            -------------
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>Since <img class="math" src="../_images/math/2363059a61e3ed5453b95a6de83aad3f7525f156.png" alt="U_a"/> and <img class="math" src="../_images/math/d1585c1af4e036c3f5a0e577a2a8fdc54953a8c7.png" alt="U_b"/> have the same content(matrix elements) but acting on different sites, we only need to define a single CyTensor.</p></li>
<li><p>Here as a simple example, we directly convert a <strong>cytnx.Tensor</strong> to <strong>cyx.CyTensor</strong>, which we don’t impose any bra-ket constrain (direction of bonds). In general, it is also possible to give bond direction (which we refering to <em>tagged</em>) that constrain the bonds to be more physical. See Github example/iTEBD/iTEBD_tag.py for demonstration.</p></li>
<li><p>In general, the accurate ground state can be acquired with a higher order Trotter-Suzuki expansion, and with decreasing <img class="math" src="../_images/math/8a17be931fc7513e42c70062ac24c65407c44dca.png" alt="\delta \tau"/> along the iteraction. (See <a class="bibtex reference internal" href="#itebd-vidal" id="id2">[Vid07]</a> for further details), Here, for demonstration, we use fixed value of <img class="math" src="../_images/math/8a17be931fc7513e42c70062ac24c65407c44dca.png" alt="\delta \tau"/>.</p></li>
</ol>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Here, <strong>physics.pauli</strong> returns complex type <strong>cytnx.Tensor</strong>. Since we know pauli-z and pauli-x should be real, we use <em>.real()</em> to get the real part.</p>
</div>
</div>
<div class="section" id="update-procedure">
<h2><span class="section-number">2.2. </span>Update procedure<a class="headerlink" href="#update-procedure" title="Permalink to this headline">¶</a></h2>
<p>Now we have prepared the initial trial wavefunction in terms of MPS with two sites unit cell and the time evolution operator, we are ready to use the aformentioned scheme to find the (variational) ground state MPS.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The complete example code can be found in Github repo under example/iTEBD folder.</p>
</div>
<p id="bibtex-bibliography-example/iTEBD-0"><dl class="citation">
<dt class="bibtex label" id="itebd-vidal"><span class="brackets">Vid07</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>)</span></dt>
<dd><p>G. Vidal. Classical simulation of infinite-size quantum lattice systems in one spatial dimension. <em>Phys. Rev. Lett.</em>, 98:070201, Feb 2007. URL: <a class="reference external" href="https://link.aps.org/doi/10.1103/PhysRevLett.98.070201">https://link.aps.org/doi/10.1103/PhysRevLett.98.070201</a>, <a class="reference external" href="https://doi.org/10.1103/PhysRevLett.98.070201">doi:10.1103/PhysRevLett.98.070201</a>.</p>
</dd>
</dl>
</p>
</div>
</div>


          </div>
        </div>
      </div>
    </div>
      <div class="clearer"></div>
      </div>
    </div>
<footer class="footer d-flex justify-content-between flex-wrap">
    <div class="copyright">
        <div>&copy; Copyright 2019-, Kai-Hsin Wu.</div>
      <div>Generated by <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.1.1 using <a href="https://github.com/myyasuda/sphinxbootstrap4theme">sphinxbootstrap4theme</a> 0.6.0.</div>
    </div>
    <div>
        <a href="#" class="btn btn-primary btn-sm" role="botton">Back to top</a>
    </div>
</footer>
  </body>
</html>