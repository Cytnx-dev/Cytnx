<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cytnx: Cytnx</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Icon_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cytnx
   &#160;<span id="projectnumber">v0.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Cytnx </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Requirements</h2>
<ul>
<li>Boost v1.53+ [check_deleted, atomicadd, intrusive_ptr]</li>
<li>C++11</li>
<li>lapack</li>
<li>blas</li>
<li>gcc v6+</li>
</ul>
<p>[CUDA support]</p><ul>
<li>CUDA v10+</li>
<li>cuDNN</li>
</ul>
<p>[OpenMp support]</p><ul>
<li>openmp</li>
</ul>
<p>[Python]</p><ul>
<li>pybind11 2.2.4</li>
<li>numpy &gt;= 1.15</li>
</ul>
<h2>ubuntu</h2>
<p>sudo apt-get install libboost-all-dev</p>
<h2>compile</h2>
<ul>
<li>compile $make -Bj4</li>
<li>turn on DEBUG mode: $make -Bj4 DEBUG_Enable=1</li>
<li>turn on OpenMp accelerate $make -Bj4 OMP_Enable=1</li>
<li>turn on GPU accelerate $make -Bj4 GPU_Enable=1</li>
<li>turn on GPU+OpenMp accelerate $make -Bj4 GPU_Enable=1 OMP_Enable=1</li>
<li>compile python wrapper $make pyobj -Bj4 &lt;args&gt;</li>
</ul>
<p>&lt;args&gt; can be OMP_Enable, GPU_Enable, DEBUG_Enable, MKL_Enable.</p>
<p>Note: if MKL_Enable=1, will enforce using icpc as compiler.</p>
<h2>Objects:</h2>
<ul>
<li><a class="el" href="classcytnx_1_1Storage.html">Storage </a> [binded]</li>
<li><a class="el" href="classcytnx_1_1Tensor.html">Tensor </a> [binded]</li>
<li><a class="el" href="classcytnx_1_1Bond.html">Bond </a> [binded]</li>
<li><a class="el" href="classcytnx_1_1Accessor.html">Accessor </a> [c++ only]</li>
<li><a class="el" href="classcytnx_1_1Symmetry.html">Symmetry </a> [binded]</li>
<li><a class="el" href="classcytnx_1_1UniTensor.html">UniTensor </a> [binded]</li>
</ul>
<h2>Feature:</h2>
<h3>Python x C++</h3>
<p>Benefit from both side. One can do simple prototype on python side and easy transfer to C++ with small effort!</p>
<div class="fragment"><div class="line"><span class="comment">// c++ version:</span></div><div class="line"><span class="preprocessor">#include &quot;cytnx.hpp&quot;</span></div><div class="line"><a class="code" href="classcytnx_1_1Tensor.html">cytnx::Tensor</a> A({3,4,5},cytnx::Type.Double,cytnx::Device.cpu)</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="comment"># python version:</span></div><div class="line"><span class="keyword">import</span> cytnx</div><div class="line">A =  <a class="code" href="classcytnx_1_1Tensor.html">cytnx.Tensor</a>((3,4,5),dtype=cytnx.Type.Double,device=cytnx.Device.cpu)</div></div><!-- fragment --><h3>1. All the Storage and Tensor can now have mulitple type support.</h3>
<p>The avaliable types are :</p>
<table class="doxtable">
<tr>
<th>cytnx type </th><th>c++ type </th><th>Type object  </th></tr>
<tr>
<td>cytnx_double </td><td>double </td><td>Type.Double </td></tr>
<tr>
<td>cytnx_float </td><td>float </td><td>Type.Float </td></tr>
<tr>
<td>cytnx_uint64 </td><td>uint64_t </td><td>Type.Uint64 </td></tr>
<tr>
<td>cytnx_uint32 </td><td>uint32_t </td><td>Type.Uint32 </td></tr>
<tr>
<td>cytnx_int64 </td><td>int64_t </td><td>Type.Int64 </td></tr>
<tr>
<td>cytnx_int32 </td><td>int32_t </td><td>Type.Int32 </td></tr>
<tr>
<td>cytnx_complex128 </td><td>std::complex&lt;double&gt; </td><td>Type.ComplexDouble </td></tr>
<tr>
<td>cytnx_complex64 </td><td>std::complex&lt;float&gt; </td><td>Type.ComplexFloat </td></tr>
</table>
<h3>2. Storage</h3>
<ul>
<li>Memory container with GPU/CPU support. maintain type conversions (type casting btwn Storages) and moving btwn devices.</li>
<li>Generic type object, the behavior is very similar to python.</li>
</ul>
<div class="fragment"><div class="line">Storage A(400,Type.Double);</div><div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;400;i++)</div><div class="line">    A.at&lt;<span class="keywordtype">double</span>&gt;(i) = i;</div><div class="line"></div><div class="line">Storage B = A; <span class="comment">// A and B share same memory, this is similar as python </span></div><div class="line"></div><div class="line">Storage C = A.<a class="code" href="classcytnx_1_1Tensor.html#acf7f697a9434f9bc98a7d00a555ee982">to</a>(Device.cuda+0); </div></div><!-- fragment --><h3>3. Tensor</h3>
<ul>
<li>A tensor, API very similar to numpy and pytorch.</li>
<li>simple moving btwn CPU and GPU:</li>
</ul>
<div class="fragment"><div class="line">Tensor A({3,4},Type.Double,Device.cpu); <span class="comment">// create tensor on CPU (default)</span></div><div class="line">Tensor B({3,4},Type.Double,Device.cuda+0); <span class="comment">// create tensor on GPU with gpu-id=0</span></div><div class="line"></div><div class="line"></div><div class="line">Tensor C = B; <span class="comment">// C and B share same memory.</span></div><div class="line"></div><div class="line"><span class="comment">// move A to gpu</span></div><div class="line">Tensor D = A.<a class="code" href="classcytnx_1_1Tensor.html#acf7f697a9434f9bc98a7d00a555ee982">to</a>(Device.cuda+0);</div><div class="line"></div><div class="line"><span class="comment">// inplace move A to gpu</span></div><div class="line">A.<a class="code" href="classcytnx_1_1Tensor.html#a114a31fbb8bf4a90f150b6a67e42183a">to_</a>(Device.cuda+0);</div></div><!-- fragment --><ul>
<li>Type conversion in between avaliable: <div class="fragment"><div class="line">Tensor A({3,4},Type.Double);</div><div class="line">Tensor B = A.astype(Type.Uint64); <span class="comment">// cast double to uint64_t</span></div></div><!-- fragment --> <pre class="fragment">    * vitual swap and permute. All the permute and swap will not change the underlying memory
    * Use Contiguous() when needed to actual moving the memory layout.
</pre> <div class="fragment"><div class="line">Tensor A({3,4,5,2},Type.Double);</div><div class="line">A.permute_({0,3,1,2}); <span class="comment">// this will not change the memory, only the shape info is changed.</span></div><div class="line">cout &lt;&lt; A.is_contiguous() &lt;&lt; endl; <span class="comment">// this will be false!</span></div><div class="line"></div><div class="line">A.contiguous_(); <span class="comment">// call Configuous() to actually move the memory.</span></div><div class="line">cout &lt;&lt; A.is_contiguous() &lt;&lt; endl; <span class="comment">// this will be true!</span></div></div><!-- fragment --> <pre class="fragment">    * access single element using .at
</pre> <div class="fragment"><div class="line">Tensor A({3,4,5},Type.Double);</div><div class="line"><span class="keywordtype">double</span> val = A.at&lt;<span class="keywordtype">double</span>&gt;({0,2,2});</div></div><!-- fragment --> <pre class="fragment">    * access elements with python slices similarity:
</pre> <div class="fragment"><div class="line"><span class="keyword">typedef</span> Accessor ac;</div><div class="line">Tensor A({3,4,5},Type.Double);</div><div class="line">Tensor out = A.get({ac(0),ac::all(),ac::range(1,4)}); </div><div class="line"><span class="comment">// equivalent to python: out = A[0,:,1:4]</span></div></div><!-- fragment --></li>
</ul>
<h2>Avaliable linear-algebra function (Keep updating):</h2>
<p>See <a class="el" href="namespacecytnx_1_1linalg.html">cytnx::linalg </a> for further details</p>
<table class="doxtable">
<tr>
<th>func </th><th>inplace </th><th>CPU </th><th>GPU </th><th>callby tn  </th></tr>
<tr>
<td>Add </td><td>x </td><td>Y </td><td>Y </td><td>Y </td></tr>
<tr>
<td>Sub </td><td>x </td><td>Y </td><td>Y </td><td>Y </td></tr>
<tr>
<td>Mul </td><td>x </td><td>Y </td><td>Y </td><td>Y </td></tr>
<tr>
<td>Div </td><td>x </td><td>Y </td><td>Y </td><td>Y </td></tr>
<tr>
<td>+,+=[tn]</td><td>x </td><td>Y </td><td>Y </td><td>Y (Add_) </td></tr>
<tr>
<td>-,-=[tn]</td><td>x </td><td>Y </td><td>Y </td><td>Y (Sub_) </td></tr>
<tr>
<td>*,*=[tn]</td><td>x </td><td>Y </td><td>Y </td><td>Y (Mul_) </td></tr>
<tr>
<td>/,/=[tn]</td><td>x </td><td>Y </td><td>Y </td><td>Y (Div_) </td></tr>
<tr>
<td>Svd </td><td>x </td><td>Y </td><td>Y </td><td>Y </td></tr>
<tr>
<td>Inv </td><td>Inv_ </td><td>Y </td><td>Y </td><td>Y </td></tr>
<tr>
<td>Conj </td><td>Conj_ </td><td>Y </td><td>Y </td><td>Y </td></tr>
<tr>
<td>Exp </td><td>Exp_ </td><td>Y </td><td>Y </td><td>Y </td></tr>
<tr>
<td>Eigh </td><td>x </td><td>Y </td><td>Y </td><td>Y </td></tr>
<tr>
<td>Matmul </td><td>x </td><td>Y </td><td>Y </td><td>N </td></tr>
<tr>
<td>Diag </td><td>x </td><td>Y </td><td>Y </td><td>N </td></tr>
</table>
<h2>Generators</h2>
<pre class="fragment">Tensor: zeros(), ones(), arange()
</pre><h2>Example</h2>
<pre class="fragment">See test.cpp for using C++ .
See test.py for using python  
</pre><h2>Developer</h2>
<pre class="fragment">Kai-Hsin Wu kaihsinwu@gmail.com </pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
