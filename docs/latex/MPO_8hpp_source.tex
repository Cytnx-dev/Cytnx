\hypertarget{MPO_8hpp_source}{}\doxysection{MPO.\+hpp}
\label{MPO_8hpp_source}\index{include/tn\_algo/MPO.hpp@{include/tn\_algo/MPO.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef \_H\_MPO\_}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define \_H\_MPO\_}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}cytnx\_error.hpp"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}Device.hpp"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}intrusive\_ptr\_base.hpp"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}UniTensor.hpp"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include "{}utils/vec\_clone.hpp"{}}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include "{}Accessor.hpp"{}}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <initializer\_list>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include "{}Scalar.hpp"{}}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}tn\_algo/MPS.hpp"{}}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{keyword}{namespace }cytnx \{}
\DoxyCodeLine{19   \textcolor{keyword}{namespace }tn\_algo \{}
\DoxyCodeLine{21     \textcolor{keyword}{class }MPO\_impl : \textcolor{keyword}{public} intrusive\_ptr\_base<MPO\_impl> \{}
\DoxyCodeLine{22      \textcolor{keyword}{private}:}
\DoxyCodeLine{23      \textcolor{keyword}{public}:}
\DoxyCodeLine{24       std::vector<UniTensor> \_TNs;}
\DoxyCodeLine{25 }
\DoxyCodeLine{26       \textcolor{keyword}{friend} \textcolor{keyword}{class }MPS;}
\DoxyCodeLine{27       \textcolor{keyword}{friend} \textcolor{keyword}{class }MPO;}
\DoxyCodeLine{28 }
\DoxyCodeLine{29       boost::intrusive\_ptr<MPO\_impl> clone()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{30         boost::intrusive\_ptr<MPO\_impl> out(\textcolor{keyword}{new} MPO\_impl());}
\DoxyCodeLine{31         out-\/>\_TNs = vec\_clone(this-\/>\_TNs);}
\DoxyCodeLine{32         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{33       \}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35       \textcolor{keyword}{virtual} std::ostream \&Print(std::ostream \&os);}
\DoxyCodeLine{36       \textcolor{keyword}{virtual} cytnx\_uint64 size() \{ \textcolor{keywordflow}{return} 0; \};}
\DoxyCodeLine{37       \textcolor{keyword}{virtual} UniTensor get\_op(\textcolor{keyword}{const} cytnx\_uint64 \&site\_idx);}
\DoxyCodeLine{38     \};}
\DoxyCodeLine{39 }
\DoxyCodeLine{40     \textcolor{keyword}{class }RegularMPO : \textcolor{keyword}{public} MPO\_impl \{}
\DoxyCodeLine{41      \textcolor{keyword}{public}:}
\DoxyCodeLine{42       std::ostream \&Print(std::ostream \&os);}
\DoxyCodeLine{43       cytnx\_uint64 size() \{ \textcolor{keywordflow}{return} this-\/>\_TNs.size(); \};}
\DoxyCodeLine{44       UniTensor get\_op(\textcolor{keyword}{const} cytnx\_uint64 \&site\_idx);}
\DoxyCodeLine{45     \};}
\DoxyCodeLine{47 }
\DoxyCodeLine{48     \textcolor{comment}{// API}}
\DoxyCodeLine{49     \textcolor{keyword}{class }\mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPO}{MPO}} \{}
\DoxyCodeLine{50      \textcolor{keyword}{private}:}
\DoxyCodeLine{51      \textcolor{keyword}{public}:}
\DoxyCodeLine{53       boost::intrusive\_ptr<MPO\_impl> \_impl;}
\DoxyCodeLine{54       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPO}{MPO}}()}
\DoxyCodeLine{55           : \_impl(\textcolor{keyword}{new} RegularMPO())\{}
\DoxyCodeLine{56               \textcolor{comment}{// currently default init is RegularMPO;}}
\DoxyCodeLine{57             \};}
\DoxyCodeLine{58 }
\DoxyCodeLine{59       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPO}{MPO}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPO}{MPO}} \&rhs) \{ \_impl = rhs.\_impl; \}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPO}{MPO}} \&operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPO}{MPO}} \&rhs) \{}
\DoxyCodeLine{63         \_impl = rhs.\_impl;}
\DoxyCodeLine{64         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{65       \}}
\DoxyCodeLine{66 }
\DoxyCodeLine{67       cytnx\_uint64 size() \{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>size(); \}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69       \textcolor{keywordtype}{void} append(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rc) \{ this-\/>\_impl-\/>\_TNs.push\_back(rc); \}}
\DoxyCodeLine{70 }
\DoxyCodeLine{71       \textcolor{keywordtype}{void} assign(\textcolor{keyword}{const} cytnx\_uint64 \&N, \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rc) \{ this-\/>\_impl-\/>\_TNs.assign(N, rc); \}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73       std::vector<UniTensor> \&get\_all() \{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>\_TNs; \}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75       \textcolor{keyword}{const} std::vector<UniTensor> \&get\_all()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>\_TNs; \}}
\DoxyCodeLine{76 }
\DoxyCodeLine{77       \textcolor{comment}{// expose to user:}}
\DoxyCodeLine{78       \textcolor{keyword}{virtual} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} get\_op(\textcolor{keyword}{const} cytnx\_uint64 \&site\_idx) \{}
\DoxyCodeLine{79         \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_op(site\_idx);}
\DoxyCodeLine{80       \};}
\DoxyCodeLine{81     \};}
\DoxyCodeLine{82 }
\DoxyCodeLine{83     std::ostream \&operator<<(std::ostream \&os, \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPO}{MPO}} \&in);}
\DoxyCodeLine{84 }
\DoxyCodeLine{85   \}  \textcolor{comment}{// namespace tn\_algo}}
\DoxyCodeLine{86 \}  \textcolor{comment}{// namespace cytnx}}
\DoxyCodeLine{87 }
\DoxyCodeLine{88 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
