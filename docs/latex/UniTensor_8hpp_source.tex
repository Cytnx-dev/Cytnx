\hypertarget{UniTensor_8hpp_source}{}\doxysection{Uni\+Tensor.\+hpp}
\label{UniTensor_8hpp_source}\index{include/UniTensor.hpp@{include/UniTensor.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef \_H\_UniTensor\_}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define \_H\_UniTensor\_}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}Type.hpp"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}cytnx\_error.hpp"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}Storage.hpp"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}Device.hpp"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}Tensor.hpp"{}}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include "{}Scalar.hpp"{}}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include "{}utils/utils.hpp"{}}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include "{}intrusive\_ptr\_base.hpp"{}}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <map>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <utility>}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <initializer\_list>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include "{}Symmetry.hpp"{}}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include "{}Bond.hpp"{}}}
\DoxyCodeLine{21 \textcolor{comment}{// \#include "{}linalg.hpp"{}}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{comment}{// namespace cytnx\{}}
\DoxyCodeLine{24 \textcolor{keyword}{namespace }cytnx \{}
\DoxyCodeLine{25   \textcolor{keyword}{using namespace }cytnx;}
\DoxyCodeLine{27   \textcolor{keyword}{class }UniTensorType\_class \{}
\DoxyCodeLine{28    \textcolor{keyword}{public}:}
\DoxyCodeLine{29     enum : \textcolor{keywordtype}{int} \{}
\DoxyCodeLine{30       Void = -\/99,}
\DoxyCodeLine{31       Dense = 0,}
\DoxyCodeLine{32       Sparse = 1,}
\DoxyCodeLine{33       Block = 2,}
\DoxyCodeLine{34     \};}
\DoxyCodeLine{35     std::string getname(\textcolor{keyword}{const} \textcolor{keywordtype}{int} \&ut\_type);}
\DoxyCodeLine{36   \};}
\DoxyCodeLine{37   \textcolor{keyword}{extern} UniTensorType\_class UTenType;}
\DoxyCodeLine{39 }
\DoxyCodeLine{41   \textcolor{comment}{// class DenseUniTensor;}}
\DoxyCodeLine{42   \textcolor{comment}{// class SparseUniTensor;}}
\DoxyCodeLine{43   \textcolor{keyword}{class }UniTensor\_base : \textcolor{keyword}{public} intrusive\_ptr\_base<UniTensor\_base> \{}
\DoxyCodeLine{44    \textcolor{keyword}{public}:}
\DoxyCodeLine{45     \textcolor{keywordtype}{int} uten\_type\_id;  \textcolor{comment}{// the unitensor type id.}}
\DoxyCodeLine{46     \textcolor{keywordtype}{bool} \_is\_braket\_form;}
\DoxyCodeLine{47     \textcolor{keywordtype}{bool} \_is\_tag;}
\DoxyCodeLine{48     \textcolor{keywordtype}{bool} \_is\_diag;}
\DoxyCodeLine{49     cytnx\_int64 \_rowrank;}
\DoxyCodeLine{50     std::string \_name;}
\DoxyCodeLine{51     std::vector<std::string> \_labels;}
\DoxyCodeLine{52     std::vector<Bond> \_bonds;}
\DoxyCodeLine{53 }
\DoxyCodeLine{54     \textcolor{keywordtype}{bool} \_update\_braket() \{}
\DoxyCodeLine{55       \textcolor{keywordflow}{if} (\_bonds.size() == 0) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{56 }
\DoxyCodeLine{57       \textcolor{keywordflow}{if} (this-\/>\_bonds[0].type() != bondType::BD\_REG) \{}
\DoxyCodeLine{58         \textcolor{comment}{// check:}}
\DoxyCodeLine{59         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < this-\/>\_bonds.size(); i++) \{}
\DoxyCodeLine{60           \textcolor{keywordflow}{if} (i < this-\/>\_rowrank) \{}
\DoxyCodeLine{61             \textcolor{keywordflow}{if} (this-\/>\_bonds[i].type() != bondType::BD\_KET) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{62           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{63             \textcolor{keywordflow}{if} (this-\/>\_bonds[i].type() != bondType::BD\_BRA) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{64           \}}
\DoxyCodeLine{65         \}}
\DoxyCodeLine{66         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{67       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{68         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{69       \}}
\DoxyCodeLine{70     \}}
\DoxyCodeLine{71 }
\DoxyCodeLine{72     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}};  \textcolor{comment}{// allow wrapper to access the private elems}}
\DoxyCodeLine{73     \textcolor{keyword}{friend} \textcolor{keyword}{class }DenseUniTensor;}
\DoxyCodeLine{74     \textcolor{keyword}{friend} \textcolor{keyword}{class }SparseUniTensor;}
\DoxyCodeLine{75     \textcolor{keyword}{friend} \textcolor{keyword}{class }BlockUniTensor;}
\DoxyCodeLine{76 }
\DoxyCodeLine{77 }
\DoxyCodeLine{78     UniTensor\_base()}
\DoxyCodeLine{79         : \_is\_tag(false),}
\DoxyCodeLine{80           \_name(std::string(\textcolor{stringliteral}{"{}"{}})),}
\DoxyCodeLine{81           \_is\_braket\_form(false),}
\DoxyCodeLine{82           \_rowrank(0),}
\DoxyCodeLine{83           \_is\_diag(false),}
\DoxyCodeLine{84           uten\_type\_id(UTenType.Void)\{\};}
\DoxyCodeLine{85 }
\DoxyCodeLine{86     \textcolor{comment}{// copy\&assignment constr., use intrusive\_ptr's !!}}
\DoxyCodeLine{87     UniTensor\_base(\textcolor{keyword}{const} UniTensor\_base \&rhs);}
\DoxyCodeLine{88     UniTensor\_base \&operator=(UniTensor\_base \&rhs);}
\DoxyCodeLine{89 }
\DoxyCodeLine{90     cytnx\_uint64 rowrank()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_rowrank; \}}
\DoxyCodeLine{91     \textcolor{keywordtype}{bool} is\_diag()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_is\_diag; \}}
\DoxyCodeLine{92     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_braket\_form()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_is\_braket\_form; \}}
\DoxyCodeLine{93     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_tag()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_is\_tag; \}}
\DoxyCodeLine{94     \textcolor{keyword}{const} std::vector<std::string> \&labels()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_labels; \}}
\DoxyCodeLine{101     cytnx\_int64 get\_index(std::string lbl)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{102       std::vector<std::string> lbls = this-\/>\_labels;}
\DoxyCodeLine{103       \textcolor{keywordflow}{for} (cytnx\_uint64 i = 0; i < lbls.size(); i++) \{}
\DoxyCodeLine{104         \textcolor{keywordflow}{if} (lbls[i] == lbl) \textcolor{keywordflow}{return} i;}
\DoxyCodeLine{105       \}}
\DoxyCodeLine{106       \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{107     \}}
\DoxyCodeLine{108     \textcolor{keyword}{const} std::vector<Bond> \&bonds()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_bonds; \}}
\DoxyCodeLine{109     std::vector<Bond> \&bonds() \{ \textcolor{keywordflow}{return} this-\/>\_bonds; \}}
\DoxyCodeLine{110     \textcolor{keyword}{const} std::string \&name()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_name; \}}
\DoxyCodeLine{111     cytnx\_uint64 rank()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_labels.size(); \}}
\DoxyCodeLine{112     \textcolor{keywordtype}{void} set\_name(\textcolor{keyword}{const} std::string \&in) \{ this-\/>\_name = in; \}}
\DoxyCodeLine{113     \textcolor{keywordtype}{void} set\_label(\textcolor{keyword}{const} std::string \&oldlbl, \textcolor{keyword}{const} std::string \&new\_label) \{}
\DoxyCodeLine{114       cytnx\_int64 idx;}
\DoxyCodeLine{115       \textcolor{keyword}{auto} res = std::find(this-\/>\_labels.begin(), this-\/>\_labels.end(), oldlbl);}
\DoxyCodeLine{116       cytnx\_error\_msg(res == this-\/>\_labels.end(), \textcolor{stringliteral}{"{}[ERROR] label \%s not exists.\(\backslash\)n"{}}, oldlbl);}
\DoxyCodeLine{117       idx = std::distance(this-\/>\_labels.begin(), res);}
\DoxyCodeLine{118 }
\DoxyCodeLine{119       cytnx\_error\_msg(idx >= this-\/>\_labels.size(), \textcolor{stringliteral}{"{}[ERROR] index exceed the rank of UniTensor\%s"{}},}
\DoxyCodeLine{120                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{121       \textcolor{comment}{// check in:}}
\DoxyCodeLine{122       \textcolor{keywordtype}{bool} is\_dup = \textcolor{keyword}{false};}
\DoxyCodeLine{123       \textcolor{keywordflow}{for} (cytnx\_uint64 i = 0; i < this-\/>\_labels.size(); i++) \{}
\DoxyCodeLine{124         \textcolor{keywordflow}{if} (i == idx) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{125         \textcolor{keywordflow}{if} (new\_label == this-\/>\_labels[i]) \{}
\DoxyCodeLine{126           is\_dup = \textcolor{keyword}{true};}
\DoxyCodeLine{127           \textcolor{keywordflow}{break};}
\DoxyCodeLine{128         \}}
\DoxyCodeLine{129       \}}
\DoxyCodeLine{130       cytnx\_error\_msg(is\_dup, \textcolor{stringliteral}{"{}[ERROR] alreay has a label that is the same as the input label\%s"{}},}
\DoxyCodeLine{131                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{132       this-\/>\_labels[idx] = new\_label;}
\DoxyCodeLine{133     \}}
\DoxyCodeLine{134     \textcolor{keywordtype}{void} set\_label(\textcolor{keyword}{const} cytnx\_int64 \&inx, \textcolor{keyword}{const} std::string \&new\_label) \{}
\DoxyCodeLine{135       cytnx\_error\_msg(inx < 0 , \textcolor{stringliteral}{"{}[ERROR] index is negative\%s"{}},}
\DoxyCodeLine{136                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{137       cytnx\_error\_msg(inx >= this-\/>\_labels.size(), \textcolor{stringliteral}{"{}[ERROR] index exceed the rank of UniTensor\%s"{}},}
\DoxyCodeLine{138                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{139       \textcolor{comment}{// check in:}}
\DoxyCodeLine{140       \textcolor{keywordtype}{bool} is\_dup = \textcolor{keyword}{false};}
\DoxyCodeLine{141       \textcolor{keywordflow}{for} (cytnx\_uint64 i = 0; i < this-\/>\_labels.size(); i++) \{}
\DoxyCodeLine{142         \textcolor{keywordflow}{if} (i == inx) \textcolor{keywordflow}{continue};}
\DoxyCodeLine{143         \textcolor{keywordflow}{if} (new\_label == this-\/>\_labels[i]) \{}
\DoxyCodeLine{144           is\_dup = \textcolor{keyword}{true};}
\DoxyCodeLine{145           \textcolor{keywordflow}{break};}
\DoxyCodeLine{146         \}}
\DoxyCodeLine{147       \}}
\DoxyCodeLine{148       cytnx\_error\_msg(is\_dup, \textcolor{stringliteral}{"{}[ERROR] alreay has a label that is the same as the input label\%s"{}},}
\DoxyCodeLine{149                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{150       this-\/>\_labels[inx] = new\_label;}
\DoxyCodeLine{151     \}}
\DoxyCodeLine{160     \textcolor{keywordtype}{void} set\_label(\textcolor{keyword}{const} cytnx\_int64 \&inx, \textcolor{keyword}{const} cytnx\_int64 \&new\_label) \{}
\DoxyCodeLine{161       set\_label(inx, std::to\_string(new\_label));}
\DoxyCodeLine{162     \}}
\DoxyCodeLine{172     \textcolor{keywordtype}{void} set\_label(\textcolor{keyword}{const} cytnx\_int64 \&inx, \textcolor{keyword}{const} cytnx\_int64 \&\_new\_label, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label) \{}
\DoxyCodeLine{173       std::string new\_label = std::to\_string(\_new\_label);}
\DoxyCodeLine{174       cytnx\_int64 idx;}
\DoxyCodeLine{175       \textcolor{keywordflow}{if} (by\_label) \{}
\DoxyCodeLine{176         \textcolor{keyword}{auto} res = std::find(this-\/>\_labels.begin(), this-\/>\_labels.end(), std::to\_string(inx));}
\DoxyCodeLine{177         cytnx\_error\_msg(res == this-\/>\_labels.end(), \textcolor{stringliteral}{"{}[ERROR] label \%s not exists.\(\backslash\)n"{}}, inx);}
\DoxyCodeLine{178         idx = std::distance(this-\/>\_labels.begin(), res);}
\DoxyCodeLine{179       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{180         idx = inx;}
\DoxyCodeLine{181       \}}
\DoxyCodeLine{182      }
\DoxyCodeLine{183       set\_label(idx,new\_label);}
\DoxyCodeLine{184 }
\DoxyCodeLine{185     \}}
\DoxyCodeLine{193     \textcolor{keywordtype}{void} set\_labels(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_labels);}
\DoxyCodeLine{194     \textcolor{keywordtype}{void} set\_labels(\textcolor{keyword}{const} std::vector<std::string> \&new\_labels);}
\DoxyCodeLine{195     }
\DoxyCodeLine{196 }
\DoxyCodeLine{197 }
\DoxyCodeLine{198     \textcolor{comment}{/*}}
\DoxyCodeLine{199 \textcolor{comment}{    template<class T>}}
\DoxyCodeLine{200 \textcolor{comment}{    T get\_elem(const std::vector<cytnx\_uint64> \&locator) const\{}}
\DoxyCodeLine{201 \textcolor{comment}{        if(this-\/>is\_blockform())\{}}
\DoxyCodeLine{202 \textcolor{comment}{            if(this-\/>elem\_exists(locator))\{}}
\DoxyCodeLine{203 \textcolor{comment}{                T aux; // [workaround] use aux to dispatch.}}
\DoxyCodeLine{204 \textcolor{comment}{                return this-\/>at\_for\_sparse(locator,aux);}}
\DoxyCodeLine{205 \textcolor{comment}{            \}else\{}}
\DoxyCodeLine{206 \textcolor{comment}{                return 0;}}
\DoxyCodeLine{207 \textcolor{comment}{            \}}}
\DoxyCodeLine{208 \textcolor{comment}{        \}else\{}}
\DoxyCodeLine{209 \textcolor{comment}{            return this-\/>at<T>(locator);}}
\DoxyCodeLine{210 \textcolor{comment}{        \}}}
\DoxyCodeLine{211 \textcolor{comment}{    \}}}
\DoxyCodeLine{212 \textcolor{comment}{    template<class T>}}
\DoxyCodeLine{213 \textcolor{comment}{    void set\_elem(const std::vector<cytnx\_uint64> \&locator, const T \&input)\{}}
\DoxyCodeLine{214 \textcolor{comment}{        if(this-\/>uten\_type()==UTenType.Sparse)\{}}
\DoxyCodeLine{215 \textcolor{comment}{            if(this-\/>elem\_exists(locator))\{}}
\DoxyCodeLine{216 \textcolor{comment}{                T aux;}}
\DoxyCodeLine{217 \textcolor{comment}{                this-\/>at\_for\_sparse(locator,aux) = input;}}
\DoxyCodeLine{218 \textcolor{comment}{            \}else\{}}
\DoxyCodeLine{219 \textcolor{comment}{                cytnx\_error\_msg(true,"{}[ERROR][SparseUniTensor] invalid location. break qnum}}
\DoxyCodeLine{220 \textcolor{comment}{    block.\%s"{},"{}\(\backslash\)n"{});}}
\DoxyCodeLine{221 \textcolor{comment}{            \}}}
\DoxyCodeLine{222 \textcolor{comment}{        \}else\{}}
\DoxyCodeLine{223 \textcolor{comment}{            this-\/>at<T>(locator) = input;}}
\DoxyCodeLine{224 \textcolor{comment}{        \}}}
\DoxyCodeLine{225 \textcolor{comment}{    \}}}
\DoxyCodeLine{226 \textcolor{comment}{    */}}
\DoxyCodeLine{227 }
\DoxyCodeLine{228     \textcolor{keywordtype}{int} uten\_type() \{ \textcolor{keywordflow}{return} this-\/>uten\_type\_id; \}}
\DoxyCodeLine{229     std::string uten\_type\_str() \{ \textcolor{keywordflow}{return} UTenType.getname(this-\/>uten\_type\_id); \}}
\DoxyCodeLine{230     }
\DoxyCodeLine{231 }
\DoxyCodeLine{233 }
\DoxyCodeLine{234     \textcolor{comment}{// string labels! }}
\DoxyCodeLine{235     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Init(\textcolor{keyword}{const} std::vector<Bond> \&bonds,}
\DoxyCodeLine{236                       \textcolor{keyword}{const} std::vector<std::string> \&in\_labels = \{\},}
\DoxyCodeLine{237                       \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype = Type.Double,}
\DoxyCodeLine{238                       \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device = Device.cpu, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false},}
\DoxyCodeLine{239                       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&no\_alloc = \textcolor{keyword}{false});}
\DoxyCodeLine{240     }
\DoxyCodeLine{241     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Init\_by\_Tensor(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false},}
\DoxyCodeLine{242                                 \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1);}
\DoxyCodeLine{243     \textcolor{keyword}{virtual} std::vector<cytnx\_uint64> shape() \textcolor{keyword}{const};}
\DoxyCodeLine{244     \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} is\_blockform() \textcolor{keyword}{const};}
\DoxyCodeLine{245     \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} is\_contiguous() \textcolor{keyword}{const};}
\DoxyCodeLine{246     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} to\_(\textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device);}
\DoxyCodeLine{247     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> to(\textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device);}
\DoxyCodeLine{248     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> clone() \textcolor{keyword}{const};}
\DoxyCodeLine{249     \textcolor{keyword}{virtual} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} dtype() \textcolor{keyword}{const};}
\DoxyCodeLine{250     \textcolor{keyword}{virtual} \textcolor{keywordtype}{int} device() \textcolor{keyword}{const};}
\DoxyCodeLine{251     \textcolor{keyword}{virtual} std::string dtype\_str() \textcolor{keyword}{const};}
\DoxyCodeLine{252     \textcolor{keyword}{virtual} std::string device\_str() \textcolor{keyword}{const};}
\DoxyCodeLine{253     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} set\_rowrank(\textcolor{keyword}{const} cytnx\_uint64 \&new\_rowrank);}
\DoxyCodeLine{254    }
\DoxyCodeLine{255 }
\DoxyCodeLine{256 }
\DoxyCodeLine{257     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> permute(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&mapper,}
\DoxyCodeLine{258                                                          \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1,}
\DoxyCodeLine{259                                                          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label= \textcolor{keyword}{false});}
\DoxyCodeLine{260     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> permute(\textcolor{keyword}{const} std::vector<std::string> \&mapper,}
\DoxyCodeLine{261                                                          \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1);}
\DoxyCodeLine{262     \textcolor{comment}{//virtual boost::intrusive\_ptr<UniTensor\_base> permute(const std::vector<cytnx\_int64> \&mapper,}}
\DoxyCodeLine{263     \textcolor{comment}{//                                                     const cytnx\_int64 \&rowrank = -\/1);}}
\DoxyCodeLine{264 }
\DoxyCodeLine{265     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} permute\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank=-\/1,}
\DoxyCodeLine{266                           \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label=\textcolor{keyword}{false});}
\DoxyCodeLine{267     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} permute\_(\textcolor{keyword}{const} std::vector<std::string> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1);}
\DoxyCodeLine{268     \textcolor{comment}{//virtual void permute\_(const std::vector<cytnx\_int64> \&mapper, const cytnx\_int64 \&rowrank = -\/1);}}
\DoxyCodeLine{269     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> contiguous\_();}
\DoxyCodeLine{270     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> contiguous();}
\DoxyCodeLine{271     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} print\_diagram(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&bond\_info = \textcolor{keyword}{false});}
\DoxyCodeLine{272     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} print\_blocks(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&full\_info=\textcolor{keyword}{true}) \textcolor{keyword}{const}; }
\DoxyCodeLine{273     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} print\_block(\textcolor{keyword}{const} cytnx\_int64 \&idx, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&full\_info=\textcolor{keyword}{true}) \textcolor{keyword}{const};}
\DoxyCodeLine{274 }
\DoxyCodeLine{275     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> astype(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype) \textcolor{keyword}{const};}
\DoxyCodeLine{276 }
\DoxyCodeLine{277     \textcolor{keyword}{virtual} cytnx\_uint64 Nblocks()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} 0; \};}
\DoxyCodeLine{278     \textcolor{keyword}{virtual} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} get\_block(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0) \textcolor{keyword}{const};  \textcolor{comment}{// return a copy of block}}
\DoxyCodeLine{279     \textcolor{keyword}{virtual} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} get\_block(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum,}
\DoxyCodeLine{280                              \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force) \textcolor{keyword}{const};  \textcolor{comment}{// return a copy of block}}
\DoxyCodeLine{281 }
\DoxyCodeLine{282     \textcolor{keyword}{virtual} \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0)}
\DoxyCodeLine{283       \textcolor{keyword}{const};  \textcolor{comment}{// return a share view of block, this only work for non-\/symm tensor.}}
\DoxyCodeLine{284     \textcolor{keyword}{virtual} \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum,}
\DoxyCodeLine{285                                      \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force) \textcolor{keyword}{const};  \textcolor{comment}{// return a copy of block}}
\DoxyCodeLine{286     \textcolor{keyword}{virtual} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0);  \textcolor{comment}{// return a share view of block, this}}
\DoxyCodeLine{287                                                               \textcolor{comment}{// only work for non-\/symm tensor.}}
\DoxyCodeLine{288     \textcolor{keyword}{virtual} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum,}
\DoxyCodeLine{289                                \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force);  \textcolor{comment}{// return a copy of block}}
\DoxyCodeLine{290     \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} same\_data(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs) \textcolor{keyword}{const};}
\DoxyCodeLine{291 }
\DoxyCodeLine{292     \textcolor{keyword}{virtual} std::vector<Tensor> get\_blocks() \textcolor{keyword}{const};}
\DoxyCodeLine{293     \textcolor{keyword}{virtual} \textcolor{keyword}{const} std::vector<Tensor> \&get\_blocks\_(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{294     \textcolor{keyword}{virtual} std::vector<Tensor> \&get\_blocks\_(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&);}
\DoxyCodeLine{295 }
\DoxyCodeLine{296     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} put\_block(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} cytnx\_uint64 \&idx = 0);}
\DoxyCodeLine{297     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} put\_block\_(\mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} cytnx\_uint64 \&idx = 0);}
\DoxyCodeLine{298     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} put\_block(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum,}
\DoxyCodeLine{299                            \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force);}
\DoxyCodeLine{300     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} put\_block\_(\mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force);}
\DoxyCodeLine{301 }
\DoxyCodeLine{302     \textcolor{comment}{// this will only work on non-\/symm tensor (DenseUniTensor)}}
\DoxyCodeLine{303     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> get(\textcolor{keyword}{const} std::vector<Accessor> \&accessors);}
\DoxyCodeLine{304 }
\DoxyCodeLine{305     \textcolor{comment}{// this will only work on non-\/symm tensor (DenseUniTensor)}}
\DoxyCodeLine{306     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} set(\textcolor{keyword}{const} std::vector<Accessor> \&accessors, \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&rhs);}
\DoxyCodeLine{307 }
\DoxyCodeLine{308     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} reshape\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_shape,}
\DoxyCodeLine{309                           \textcolor{keyword}{const} cytnx\_uint64 \&rowrank = 0);}
\DoxyCodeLine{310     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> reshape(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_shape,}
\DoxyCodeLine{311                                                          \textcolor{keyword}{const} cytnx\_uint64 \&rowrank = 0);}
\DoxyCodeLine{312     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> to\_dense();}
\DoxyCodeLine{313     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} to\_dense\_();}
\DoxyCodeLine{314     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} combineBonds(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&indicators, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force,}
\DoxyCodeLine{315                               \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{316     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} combineBonds(\textcolor{keyword}{const} std::vector<std::string> \&indicators,}
\DoxyCodeLine{317                               \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{false});}
\DoxyCodeLine{318     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} combineBonds(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&indicators,}
\DoxyCodeLine{319                               \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{false});}
\DoxyCodeLine{320     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> contract(}
\DoxyCodeLine{321       \textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&mv\_elem\_self = \textcolor{keyword}{false},}
\DoxyCodeLine{322       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&mv\_elem\_rhs = \textcolor{keyword}{false});}
\DoxyCodeLine{323     \textcolor{keyword}{virtual} std::vector<Bond> getTotalQnums(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&physical = \textcolor{keyword}{false});}
\DoxyCodeLine{324     \textcolor{keyword}{virtual} std::vector<std::vector<cytnx\_int64>> get\_blocks\_qnums() \textcolor{keyword}{const};}
\DoxyCodeLine{325     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Trace\_(\textcolor{keyword}{const} std::string \&a, \textcolor{keyword}{const} std::string \&b);}
\DoxyCodeLine{326     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Trace\_(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b);}
\DoxyCodeLine{327     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Trace\_(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{328     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> Trace(\textcolor{keyword}{const} std::string \&a, \textcolor{keyword}{const} std::string \&b);}
\DoxyCodeLine{329     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> Trace(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b);}
\DoxyCodeLine{330     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> Trace(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b,}
\DoxyCodeLine{331                                                        \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{332     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> relabels(}
\DoxyCodeLine{333       \textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_labels);}
\DoxyCodeLine{334     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> relabels(}
\DoxyCodeLine{335       \textcolor{keyword}{const} std::vector<std::string> \&new\_labels);}
\DoxyCodeLine{336     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} cytnx\_int64 \&inx,}
\DoxyCodeLine{337                                                          \textcolor{keyword}{const} cytnx\_int64 \&new\_label,}
\DoxyCodeLine{338                                                          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{339     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} std::string \&inx,}
\DoxyCodeLine{340                                                          \textcolor{keyword}{const} std::string \&new\_label);}
\DoxyCodeLine{341     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} cytnx\_int64 \&inx,}
\DoxyCodeLine{342                                                          \textcolor{keyword}{const} cytnx\_int64 \&new\_label);}
\DoxyCodeLine{343     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} cytnx\_int64 \&inx,}
\DoxyCodeLine{344                                                          \textcolor{keyword}{const} std::string \&new\_label);}
\DoxyCodeLine{345 }
\DoxyCodeLine{346     \textcolor{keyword}{virtual} std::vector<Symmetry> syms() \textcolor{keyword}{const};}
\DoxyCodeLine{347 }
\DoxyCodeLine{348     \textcolor{comment}{// arithmetic}}
\DoxyCodeLine{349     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Add\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{350     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Add\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{351 }
\DoxyCodeLine{352     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Mul\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{353     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Mul\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{354 }
\DoxyCodeLine{355     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Sub\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{356     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Sub\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{357     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} lSub\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&lhs);}
\DoxyCodeLine{358 }
\DoxyCodeLine{359     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Div\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{360     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Div\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{361     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} lDiv\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&lhs);}
\DoxyCodeLine{362 }
\DoxyCodeLine{363     \textcolor{keyword}{virtual} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \mbox{\hyperlink{namespacecytnx_1_1linalg_a9cd2be179860bb4742ebe320fa063680}{Norm}}() \textcolor{keyword}{const};}
\DoxyCodeLine{364 }
\DoxyCodeLine{365     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> \mbox{\hyperlink{namespacecytnx_1_1linalg_a470d0886432554a35ecaf961451c0806}{Conj}}();}
\DoxyCodeLine{366     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecytnx_1_1linalg_adc3233bf8bc3eb6a435340f912412801}{Conj\_}}();}
\DoxyCodeLine{367 }
\DoxyCodeLine{368     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> Transpose();}
\DoxyCodeLine{369     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Transpose\_();}
\DoxyCodeLine{370 }
\DoxyCodeLine{371     \textcolor{keyword}{virtual} boost::intrusive\_ptr<UniTensor\_base> Dagger();}
\DoxyCodeLine{372     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Dagger\_();}
\DoxyCodeLine{373 }
\DoxyCodeLine{374     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} tag();}
\DoxyCodeLine{375 }
\DoxyCodeLine{376     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} truncate\_(\textcolor{keyword}{const} cytnx\_int64 \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim,}
\DoxyCodeLine{377                            \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{378     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} truncate\_(\textcolor{keyword}{const} std::string \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim);}
\DoxyCodeLine{379     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} truncate\_(\textcolor{keyword}{const} cytnx\_int64 \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim);}
\DoxyCodeLine{380 }
\DoxyCodeLine{381     \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} elem\_exists(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator) \textcolor{keyword}{const};}
\DoxyCodeLine{382 }
\DoxyCodeLine{383     \textcolor{comment}{// this a workaround, as virtual function cannot template.}}
\DoxyCodeLine{384     \textcolor{keyword}{virtual} Scalar::Sproxy at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator);}
\DoxyCodeLine{385     \textcolor{keyword}{virtual} \textcolor{keyword}{const} Scalar::Sproxy at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator) \textcolor{keyword}{const};}
\DoxyCodeLine{386 }
\DoxyCodeLine{387     \textcolor{keyword}{virtual} cytnx\_complex128 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{388                                             \textcolor{keyword}{const} cytnx\_complex128 \&aux);}
\DoxyCodeLine{389     \textcolor{keyword}{virtual} cytnx\_complex64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{390                                            \textcolor{keyword}{const} cytnx\_complex64 \&aux);}
\DoxyCodeLine{391     \textcolor{keyword}{virtual} cytnx\_double \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{392                                         \textcolor{keyword}{const} cytnx\_double \&aux);}
\DoxyCodeLine{393     \textcolor{keyword}{virtual} cytnx\_float \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{394                                        \textcolor{keyword}{const} cytnx\_float \&aux);}
\DoxyCodeLine{395     \textcolor{keyword}{virtual} cytnx\_uint64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{396                                         \textcolor{keyword}{const} cytnx\_uint64 \&aux);}
\DoxyCodeLine{397     \textcolor{keyword}{virtual} cytnx\_int64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{398                                        \textcolor{keyword}{const} cytnx\_int64 \&aux);}
\DoxyCodeLine{399     \textcolor{keyword}{virtual} cytnx\_uint32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{400                                         \textcolor{keyword}{const} cytnx\_uint32 \&aux);}
\DoxyCodeLine{401     \textcolor{keyword}{virtual} cytnx\_int32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{402                                        \textcolor{keyword}{const} cytnx\_int32 \&aux);}
\DoxyCodeLine{403     \textcolor{keyword}{virtual} cytnx\_uint16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{404                                         \textcolor{keyword}{const} cytnx\_uint16 \&aux);}
\DoxyCodeLine{405     \textcolor{keyword}{virtual} cytnx\_int16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{406                                        \textcolor{keyword}{const} cytnx\_int16 \&aux);}
\DoxyCodeLine{407 }
\DoxyCodeLine{408     \textcolor{keyword}{virtual} \textcolor{keyword}{const} cytnx\_complex128 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{409                                                   \textcolor{keyword}{const} cytnx\_complex128 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{410     \textcolor{keyword}{virtual} \textcolor{keyword}{const} cytnx\_complex64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{411                                                  \textcolor{keyword}{const} cytnx\_complex64 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{412     \textcolor{keyword}{virtual} \textcolor{keyword}{const} cytnx\_double \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{413                                               \textcolor{keyword}{const} cytnx\_double \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{414     \textcolor{keyword}{virtual} \textcolor{keyword}{const} cytnx\_float \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{415                                              \textcolor{keyword}{const} cytnx\_float \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{416     \textcolor{keyword}{virtual} \textcolor{keyword}{const} cytnx\_uint64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{417                                               \textcolor{keyword}{const} cytnx\_uint64 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{418     \textcolor{keyword}{virtual} \textcolor{keyword}{const} cytnx\_int64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{419                                              \textcolor{keyword}{const} cytnx\_int64 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{420     \textcolor{keyword}{virtual} \textcolor{keyword}{const} cytnx\_uint32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{421                                               \textcolor{keyword}{const} cytnx\_uint32 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{422     \textcolor{keyword}{virtual} \textcolor{keyword}{const} cytnx\_int32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{423                                              \textcolor{keyword}{const} cytnx\_int32 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{424     \textcolor{keyword}{virtual} \textcolor{keyword}{const} cytnx\_uint16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{425                                               \textcolor{keyword}{const} cytnx\_uint16 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{426     \textcolor{keyword}{virtual} \textcolor{keyword}{const} cytnx\_int16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{427                                              \textcolor{keyword}{const} cytnx\_int16 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{428 }
\DoxyCodeLine{429     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} group\_basis\_();}
\DoxyCodeLine{430     \textcolor{keyword}{virtual} \textcolor{keyword}{const} std::vector<cytnx\_uint64>\& get\_qindices(\textcolor{keyword}{const} cytnx\_uint64 \&bidx) \textcolor{keyword}{const};}
\DoxyCodeLine{431     \textcolor{keyword}{virtual} std::vector<cytnx\_uint64>\& get\_qindices(\textcolor{keyword}{const} cytnx\_uint64 \&bidx);}
\DoxyCodeLine{432     \textcolor{keyword}{virtual} \textcolor{keyword}{const} vec2d<cytnx\_uint64> \& get\_itoi() \textcolor{keyword}{const};}
\DoxyCodeLine{433     \textcolor{keyword}{virtual} vec2d<cytnx\_uint64> \& get\_itoi();}
\DoxyCodeLine{434 }
\DoxyCodeLine{435 }
\DoxyCodeLine{436     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \_save\_dispatch(std::fstream \&f) \textcolor{keyword}{const};}
\DoxyCodeLine{437     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \_load\_dispatch(std::fstream \&f);}
\DoxyCodeLine{438 }
\DoxyCodeLine{439     \textcolor{keyword}{virtual} \string~UniTensor\_base()\{\};}
\DoxyCodeLine{440   \};}
\DoxyCodeLine{442 }
\DoxyCodeLine{443   \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{445 \textcolor{comment}{}  \textcolor{keyword}{class }DenseUniTensor : \textcolor{keyword}{public} UniTensor\_base \{}
\DoxyCodeLine{446    \textcolor{keyword}{protected}:}
\DoxyCodeLine{447    \textcolor{keyword}{public}:}
\DoxyCodeLine{448     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \_block;}
\DoxyCodeLine{449     std::vector<Tensor> \_interface\_block;  \textcolor{comment}{// this is serves as interface for get\_blocks\_();}}
\DoxyCodeLine{450     DenseUniTensor *clone\_meta()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{451       DenseUniTensor *tmp = \textcolor{keyword}{new} DenseUniTensor();}
\DoxyCodeLine{452       tmp-\/>\_bonds = vec\_clone(this-\/>\_bonds);}
\DoxyCodeLine{453       tmp-\/>\_labels = this-\/>\_labels;}
\DoxyCodeLine{454       tmp-\/>\_is\_braket\_form = this-\/>\_is\_braket\_form;}
\DoxyCodeLine{455       tmp-\/>\_rowrank = this-\/>\_rowrank;}
\DoxyCodeLine{456       tmp-\/>\_is\_diag = this-\/>\_is\_diag;}
\DoxyCodeLine{457       tmp-\/>\_name = this-\/>\_name;}
\DoxyCodeLine{458       tmp-\/>\_is\_tag = this-\/>\_is\_tag;}
\DoxyCodeLine{459       \textcolor{keywordflow}{return} tmp;}
\DoxyCodeLine{460     \}}
\DoxyCodeLine{461     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{462 }
\DoxyCodeLine{463     DenseUniTensor() \{ this-\/>uten\_type\_id = UTenType.Dense; \};}
\DoxyCodeLine{464     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}};  \textcolor{comment}{// allow wrapper to access the private elems}}
\DoxyCodeLine{465     \textcolor{comment}{// virtual functions}}
\DoxyCodeLine{466     }
\DoxyCodeLine{467     \textcolor{comment}{//void Init(const std::vector<Bond> \&bonds, const std::vector<cytnx\_int64> \&in\_labels = \{\},}}
\DoxyCodeLine{468     \textcolor{comment}{//          const cytnx\_int64 \&rowrank = -\/1, const unsigned int \&dtype = Type.Double,}}
\DoxyCodeLine{469     \textcolor{comment}{//          const int \&device = Device.cpu, const bool \&is\_diag = false,}}
\DoxyCodeLine{470     \textcolor{comment}{//          const bool \&no\_alloc = false);}}
\DoxyCodeLine{471 }
\DoxyCodeLine{472     \textcolor{keywordtype}{void} Init(\textcolor{keyword}{const} std::vector<Bond> \&bonds, \textcolor{keyword}{const} std::vector<std::string> \&in\_labels = \{\},}
\DoxyCodeLine{473               \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype = Type.Double,}
\DoxyCodeLine{474               \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device = Device.cpu, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false},}
\DoxyCodeLine{475               \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&no\_alloc = \textcolor{keyword}{false});}
\DoxyCodeLine{476     \textcolor{comment}{// this only work for non-\/symm tensor}}
\DoxyCodeLine{477     \textcolor{keywordtype}{void} Init\_by\_Tensor(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in\_tensor, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false},}
\DoxyCodeLine{478                         \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1);}
\DoxyCodeLine{479     std::vector<cytnx\_uint64> shape()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{480       \textcolor{keywordflow}{if} (this-\/>\_is\_diag) \{}
\DoxyCodeLine{481         std::vector<cytnx\_uint64> shape = this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_af36ef858677f13dcda8512fd9b5ae475}{shape}}();}
\DoxyCodeLine{482         shape.push\_back(shape[0]);}
\DoxyCodeLine{483         \textcolor{keywordflow}{return} shape;}
\DoxyCodeLine{484       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{485         \textcolor{keywordflow}{return} this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_af36ef858677f13dcda8512fd9b5ae475}{shape}}();}
\DoxyCodeLine{486       \}}
\DoxyCodeLine{487     \}}
\DoxyCodeLine{488     \textcolor{keywordtype}{bool} is\_blockform()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \}}
\DoxyCodeLine{489     \textcolor{keywordtype}{void} to\_(\textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device) \{ this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_a114a31fbb8bf4a90f150b6a67e42183a}{to\_}}(device); \}}
\DoxyCodeLine{490     boost::intrusive\_ptr<UniTensor\_base> to(\textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device) \{}
\DoxyCodeLine{491       \textcolor{keywordflow}{if} (this-\/>device() == device) \{}
\DoxyCodeLine{492         \textcolor{keywordflow}{return} \textcolor{keyword}{this};}
\DoxyCodeLine{493       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{494         boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{495         out-\/>to\_(device);}
\DoxyCodeLine{496         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{497       \}}
\DoxyCodeLine{498     \}}
\DoxyCodeLine{499     \textcolor{keywordtype}{void} set\_rowrank(\textcolor{keyword}{const} cytnx\_uint64 \&new\_rowrank) \{}
\DoxyCodeLine{500       cytnx\_error\_msg(new\_rowrank > this-\/>\_labels.size(),}
\DoxyCodeLine{501                       \textcolor{stringliteral}{"{}[ERROR] rowrank cannot exceed the rank of UniTensor.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{502       \textcolor{keywordflow}{if}(this-\/>is\_diag())\{}
\DoxyCodeLine{503         cytnx\_error\_msg(new\_rowrank != 1,}
\DoxyCodeLine{504                       \textcolor{stringliteral}{"{}[ERROR] rowrank should be [==1] when is\_diag =true!.\%s"{}},}
\DoxyCodeLine{505                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{506       \}}
\DoxyCodeLine{507 }
\DoxyCodeLine{508       this-\/>\_rowrank = new\_rowrank;}
\DoxyCodeLine{509     \}}
\DoxyCodeLine{510 }
\DoxyCodeLine{511     boost::intrusive\_ptr<UniTensor\_base> clone()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{512       DenseUniTensor *tmp = this-\/>clone\_meta();}
\DoxyCodeLine{513       tmp-\/>\_block = this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_a5e2248e9babdb786167ed349df9084ae}{clone}}();}
\DoxyCodeLine{514       boost::intrusive\_ptr<UniTensor\_base> out(tmp);}
\DoxyCodeLine{515       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{516     \};}
\DoxyCodeLine{517     \textcolor{keywordtype}{bool} is\_contiguous()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_block.is\_contiguous(); \}}
\DoxyCodeLine{518     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} dtype()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_a4472af6f8e825a13440e832bf82fb627}{dtype}}(); \}}
\DoxyCodeLine{519     \textcolor{keywordtype}{int} device()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_ac6d3310eb4defbdacf662dcd81d8fe09}{device}}(); \}}
\DoxyCodeLine{520     std::string dtype\_str()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} Type.getname(this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_a4472af6f8e825a13440e832bf82fb627}{dtype}}()); \}}
\DoxyCodeLine{521     std::string device\_str()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} Device.getname(this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_ac6d3310eb4defbdacf662dcd81d8fe09}{device}}()); \}}
\DoxyCodeLine{532     boost::intrusive\_ptr<UniTensor\_base> permute(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&mapper,}
\DoxyCodeLine{533                                                  \textcolor{keyword}{const} cytnx\_int64 \&rowrank=-\/1, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label=\textcolor{keyword}{false});}
\DoxyCodeLine{534     boost::intrusive\_ptr<UniTensor\_base> permute(\textcolor{keyword}{const} std::vector<std::string> \&mapper,}
\DoxyCodeLine{535                                                  \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1);}
\DoxyCodeLine{536     \textcolor{comment}{//boost::intrusive\_ptr<UniTensor\_base> permute(const std::vector<cytnx\_int64> \&mapper,}}
\DoxyCodeLine{537     \textcolor{comment}{//                                             const cytnx\_int64 \&rowrank = -\/1);}}
\DoxyCodeLine{547 \textcolor{comment}{}    \textcolor{keywordtype}{void} permute\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank=-\/1,}
\DoxyCodeLine{548                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label=\textcolor{keyword}{false});}
\DoxyCodeLine{549     \textcolor{keywordtype}{void} permute\_(\textcolor{keyword}{const} std::vector<std::string> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1);}
\DoxyCodeLine{550     \textcolor{comment}{//void permute\_(const std::vector<cytnx\_int64> \&mapper, const cytnx\_int64 \&rowrank = -\/1);}}
\DoxyCodeLine{551     boost::intrusive\_ptr<UniTensor\_base> relabels(\textcolor{keyword}{const} std::vector<std::string> \&new\_labels);}
\DoxyCodeLine{560     boost::intrusive\_ptr<UniTensor\_base> relabels(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_labels);}
\DoxyCodeLine{571     boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} cytnx\_int64 \&inx,}
\DoxyCodeLine{572                                                  \textcolor{keyword}{const} cytnx\_int64 \&new\_label,}
\DoxyCodeLine{573                                                  \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{574     boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} std::string \&inx,}
\DoxyCodeLine{575                                                  \textcolor{keyword}{const} std::string \&new\_label);}
\DoxyCodeLine{576     boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} cytnx\_int64 \&inx,}
\DoxyCodeLine{577                                                  \textcolor{keyword}{const} std::string \&new\_label);}
\DoxyCodeLine{578     boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} cytnx\_int64 \&inx,}
\DoxyCodeLine{579                                                  \textcolor{keyword}{const} cytnx\_int64 \&new\_label);}
\DoxyCodeLine{580 }
\DoxyCodeLine{581     boost::intrusive\_ptr<UniTensor\_base> astype(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{582       DenseUniTensor *tmp = this-\/>clone\_meta();}
\DoxyCodeLine{583       tmp-\/>\_block = this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_a7b996d3281e7375b29a7cfe4273b299f}{astype}}(dtype);}
\DoxyCodeLine{584       boost::intrusive\_ptr<UniTensor\_base> out(tmp);}
\DoxyCodeLine{585       \textcolor{keywordflow}{return} tmp;}
\DoxyCodeLine{586     \}}
\DoxyCodeLine{587 }
\DoxyCodeLine{588     std::vector<Symmetry> syms()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{589       cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] dense unitensor does not have symmetry.\%s"{}},}
\DoxyCodeLine{590                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{591       \textcolor{keywordflow}{return} std::vector<Symmetry>();}
\DoxyCodeLine{592     \}}
\DoxyCodeLine{593 }
\DoxyCodeLine{594     boost::intrusive\_ptr<UniTensor\_base> contiguous\_() \{}
\DoxyCodeLine{595       this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_a3d4342299e6951dae13b6136b89f1d53}{contiguous\_}}();}
\DoxyCodeLine{596       \textcolor{keywordflow}{return} boost::intrusive\_ptr<UniTensor\_base>(\textcolor{keyword}{this});}
\DoxyCodeLine{597     \}}
\DoxyCodeLine{598     boost::intrusive\_ptr<UniTensor\_base> contiguous() \{}
\DoxyCodeLine{599       \textcolor{comment}{// if contiguous then return self!}}
\DoxyCodeLine{600       \textcolor{keywordflow}{if} (this-\/>is\_contiguous()) \{}
\DoxyCodeLine{601         boost::intrusive\_ptr<UniTensor\_base> out(\textcolor{keyword}{this});}
\DoxyCodeLine{602         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{603       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{604         DenseUniTensor *tmp = this-\/>clone\_meta();}
\DoxyCodeLine{605         tmp-\/>\_block = this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_a4d7da181303c588f2ab84bffda435525}{contiguous}}();}
\DoxyCodeLine{606         boost::intrusive\_ptr<UniTensor\_base> out(tmp);}
\DoxyCodeLine{607         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{608       \}}
\DoxyCodeLine{609     \}}
\DoxyCodeLine{610     \textcolor{keywordtype}{void} print\_diagram(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&bond\_info = \textcolor{keyword}{false});}
\DoxyCodeLine{611     \textcolor{keywordtype}{void} print\_blocks(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&full\_info=\textcolor{keyword}{true}) \textcolor{keyword}{const};}
\DoxyCodeLine{612     \textcolor{keywordtype}{void} print\_block(\textcolor{keyword}{const} cytnx\_int64 \&idx, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&full\_info=\textcolor{keyword}{true}) \textcolor{keyword}{const};}
\DoxyCodeLine{613     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} get\_block(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_a5e2248e9babdb786167ed349df9084ae}{clone}}(); \}}
\DoxyCodeLine{614 }
\DoxyCodeLine{615     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} get\_block(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{616       cytnx\_error\_msg(}
\DoxyCodeLine{617         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] try to get\_block() using qnum on a non-\/symmetry UniTensor\%s"{}},}
\DoxyCodeLine{618         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{619       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}}();}
\DoxyCodeLine{620     \}}
\DoxyCodeLine{621     \textcolor{comment}{// return a share view of block, this only work for non-\/symm tensor.}}
\DoxyCodeLine{622     \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{623       cytnx\_error\_msg(}
\DoxyCodeLine{624         \textcolor{keyword}{true},}
\DoxyCodeLine{625         \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] try to get\_block\_() using qnum on a non-\/symmetry UniTensor\%s"{}},}
\DoxyCodeLine{626         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{627       \textcolor{keywordflow}{return} this-\/>\_block;}
\DoxyCodeLine{628     \}}
\DoxyCodeLine{629     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force) \{}
\DoxyCodeLine{630       cytnx\_error\_msg(}
\DoxyCodeLine{631         \textcolor{keyword}{true},}
\DoxyCodeLine{632         \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] try to get\_block\_() using qnum on a non-\/symmetry UniTensor\%s"{}},}
\DoxyCodeLine{633         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{634       \textcolor{keywordflow}{return} this-\/>\_block;}
\DoxyCodeLine{635     \}}
\DoxyCodeLine{636 }
\DoxyCodeLine{637     \textcolor{comment}{// return a share view of block, this only work for non-\/symm tensor.}}
\DoxyCodeLine{638     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0) \{ \textcolor{keywordflow}{return} this-\/>\_block; \}}
\DoxyCodeLine{639     \textcolor{comment}{// return a share view of block, this only work for non-\/symm tensor.}}
\DoxyCodeLine{640     \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_block; \}}
\DoxyCodeLine{641 }
\DoxyCodeLine{642     cytnx\_uint64 Nblocks()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} 1; \};}
\DoxyCodeLine{643     std::vector<Tensor> get\_blocks()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{644       std::vector<Tensor> out;}
\DoxyCodeLine{645       cytnx\_error\_msg(}
\DoxyCodeLine{646         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] cannot use get\_blocks(), use get\_block() instead!\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{647       \textcolor{keywordflow}{return} out;  \textcolor{comment}{// this will not share memory!!}}
\DoxyCodeLine{648     \}}
\DoxyCodeLine{649     \textcolor{keyword}{const} std::vector<Tensor> \&get\_blocks\_(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&silent = \textcolor{keyword}{false})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{650       cytnx\_error\_msg(}
\DoxyCodeLine{651         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] cannot use get\_blocks\_(), use get\_block\_() instead!\%s"{}},}
\DoxyCodeLine{652         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{653       \textcolor{keywordflow}{return} this-\/>\_interface\_block;  \textcolor{comment}{// this will not share memory!!}}
\DoxyCodeLine{654     \}}
\DoxyCodeLine{655     std::vector<Tensor> \&get\_blocks\_(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&silent = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{656       cytnx\_error\_msg(}
\DoxyCodeLine{657         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] cannot use get\_blocks\_(), use get\_block\_() instead!\%s"{}},}
\DoxyCodeLine{658         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{659       \textcolor{keywordflow}{return} this-\/>\_interface\_block;  \textcolor{comment}{// this will not share memory!!}}
\DoxyCodeLine{660     \}}
\DoxyCodeLine{661 }
\DoxyCodeLine{662     \textcolor{keywordtype}{void} put\_block(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} cytnx\_uint64 \&idx = 0) \{}
\DoxyCodeLine{663       \textcolor{keywordflow}{if} (this-\/>is\_diag()) \{}
\DoxyCodeLine{664         cytnx\_error\_msg(}
\DoxyCodeLine{665           in.\mbox{\hyperlink{classcytnx_1_1Tensor_af36ef858677f13dcda8512fd9b5ae475}{shape}}() != this-\/>\_block.shape(),}
\DoxyCodeLine{666           \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] put\_block, the input tensor shape does not match.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{667         this-\/>\_block = in.\mbox{\hyperlink{classcytnx_1_1Tensor_a5e2248e9babdb786167ed349df9084ae}{clone}}();}
\DoxyCodeLine{668       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{669         cytnx\_error\_msg(}
\DoxyCodeLine{670           in.\mbox{\hyperlink{classcytnx_1_1Tensor_af36ef858677f13dcda8512fd9b5ae475}{shape}}() != this-\/>shape(),}
\DoxyCodeLine{671           \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] put\_block, the input tensor shape does not match.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{672         this-\/>\_block = in.\mbox{\hyperlink{classcytnx_1_1Tensor_a5e2248e9babdb786167ed349df9084ae}{clone}}();}
\DoxyCodeLine{673       \}}
\DoxyCodeLine{674     \}}
\DoxyCodeLine{675     \textcolor{comment}{// share view of the block}}
\DoxyCodeLine{676     \textcolor{keywordtype}{void} put\_block\_(\mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} cytnx\_uint64 \&idx = 0) \{}
\DoxyCodeLine{677       \textcolor{keywordflow}{if} (this-\/>is\_diag()) \{}
\DoxyCodeLine{678         cytnx\_error\_msg(}
\DoxyCodeLine{679           in.\mbox{\hyperlink{classcytnx_1_1Tensor_af36ef858677f13dcda8512fd9b5ae475}{shape}}() != this-\/>\_block.shape(),}
\DoxyCodeLine{680           \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] put\_block, the input tensor shape does not match.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{681         this-\/>\_block = in;}
\DoxyCodeLine{682       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{683         cytnx\_error\_msg(}
\DoxyCodeLine{684           in.\mbox{\hyperlink{classcytnx_1_1Tensor_af36ef858677f13dcda8512fd9b5ae475}{shape}}() != this-\/>shape(),}
\DoxyCodeLine{685           \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] put\_block, the input tensor shape does not match.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{686         this-\/>\_block = in;}
\DoxyCodeLine{687       \}}
\DoxyCodeLine{688     \}}
\DoxyCodeLine{689 }
\DoxyCodeLine{690     \textcolor{keywordtype}{void} put\_block(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force) \{}
\DoxyCodeLine{691       cytnx\_error\_msg(}
\DoxyCodeLine{692         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] try to put\_block using qnum on a non-\/symmetry UniTensor\%s"{}},}
\DoxyCodeLine{693         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{694     \}}
\DoxyCodeLine{695     \textcolor{keywordtype}{void} put\_block\_(\mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force) \{}
\DoxyCodeLine{696       cytnx\_error\_msg(}
\DoxyCodeLine{697         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] try to put\_block using qnum on a non-\/symmetry UniTensor\%s"{}},}
\DoxyCodeLine{698         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{699     \}}
\DoxyCodeLine{700     \textcolor{comment}{// this will only work on non-\/symm tensor (DenseUniTensor)}}
\DoxyCodeLine{701     boost::intrusive\_ptr<UniTensor\_base> get(\textcolor{keyword}{const} std::vector<Accessor> \&accessors) \{}
\DoxyCodeLine{702       boost::intrusive\_ptr<UniTensor\_base> out(\textcolor{keyword}{new} DenseUniTensor());}
\DoxyCodeLine{703       out-\/>Init\_by\_Tensor(this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_ad7b928e4cb89d40cbd99aefab9aa0075}{get}}(accessors), \textcolor{keyword}{false}, 0);  \textcolor{comment}{// wrapping around.}}
\DoxyCodeLine{704       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{705     \}}
\DoxyCodeLine{706     \textcolor{comment}{// this will only work on non-\/symm tensor (DenseUniTensor)}}
\DoxyCodeLine{707     \textcolor{keywordtype}{void} set(\textcolor{keyword}{const} std::vector<Accessor> \&accessors, \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&rhs) \{}
\DoxyCodeLine{708       this-\/>\_block.\mbox{\hyperlink{classcytnx_1_1Tensor_a771f1f5b51f89abd8df4166e602214ac}{set}}(accessors, rhs);}
\DoxyCodeLine{709     \}}
\DoxyCodeLine{710 }
\DoxyCodeLine{711     \textcolor{keywordtype}{void} reshape\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_shape, \textcolor{keyword}{const} cytnx\_uint64 \&rowrank = 0);}
\DoxyCodeLine{712     boost::intrusive\_ptr<UniTensor\_base> reshape(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_shape,}
\DoxyCodeLine{713                                                  \textcolor{keyword}{const} cytnx\_uint64 \&rowrank = 0);}
\DoxyCodeLine{714     boost::intrusive\_ptr<UniTensor\_base> to\_dense();}
\DoxyCodeLine{715     \textcolor{keywordtype}{void} to\_dense\_();}
\DoxyCodeLine{725     \textcolor{keywordtype}{void} combineBonds(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&indicators, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force,}
\DoxyCodeLine{726                       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{727     \textcolor{keywordtype}{void} combineBonds(\textcolor{keyword}{const} std::vector<std::string> \&indicators, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{true});}
\DoxyCodeLine{728     \textcolor{keywordtype}{void} combineBonds(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&indicators, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{true});}
\DoxyCodeLine{729     boost::intrusive\_ptr<UniTensor\_base> contract(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs,}
\DoxyCodeLine{730                                                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&mv\_elem\_self = \textcolor{keyword}{false},}
\DoxyCodeLine{731                                                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&mv\_elem\_rhs = \textcolor{keyword}{false});}
\DoxyCodeLine{732     std::vector<Bond> getTotalQnums(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&physical = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{733       cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] \%s"{}},}
\DoxyCodeLine{734                       \textcolor{stringliteral}{"{}getTotalQnums can only operate on UniTensor with symmetry.\(\backslash\)n"{}});}
\DoxyCodeLine{735       \textcolor{keywordflow}{return} std::vector<Bond>();}
\DoxyCodeLine{736     \}}
\DoxyCodeLine{737 }
\DoxyCodeLine{738     std::vector<std::vector<cytnx\_int64>> get\_blocks\_qnums()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{739       cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] \%s"{}},}
\DoxyCodeLine{740                       \textcolor{stringliteral}{"{}get\_blocks\_qnums can only operate on UniTensor with symmetry.\(\backslash\)n"{}});}
\DoxyCodeLine{741       \textcolor{keywordflow}{return} std::vector<std::vector<cytnx\_int64>>();}
\DoxyCodeLine{742     \}}
\DoxyCodeLine{743 }
\DoxyCodeLine{744     \textcolor{keywordtype}{bool} same\_data(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{745       \textcolor{keywordflow}{if} (rhs-\/>uten\_type() != UTenType.Dense) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{746 }
\DoxyCodeLine{747       \textcolor{keywordflow}{return} this-\/>get\_block\_().same\_data(rhs-\/>get\_block\_());}
\DoxyCodeLine{748     \}}
\DoxyCodeLine{749 }
\DoxyCodeLine{750     \string~DenseUniTensor()\{\};}
\DoxyCodeLine{751 }
\DoxyCodeLine{752     \textcolor{comment}{// arithmetic}}
\DoxyCodeLine{753     \textcolor{keywordtype}{void} Add\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{754     \textcolor{keywordtype}{void} Add\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{755 }
\DoxyCodeLine{756     \textcolor{keywordtype}{void} Mul\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{757     \textcolor{keywordtype}{void} Mul\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{758 }
\DoxyCodeLine{759     \textcolor{keywordtype}{void} Sub\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{760     \textcolor{keywordtype}{void} Sub\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{761     \textcolor{keywordtype}{void} lSub\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&lhs);}
\DoxyCodeLine{762 }
\DoxyCodeLine{763     \textcolor{keywordtype}{void} Div\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{764     \textcolor{keywordtype}{void} Div\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{765     \textcolor{keywordtype}{void} lDiv\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&lhs);}
\DoxyCodeLine{766 }
\DoxyCodeLine{767     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecytnx_1_1linalg_adc3233bf8bc3eb6a435340f912412801}{Conj\_}}() \{ this-\/>\_block.Conj\_(); \};}
\DoxyCodeLine{768 }
\DoxyCodeLine{769     boost::intrusive\_ptr<UniTensor\_base> \mbox{\hyperlink{namespacecytnx_1_1linalg_a470d0886432554a35ecaf961451c0806}{Conj}}() \{}
\DoxyCodeLine{770       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{771       out-\/>Conj\_();}
\DoxyCodeLine{772       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{773     \}}
\DoxyCodeLine{774 }
\DoxyCodeLine{775     boost::intrusive\_ptr<UniTensor\_base> Transpose() \{}
\DoxyCodeLine{776       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{777       out-\/>Transpose\_();}
\DoxyCodeLine{778       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{779     \}}
\DoxyCodeLine{780     \textcolor{keywordtype}{void} Transpose\_();}
\DoxyCodeLine{781 }
\DoxyCodeLine{782     boost::intrusive\_ptr<UniTensor\_base> Dagger() \{}
\DoxyCodeLine{783       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>\mbox{\hyperlink{namespacecytnx_1_1linalg_a470d0886432554a35ecaf961451c0806}{Conj}}();}
\DoxyCodeLine{784       out-\/>Transpose\_();}
\DoxyCodeLine{785       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{786     \}}
\DoxyCodeLine{787     \textcolor{keywordtype}{void} Dagger\_() \{}
\DoxyCodeLine{788       this-\/>\mbox{\hyperlink{namespacecytnx_1_1linalg_adc3233bf8bc3eb6a435340f912412801}{Conj\_}}();}
\DoxyCodeLine{789       this-\/>Transpose\_();}
\DoxyCodeLine{790     \}}
\DoxyCodeLine{800     \textcolor{keywordtype}{void} Trace\_(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{801     \textcolor{keywordtype}{void} Trace\_(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b);}
\DoxyCodeLine{802     \textcolor{keywordtype}{void} Trace\_(\textcolor{keyword}{const} std::string \&a, \textcolor{keyword}{const} std::string \&b);}
\DoxyCodeLine{803     boost::intrusive\_ptr<UniTensor\_base> Trace(\textcolor{keyword}{const} std::string \&a, \textcolor{keyword}{const} std::string \&b) \{}
\DoxyCodeLine{804       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{805       out-\/>Trace\_(a, b);}
\DoxyCodeLine{806       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{807     \}}
\DoxyCodeLine{808     boost::intrusive\_ptr<UniTensor\_base> Trace(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b) \{}
\DoxyCodeLine{809       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{810       out-\/>Trace\_(a, b);}
\DoxyCodeLine{811       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{812     \}}
\DoxyCodeLine{822     boost::intrusive\_ptr<UniTensor\_base> Trace(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b,}
\DoxyCodeLine{823                                                \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label) \{}
\DoxyCodeLine{824       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{825       out-\/>Trace\_(a, b, by\_label);}
\DoxyCodeLine{826       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{827     \}}
\DoxyCodeLine{828 }
\DoxyCodeLine{829     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \mbox{\hyperlink{namespacecytnx_1_1linalg_a9cd2be179860bb4742ebe320fa063680}{Norm}}() \textcolor{keyword}{const};}
\DoxyCodeLine{830 }
\DoxyCodeLine{831     \textcolor{keyword}{const} Scalar::Sproxy at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{832       cytnx\_error\_msg(}
\DoxyCodeLine{833         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{834         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{835       \textcolor{comment}{// return cytnx\_complex128(0,0);}}
\DoxyCodeLine{836     \}}
\DoxyCodeLine{837     \textcolor{keyword}{const} cytnx\_complex128 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{838                                           \textcolor{keyword}{const} cytnx\_complex128 \&aux)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{839       cytnx\_error\_msg(}
\DoxyCodeLine{840         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{841         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{842       \textcolor{comment}{// return cytnx\_complex128(0,0);}}
\DoxyCodeLine{843     \}}
\DoxyCodeLine{844     \textcolor{keyword}{const} cytnx\_complex64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{845                                          \textcolor{keyword}{const} cytnx\_complex64 \&aux)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{846       cytnx\_error\_msg(}
\DoxyCodeLine{847         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{848         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{849       \textcolor{comment}{// return cytnx\_complex64(0,0);}}
\DoxyCodeLine{850     \}}
\DoxyCodeLine{851     \textcolor{keyword}{const} cytnx\_double \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{852                                       \textcolor{keyword}{const} cytnx\_double \&aux)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{853       cytnx\_error\_msg(}
\DoxyCodeLine{854         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{855         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{856       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{857     \}}
\DoxyCodeLine{858     \textcolor{keyword}{const} cytnx\_float \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{859                                      \textcolor{keyword}{const} cytnx\_float \&aux)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{860       cytnx\_error\_msg(}
\DoxyCodeLine{861         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{862         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{863       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{864     \}}
\DoxyCodeLine{865     \textcolor{keyword}{const} cytnx\_uint64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{866                                       \textcolor{keyword}{const} cytnx\_uint64 \&aux)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{867       cytnx\_error\_msg(}
\DoxyCodeLine{868         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{869         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{870       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{871     \}}
\DoxyCodeLine{872     \textcolor{keyword}{const} cytnx\_int64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{873                                      \textcolor{keyword}{const} cytnx\_int64 \&aux)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{874       cytnx\_error\_msg(}
\DoxyCodeLine{875         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{876         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{877       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{878     \}}
\DoxyCodeLine{879     \textcolor{keyword}{const} cytnx\_uint32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{880                                       \textcolor{keyword}{const} cytnx\_uint32 \&aux)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{881       cytnx\_error\_msg(}
\DoxyCodeLine{882         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{883         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{884       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{885     \}}
\DoxyCodeLine{886     \textcolor{keyword}{const} cytnx\_int32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{887                                      \textcolor{keyword}{const} cytnx\_int32 \&aux)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{888       cytnx\_error\_msg(}
\DoxyCodeLine{889         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{890         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{891       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{892     \}}
\DoxyCodeLine{893     \textcolor{keyword}{const} cytnx\_uint16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{894                                       \textcolor{keyword}{const} cytnx\_uint16 \&aux)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{895       cytnx\_error\_msg(}
\DoxyCodeLine{896         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{897         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{898       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{899     \}}
\DoxyCodeLine{900     \textcolor{keyword}{const} cytnx\_int16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{901                                      \textcolor{keyword}{const} cytnx\_int16 \&aux)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{902       cytnx\_error\_msg(}
\DoxyCodeLine{903         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{904         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{905       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{906     \}}
\DoxyCodeLine{907 }
\DoxyCodeLine{908     Scalar::Sproxy at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator) \{}
\DoxyCodeLine{909       cytnx\_error\_msg(}
\DoxyCodeLine{910         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{911         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{912       \textcolor{comment}{// return cytnx\_complex128(0,0);}}
\DoxyCodeLine{913     \}}
\DoxyCodeLine{914     cytnx\_complex128 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{915                                     \textcolor{keyword}{const} cytnx\_complex128 \&aux) \{}
\DoxyCodeLine{916       cytnx\_error\_msg(}
\DoxyCodeLine{917         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{918         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{919       \textcolor{comment}{// return cytnx\_complex128(0,0);}}
\DoxyCodeLine{920     \}}
\DoxyCodeLine{921     cytnx\_complex64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{922                                    \textcolor{keyword}{const} cytnx\_complex64 \&aux) \{}
\DoxyCodeLine{923       cytnx\_error\_msg(}
\DoxyCodeLine{924         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{925         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{926       \textcolor{comment}{// return cytnx\_complex64(0,0);}}
\DoxyCodeLine{927     \}}
\DoxyCodeLine{928     cytnx\_double \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_double \&aux) \{}
\DoxyCodeLine{929       cytnx\_error\_msg(}
\DoxyCodeLine{930         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{931         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{932       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{933     \}}
\DoxyCodeLine{934     cytnx\_float \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_float \&aux) \{}
\DoxyCodeLine{935       cytnx\_error\_msg(}
\DoxyCodeLine{936         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{937         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{938       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{939     \}}
\DoxyCodeLine{940     cytnx\_uint64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_uint64 \&aux) \{}
\DoxyCodeLine{941       cytnx\_error\_msg(}
\DoxyCodeLine{942         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{943         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{944       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{945     \}}
\DoxyCodeLine{946     cytnx\_int64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_int64 \&aux) \{}
\DoxyCodeLine{947       cytnx\_error\_msg(}
\DoxyCodeLine{948         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{949         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{950       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{951     \}}
\DoxyCodeLine{952     cytnx\_uint32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_uint32 \&aux) \{}
\DoxyCodeLine{953       cytnx\_error\_msg(}
\DoxyCodeLine{954         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{955         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{956       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{957     \}}
\DoxyCodeLine{958     cytnx\_int32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_int32 \&aux) \{}
\DoxyCodeLine{959       cytnx\_error\_msg(}
\DoxyCodeLine{960         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{961         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{962       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{963     \}}
\DoxyCodeLine{964     cytnx\_uint16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_uint16 \&aux) \{}
\DoxyCodeLine{965       cytnx\_error\_msg(}
\DoxyCodeLine{966         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{967         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{968       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{969     \}}
\DoxyCodeLine{970     cytnx\_int16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_int16 \&aux) \{}
\DoxyCodeLine{971       cytnx\_error\_msg(}
\DoxyCodeLine{972         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][Internal] This shouldn't be called by DenseUniTensor, something wrong.\%s"{}},}
\DoxyCodeLine{973         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{974       \textcolor{comment}{// return 0;}}
\DoxyCodeLine{975     \}}
\DoxyCodeLine{976 }
\DoxyCodeLine{977     \textcolor{keywordtype}{bool} elem\_exists(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{978       cytnx\_error\_msg(}
\DoxyCodeLine{979         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][DenseUniTensor] elem\_exists can only be used on UniTensor with Symmetry.\%s"{}},}
\DoxyCodeLine{980         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{981     \}}
\DoxyCodeLine{982     \textcolor{keywordtype}{void} tag() \{}
\DoxyCodeLine{983       \textcolor{keywordflow}{if} (!this-\/>is\_tag()) \{}
\DoxyCodeLine{984         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < this-\/>\_rowrank; i++) \{}
\DoxyCodeLine{985           this-\/>\_bonds[i].set\_type(BD\_KET);}
\DoxyCodeLine{986         \}}
\DoxyCodeLine{987         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = this-\/>\_rowrank; i < this-\/>\_bonds.size(); i++) \{}
\DoxyCodeLine{988           this-\/>\_bonds[i].set\_type(BD\_BRA);}
\DoxyCodeLine{989         \}}
\DoxyCodeLine{990         this-\/>\_is\_tag = \textcolor{keyword}{true};}
\DoxyCodeLine{991         this-\/>\_is\_braket\_form = this-\/>\_update\_braket();}
\DoxyCodeLine{992       \}}
\DoxyCodeLine{993     \}}
\DoxyCodeLine{1003     \textcolor{keywordtype}{void} truncate\_(\textcolor{keyword}{const} cytnx\_int64 \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{1004     \textcolor{keywordtype}{void} truncate\_(\textcolor{keyword}{const} cytnx\_int64 \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim);}
\DoxyCodeLine{1005     \textcolor{keywordtype}{void} truncate\_(\textcolor{keyword}{const} std::string \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim);}
\DoxyCodeLine{1006 }
\DoxyCodeLine{1007     \textcolor{keywordtype}{void} group\_basis\_()\{}
\DoxyCodeLine{1008         cytnx\_warning\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[WARNING] group basis will not have any effect on DensUniTensor.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1009     \}}
\DoxyCodeLine{1010 }
\DoxyCodeLine{1011     \textcolor{keywordtype}{void} \_save\_dispatch(std::fstream \&f) \textcolor{keyword}{const};}
\DoxyCodeLine{1012     \textcolor{keywordtype}{void} \_load\_dispatch(std::fstream \&f);}
\DoxyCodeLine{1013 }
\DoxyCodeLine{1014     \textcolor{keyword}{const} std::vector<cytnx\_uint64>\& get\_qindices(\textcolor{keyword}{const} cytnx\_uint64 \&bidx)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{1015         cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR] get\_qindices can only be unsed on UniTensor with Symmetry.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1016         }
\DoxyCodeLine{1017     \}}
\DoxyCodeLine{1018     std::vector<cytnx\_uint64>\& get\_qindices(\textcolor{keyword}{const} cytnx\_uint64 \&bidx)\{}
\DoxyCodeLine{1019         cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR] get\_qindices can only be unsed on UniTensor with Symmetry.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1020     \}}
\DoxyCodeLine{1021 }
\DoxyCodeLine{1022     \textcolor{keyword}{const} vec2d<cytnx\_uint64> \& get\_itoi()\textcolor{keyword}{ const}\{}
\DoxyCodeLine{1023         cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR] get\_itoi can only be unsed on UniTensor with Symmetry.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1024     \}}
\DoxyCodeLine{1025     vec2d<cytnx\_uint64> \& get\_itoi()\{}
\DoxyCodeLine{1026         cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR] get\_itoi can only be unsed on UniTensor with Symmetry.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1027     \}}
\DoxyCodeLine{1028 }
\DoxyCodeLine{1029 }
\DoxyCodeLine{1030     \textcolor{comment}{// end virtual function}}
\DoxyCodeLine{1031   \};}
\DoxyCodeLine{1033 }
\DoxyCodeLine{1034   \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{1036 \textcolor{comment}{}  \textcolor{keyword}{class }SparseUniTensor : \textcolor{keyword}{public} UniTensor\_base \{}
\DoxyCodeLine{1037    \textcolor{keyword}{protected}:}
\DoxyCodeLine{1038    \textcolor{keyword}{public}:}
\DoxyCodeLine{1039     cytnx\_uint64 \_inner\_rowrank;}
\DoxyCodeLine{1040     std::vector<std::vector<cytnx\_int64>> \_blockqnums;}
\DoxyCodeLine{1041     std::vector<cytnx\_uint64> \_mapper;}
\DoxyCodeLine{1042     std::vector<cytnx\_uint64> \_inv\_mapper;}
\DoxyCodeLine{1043     std::vector<std::vector<cytnx\_uint64>> \_inner2outer\_row;}
\DoxyCodeLine{1044     std::vector<std::vector<cytnx\_uint64>> \_inner2outer\_col;}
\DoxyCodeLine{1045     std::map<cytnx\_uint64, std::pair<cytnx\_uint64, cytnx\_uint64>> \_outer2inner\_row;}
\DoxyCodeLine{1046     std::map<cytnx\_uint64, std::pair<cytnx\_uint64, cytnx\_uint64>> \_outer2inner\_col;}
\DoxyCodeLine{1047 }
\DoxyCodeLine{1048     std::vector<Tensor> \_blocks;}
\DoxyCodeLine{1049 }
\DoxyCodeLine{1050     \textcolor{keywordtype}{bool} \_contiguous;}
\DoxyCodeLine{1051     \textcolor{keywordtype}{void} set\_meta(SparseUniTensor *tmp, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&inner, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&outer)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1052       \textcolor{comment}{// outer meta}}
\DoxyCodeLine{1053       \textcolor{keywordflow}{if} (outer) \{}
\DoxyCodeLine{1054         tmp-\/>\_bonds = vec\_clone(this-\/>\_bonds);}
\DoxyCodeLine{1055         tmp-\/>\_labels = this-\/>\_labels;}
\DoxyCodeLine{1056         tmp-\/>\_is\_braket\_form = this-\/>\_is\_braket\_form;}
\DoxyCodeLine{1057         tmp-\/>\_rowrank = this-\/>\_rowrank;}
\DoxyCodeLine{1058         tmp-\/>\_name = this-\/>\_name;}
\DoxyCodeLine{1059       \}}
\DoxyCodeLine{1060       \textcolor{comment}{// comm meta}}
\DoxyCodeLine{1061       tmp-\/>\_mapper = this-\/>\_mapper;}
\DoxyCodeLine{1062       tmp-\/>\_inv\_mapper = this-\/>\_inv\_mapper;}
\DoxyCodeLine{1063       tmp-\/>\_contiguous = this-\/>\_contiguous;}
\DoxyCodeLine{1064       tmp-\/>\_is\_diag = this-\/>\_is\_diag;}
\DoxyCodeLine{1065 }
\DoxyCodeLine{1066       \textcolor{comment}{// inner meta}}
\DoxyCodeLine{1067       \textcolor{keywordflow}{if} (inner) \{}
\DoxyCodeLine{1068         tmp-\/>\_inner\_rowrank = this-\/>\_inner\_rowrank;}
\DoxyCodeLine{1069         tmp-\/>\_inner2outer\_row = this-\/>\_inner2outer\_row;}
\DoxyCodeLine{1070         tmp-\/>\_inner2outer\_col = this-\/>\_inner2outer\_col;}
\DoxyCodeLine{1071         tmp-\/>\_outer2inner\_row = this-\/>\_outer2inner\_row;}
\DoxyCodeLine{1072         tmp-\/>\_outer2inner\_col = this-\/>\_outer2inner\_col;}
\DoxyCodeLine{1073         tmp-\/>\_blockqnums = this-\/>\_blockqnums;}
\DoxyCodeLine{1074       \}}
\DoxyCodeLine{1075     \}}
\DoxyCodeLine{1076     SparseUniTensor *clone\_meta(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&inner, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&outer)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1077       SparseUniTensor *tmp = \textcolor{keyword}{new} SparseUniTensor();}
\DoxyCodeLine{1078       this-\/>set\_meta(tmp, inner, outer);}
\DoxyCodeLine{1079       \textcolor{keywordflow}{return} tmp;}
\DoxyCodeLine{1080     \};}
\DoxyCodeLine{1081 }
\DoxyCodeLine{1082     \textcolor{comment}{//===================================}}
\DoxyCodeLine{1083     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}};  \textcolor{comment}{// allow wrapper to access the private elems}}
\DoxyCodeLine{1084     SparseUniTensor() \{}
\DoxyCodeLine{1085       this-\/>uten\_type\_id = UTenType.Sparse;}
\DoxyCodeLine{1086       this-\/>\_is\_tag = \textcolor{keyword}{true};}
\DoxyCodeLine{1087     \};}
\DoxyCodeLine{1088 }
\DoxyCodeLine{1089     \textcolor{comment}{// virtual functions}}
\DoxyCodeLine{1090     \textcolor{comment}{//void Init(const std::vector<Bond> \&bonds, const std::vector<cytnx\_int64> \&in\_labels = \{\},}}
\DoxyCodeLine{1091     \textcolor{comment}{//          const cytnx\_int64 \&rowrank = -\/1, const unsigned int \&dtype = Type.Double,}}
\DoxyCodeLine{1092     \textcolor{comment}{//          const int \&device = Device.cpu, const bool \&is\_diag = false,}}
\DoxyCodeLine{1093     \textcolor{comment}{//          const bool \&no\_alloc = false);}}
\DoxyCodeLine{1094     \textcolor{keywordtype}{void} Init(\textcolor{keyword}{const} std::vector<Bond> \&bonds, \textcolor{keyword}{const} std::vector<std::string> \&in\_labels = \{\},}
\DoxyCodeLine{1095               \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype = Type.Double,}
\DoxyCodeLine{1096               \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device = Device.cpu, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false},}
\DoxyCodeLine{1097               \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&no\_alloc = \textcolor{keyword}{false});}
\DoxyCodeLine{1098 }
\DoxyCodeLine{1099     \textcolor{keywordtype}{void} Shadow\_Init(\textcolor{keyword}{const} std::vector<Bond> \&bonds,  \textcolor{keyword}{const} std::vector<std::vector<cytnx\_int64>> \&\_block\_qnums,}
\DoxyCodeLine{1100                \textcolor{keyword}{const} std::vector<std::string> \&in\_labels = \{\},}
\DoxyCodeLine{1101               \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype = Type.Double,}
\DoxyCodeLine{1102               \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device = Device.cpu, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false},}
\DoxyCodeLine{1103               \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&no\_alloc = \textcolor{keyword}{false});}
\DoxyCodeLine{1104 }
\DoxyCodeLine{1105     \textcolor{keywordtype}{void} Init\_by\_Tensor(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in\_tensor, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false},}
\DoxyCodeLine{1106                         \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1) \{}
\DoxyCodeLine{1107       cytnx\_error\_msg(}
\DoxyCodeLine{1108         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] cannot use Init\_by\_tensor() on a SparseUniTensor.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1109     \}}
\DoxyCodeLine{1110     std::vector<cytnx\_uint64> shape()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1111       std::vector<cytnx\_uint64> out(this-\/>\_bonds.size());}
\DoxyCodeLine{1112       \textcolor{keywordflow}{for} (cytnx\_uint64 i = 0; i < out.size(); i++) \{}
\DoxyCodeLine{1113         out[i] = this-\/>\_bonds[i].dim();}
\DoxyCodeLine{1114       \}}
\DoxyCodeLine{1115       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1116     \}}
\DoxyCodeLine{1117     \textcolor{keywordtype}{bool} is\_blockform()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \textcolor{keyword}{true}; \}}
\DoxyCodeLine{1118     \textcolor{keywordtype}{void} to\_(\textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device) \{}
\DoxyCodeLine{1119       \textcolor{keywordflow}{for} (cytnx\_uint64 i = 0; i < this-\/>\_blocks.size(); i++) \{}
\DoxyCodeLine{1120         this-\/>\_blocks[i].to\_(device);}
\DoxyCodeLine{1121       \}}
\DoxyCodeLine{1122     \};}
\DoxyCodeLine{1123     boost::intrusive\_ptr<UniTensor\_base> to(\textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device) \{}
\DoxyCodeLine{1124       \textcolor{keywordflow}{if} (this-\/>device() == device) \{}
\DoxyCodeLine{1125         \textcolor{keywordflow}{return} \textcolor{keyword}{this};}
\DoxyCodeLine{1126       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1127         boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{1128         out-\/>to\_(device);}
\DoxyCodeLine{1129         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1130       \}}
\DoxyCodeLine{1131     \};}
\DoxyCodeLine{1132     boost::intrusive\_ptr<UniTensor\_base> clone()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1133       SparseUniTensor *tmp = this-\/>clone\_meta(\textcolor{keyword}{true}, \textcolor{keyword}{true});}
\DoxyCodeLine{1134       tmp-\/>\_blocks = vec\_clone(this-\/>\_blocks);}
\DoxyCodeLine{1135       boost::intrusive\_ptr<UniTensor\_base> out(tmp);}
\DoxyCodeLine{1136       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1137     \};}
\DoxyCodeLine{1138 }
\DoxyCodeLine{1139     \textcolor{keywordtype}{bool} is\_contiguous()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_contiguous; \};}
\DoxyCodeLine{1140     \textcolor{keywordtype}{void} set\_rowrank(\textcolor{keyword}{const} cytnx\_uint64 \&new\_rowrank) \{}
\DoxyCodeLine{1141       cytnx\_error\_msg((new\_rowrank < 1) || (new\_rowrank >= this-\/>rank()),}
\DoxyCodeLine{1142                       \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] rowrank should be [>=1] and [<UniTensor.rank].\%s"{}},}
\DoxyCodeLine{1143                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1144       cytnx\_error\_msg(new\_rowrank >= this-\/>\_labels.size(),}
\DoxyCodeLine{1145                       \textcolor{stringliteral}{"{}[ERROR] rowrank cannot exceed the rank of UniTensor.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1146       \textcolor{keywordflow}{if} (this-\/>\_inner\_rowrank != new\_rowrank) this-\/>\_contiguous = \textcolor{keyword}{false};}
\DoxyCodeLine{1147 }
\DoxyCodeLine{1148       this-\/>\_rowrank = new\_rowrank;}
\DoxyCodeLine{1149       this-\/>\_is\_braket\_form = this-\/>\_update\_braket();}
\DoxyCodeLine{1150     \}}
\DoxyCodeLine{1159     boost::intrusive\_ptr<UniTensor\_base> relabels(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_labels);}
\DoxyCodeLine{1160     boost::intrusive\_ptr<UniTensor\_base> relabels(\textcolor{keyword}{const} std::vector<std::string> \&new\_labels);}
\DoxyCodeLine{1171     boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} cytnx\_int64 \&inx,}
\DoxyCodeLine{1172                                                  \textcolor{keyword}{const} cytnx\_int64 \&new\_label,}
\DoxyCodeLine{1173                                                  \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{1174     boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} cytnx\_int64 \&inx,}
\DoxyCodeLine{1175                                                  \textcolor{keyword}{const} cytnx\_int64 \&new\_label);}
\DoxyCodeLine{1176     boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} cytnx\_int64 \&inx,}
\DoxyCodeLine{1177                                                  \textcolor{keyword}{const} std::string \&new\_label);}
\DoxyCodeLine{1178     boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} std::string \&inx,}
\DoxyCodeLine{1179                                                  \textcolor{keyword}{const} std::string \&new\_label);}
\DoxyCodeLine{1180     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} dtype()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1181 \textcolor{preprocessor}{\#ifdef UNI\_DEBUG}}
\DoxyCodeLine{1182       cytnx\_error\_msg(this-\/>\_blocks.size() == 0, \textcolor{stringliteral}{"{}[ERROR][internal] empty blocks for blockform.\%s"{}},}
\DoxyCodeLine{1183                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1184 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1185       \textcolor{keywordflow}{return} this-\/>\_blocks[0].dtype();}
\DoxyCodeLine{1186     \};}
\DoxyCodeLine{1187     \textcolor{keywordtype}{int} device()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1188 \textcolor{preprocessor}{\#ifdef UNI\_DEBUG}}
\DoxyCodeLine{1189       cytnx\_error\_msg(this-\/>\_blocks.size() == 0, \textcolor{stringliteral}{"{}[ERROR][internal] empty blocks for blockform.\%s"{}},}
\DoxyCodeLine{1190                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1191 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1192       \textcolor{keywordflow}{return} this-\/>\_blocks[0].device();}
\DoxyCodeLine{1193     \};}
\DoxyCodeLine{1194     std::string dtype\_str()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1195 \textcolor{preprocessor}{\#ifdef UNI\_DEBUG}}
\DoxyCodeLine{1196       cytnx\_error\_msg(this-\/>\_blocks.size() == 0, \textcolor{stringliteral}{"{}[ERROR][internal] empty blocks for blockform.\%s"{}},}
\DoxyCodeLine{1197                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1198 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1199       \textcolor{keywordflow}{return} this-\/>\_blocks[0].dtype\_str();}
\DoxyCodeLine{1200     \};}
\DoxyCodeLine{1201     std::string device\_str()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1202 \textcolor{preprocessor}{\#ifdef UNI\_DEBUG}}
\DoxyCodeLine{1203       cytnx\_error\_msg(this-\/>\_blocks.size() == 0, \textcolor{stringliteral}{"{}[ERROR][internal] empty blocks for blockform.\%s"{}},}
\DoxyCodeLine{1204                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1205 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1206       \textcolor{keywordflow}{return} this-\/>\_blocks[0].device\_str();}
\DoxyCodeLine{1207     \};}
\DoxyCodeLine{1208 }
\DoxyCodeLine{1209     boost::intrusive\_ptr<UniTensor\_base> astype(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1210       SparseUniTensor *tmp = this-\/>clone\_meta(\textcolor{keyword}{true}, \textcolor{keyword}{true});}
\DoxyCodeLine{1211       tmp-\/>\_blocks.resize(this-\/>\_blocks.size());}
\DoxyCodeLine{1212       \textcolor{keywordflow}{for} (cytnx\_int64 blk = 0; blk < this-\/>\_blocks.size(); blk++) \{}
\DoxyCodeLine{1213         tmp-\/>\_blocks[blk] = this-\/>\_blocks[blk].astype(dtype);}
\DoxyCodeLine{1214       \}}
\DoxyCodeLine{1215       boost::intrusive\_ptr<UniTensor\_base> out(tmp);}
\DoxyCodeLine{1216       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1217     \};}
\DoxyCodeLine{1218 }
\DoxyCodeLine{1228     \textcolor{keywordtype}{void} permute\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank=-\/1,}
\DoxyCodeLine{1229                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label=\textcolor{keyword}{false});}
\DoxyCodeLine{1230     \textcolor{comment}{//void permute\_(const std::vector<cytnx\_int64> \&mapper, const cytnx\_int64 \&rowrank = -\/1);}}
\DoxyCodeLine{1231     \textcolor{keywordtype}{void} permute\_(\textcolor{keyword}{const} std::vector<std::string> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1);}
\DoxyCodeLine{1242     boost::intrusive\_ptr<UniTensor\_base> permute(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&mapper,}
\DoxyCodeLine{1243                                                  \textcolor{keyword}{const} cytnx\_int64 \&rowrank=-\/1, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label=\textcolor{keyword}{false});}
\DoxyCodeLine{1244     \textcolor{comment}{//boost::intrusive\_ptr<UniTensor\_base> permute(const std::vector<cytnx\_int64> \&mapper,}}
\DoxyCodeLine{1245     \textcolor{comment}{//                                             const cytnx\_int64 \&rowrank = -\/1);}}
\DoxyCodeLine{1246     boost::intrusive\_ptr<UniTensor\_base> permute(\textcolor{keyword}{const} std::vector<std::string> \&mapper,}
\DoxyCodeLine{1247                                                  \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1);}
\DoxyCodeLine{1248     boost::intrusive\_ptr<UniTensor\_base> contiguous();}
\DoxyCodeLine{1249     boost::intrusive\_ptr<UniTensor\_base> contiguous\_() \{}
\DoxyCodeLine{1250       \textcolor{keywordflow}{if} (!this-\/>\_contiguous) \{}
\DoxyCodeLine{1251         boost::intrusive\_ptr<UniTensor\_base> titr = this-\/>contiguous();}
\DoxyCodeLine{1252         SparseUniTensor *tmp = (SparseUniTensor *)titr.get();}
\DoxyCodeLine{1253         tmp-\/>set\_meta(\textcolor{keyword}{this}, \textcolor{keyword}{true}, \textcolor{keyword}{true});}
\DoxyCodeLine{1254         this-\/>\_blocks = tmp-\/>\_blocks;}
\DoxyCodeLine{1255       \}}
\DoxyCodeLine{1256       \textcolor{keywordflow}{return} boost::intrusive\_ptr<UniTensor\_base>(\textcolor{keyword}{this});}
\DoxyCodeLine{1257     \}}
\DoxyCodeLine{1258     \textcolor{keywordtype}{void} print\_diagram(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&bond\_info = \textcolor{keyword}{false});}
\DoxyCodeLine{1259     \textcolor{keywordtype}{void} print\_blocks(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&full\_info=\textcolor{keyword}{true})\textcolor{keyword}{const};}
\DoxyCodeLine{1260     \textcolor{keywordtype}{void} print\_block(\textcolor{keyword}{const} cytnx\_int64 \&idx, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&full\_info=\textcolor{keyword}{true}) \textcolor{keyword}{const};}
\DoxyCodeLine{1261     std::vector<Symmetry> syms() \textcolor{keyword}{const};}
\DoxyCodeLine{1262 }
\DoxyCodeLine{1263     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} get\_block(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1264       cytnx\_error\_msg(idx >= this-\/>\_blocks.size(), \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] index out of range\%s"{}},}
\DoxyCodeLine{1265                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1266       \textcolor{keywordflow}{if} (this-\/>\_contiguous) \{}
\DoxyCodeLine{1267         \textcolor{keywordflow}{return} this-\/>\_blocks[idx].clone();}
\DoxyCodeLine{1268       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1269         cytnx\_error\_msg(\textcolor{keyword}{true},}
\DoxyCodeLine{1270                         \textcolor{stringliteral}{"{}[Developing] get block from a non-\/contiguous SparseUniTensor is currently "{}}}
\DoxyCodeLine{1271                         \textcolor{stringliteral}{"{}not support. Call contiguous()/contiguous\_() first.\%s"{}},}
\DoxyCodeLine{1272                         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1273         \textcolor{keywordflow}{return} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}}();}
\DoxyCodeLine{1274       \}}
\DoxyCodeLine{1275     \};}
\DoxyCodeLine{1276     cytnx\_uint64 Nblocks()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_blocks.size(); \};}
\DoxyCodeLine{1277     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} get\_block(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1278       \textcolor{keywordflow}{if} (!force)}
\DoxyCodeLine{1279         cytnx\_error\_msg(}
\DoxyCodeLine{1280           !this-\/>is\_braket\_form(),}
\DoxyCodeLine{1281           \textcolor{stringliteral}{"{}[ERROR][Un-\/physical] cannot get the block by qnums when bra-\/ket/in-\/out bonds mismatch "{}}}
\DoxyCodeLine{1282           \textcolor{stringliteral}{"{}the row/col space.\(\backslash\)n permute to the correct physical space first, then get block.\%s"{}},}
\DoxyCodeLine{1283           \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1284       \textcolor{comment}{// std::cout << "{}get\_block"{} <<std::endl;}}
\DoxyCodeLine{1285       \textcolor{keywordflow}{if} (this-\/>\_contiguous) \{}
\DoxyCodeLine{1286         \textcolor{comment}{// std::cout << "{}contiguous"{} << std::endl;}}
\DoxyCodeLine{1287         \textcolor{comment}{// get dtype from qnum:}}
\DoxyCodeLine{1288         cytnx\_int64 idx = -\/1;}
\DoxyCodeLine{1289         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < this-\/>\_blockqnums.size(); i++) \{}
\DoxyCodeLine{1290           \textcolor{comment}{// for(int j=0;j<this-\/>\_blockqnums[i].size();j++)}}
\DoxyCodeLine{1291           \textcolor{comment}{//     std::cout << this-\/>\_blockqnums[i][j]<< "{} "{};}}
\DoxyCodeLine{1292           \textcolor{comment}{// std::cout << std::endl;}}
\DoxyCodeLine{1293           \textcolor{keywordflow}{if} (qnum == this-\/>\_blockqnums[i]) \{}
\DoxyCodeLine{1294             idx = i;}
\DoxyCodeLine{1295             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1296           \}}
\DoxyCodeLine{1297         \}}
\DoxyCodeLine{1298         cytnx\_error\_msg(}
\DoxyCodeLine{1299           idx < 0,}
\DoxyCodeLine{1300           \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] no block with [qnum] exists in the current UniTensor.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1301         \textcolor{keywordflow}{return} this-\/>get\_block(idx);}
\DoxyCodeLine{1302       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1303         cytnx\_error\_msg(\textcolor{keyword}{true},}
\DoxyCodeLine{1304                         \textcolor{stringliteral}{"{}[Developing] get block from a non-\/contiguous SparseUniTensor is currently "{}}}
\DoxyCodeLine{1305                         \textcolor{stringliteral}{"{}not support. Call contiguous()/contiguous\_() first.\%s"{}},}
\DoxyCodeLine{1306                         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1307         \textcolor{keywordflow}{return} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}}();}
\DoxyCodeLine{1308       \}}
\DoxyCodeLine{1309       \textcolor{keywordflow}{return} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}}();}
\DoxyCodeLine{1310     \};}
\DoxyCodeLine{1311 }
\DoxyCodeLine{1312     \textcolor{comment}{// return a share view of block, this only work for symm tensor in contiguous form.}}
\DoxyCodeLine{1313     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0) \{}
\DoxyCodeLine{1314       cytnx\_error\_msg(}
\DoxyCodeLine{1315         this-\/>is\_contiguous() == \textcolor{keyword}{false},}
\DoxyCodeLine{1316         \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] cannot use get\_block\_() on non-\/contiguous UniTensor with "{}}}
\DoxyCodeLine{1317         \textcolor{stringliteral}{"{}symmetry.\(\backslash\)n suggest options: \(\backslash\)n  1) Call contiguous\_()/contiguous() first, then call "{}}}
\DoxyCodeLine{1318         \textcolor{stringliteral}{"{}get\_block\_()\(\backslash\)n  2) Try get\_block()/get\_blocks()\%s"{}},}
\DoxyCodeLine{1319         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1320 }
\DoxyCodeLine{1321       cytnx\_error\_msg(idx >= this-\/>\_blocks.size(),}
\DoxyCodeLine{1322                       \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] index exceed the number of blocks.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1323 }
\DoxyCodeLine{1324       \textcolor{keywordflow}{return} this-\/>\_blocks[idx];}
\DoxyCodeLine{1325     \}}
\DoxyCodeLine{1326     \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1327       cytnx\_error\_msg(}
\DoxyCodeLine{1328         this-\/>is\_contiguous() == \textcolor{keyword}{false},}
\DoxyCodeLine{1329         \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] cannot use get\_block\_() on non-\/contiguous UniTensor with "{}}}
\DoxyCodeLine{1330         \textcolor{stringliteral}{"{}symmetry.\(\backslash\)n suggest options: \(\backslash\)n  1) Call contiguous\_()/contiguous() first, then call "{}}}
\DoxyCodeLine{1331         \textcolor{stringliteral}{"{}get\_block\_()\(\backslash\)n  2) Try get\_block()/get\_blocks()\%s"{}},}
\DoxyCodeLine{1332         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1333 }
\DoxyCodeLine{1334       cytnx\_error\_msg(idx >= this-\/>\_blocks.size(),}
\DoxyCodeLine{1335                       \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] index exceed the number of blocks.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1336 }
\DoxyCodeLine{1337       \textcolor{keywordflow}{return} this-\/>\_blocks[idx];}
\DoxyCodeLine{1338     \}}
\DoxyCodeLine{1339 }
\DoxyCodeLine{1340     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force) \{}
\DoxyCodeLine{1341       \textcolor{keywordflow}{if} (!force)}
\DoxyCodeLine{1342         cytnx\_error\_msg(}
\DoxyCodeLine{1343           !this-\/>is\_braket\_form(),}
\DoxyCodeLine{1344           \textcolor{stringliteral}{"{}[ERROR][Un-\/physical] cannot get the block by qnums when bra-\/ket/in-\/out bonds mismatch "{}}}
\DoxyCodeLine{1345           \textcolor{stringliteral}{"{}the row/col space.\(\backslash\)n permute to the correct physical space first, then get block.\%s"{}},}
\DoxyCodeLine{1346           \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1347 }
\DoxyCodeLine{1348       cytnx\_error\_msg(}
\DoxyCodeLine{1349         this-\/>is\_contiguous() == \textcolor{keyword}{false},}
\DoxyCodeLine{1350         \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] cannot use get\_block\_() on non-\/contiguous UniTensor with "{}}}
\DoxyCodeLine{1351         \textcolor{stringliteral}{"{}symmetry.\(\backslash\)n suggest options: \(\backslash\)n  1) Call contiguous\_()/contiguous() first, then call "{}}}
\DoxyCodeLine{1352         \textcolor{stringliteral}{"{}get\_blocks\_()\(\backslash\)n  2) Try get\_block()/get\_blocks()\%s"{}},}
\DoxyCodeLine{1353         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1354 }
\DoxyCodeLine{1355       \textcolor{comment}{// get dtype from qnum:}}
\DoxyCodeLine{1356       cytnx\_int64 idx = -\/1;}
\DoxyCodeLine{1357       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < this-\/>\_blockqnums.size(); i++) \{}
\DoxyCodeLine{1358         \textcolor{keywordflow}{if} (qnum == this-\/>\_blockqnums[i]) \{}
\DoxyCodeLine{1359           idx = i;}
\DoxyCodeLine{1360           \textcolor{keywordflow}{break};}
\DoxyCodeLine{1361         \}}
\DoxyCodeLine{1362       \}}
\DoxyCodeLine{1363       cytnx\_error\_msg(}
\DoxyCodeLine{1364         idx < 0, \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] no block with [qnum] exists in the current UniTensor.\%s"{}},}
\DoxyCodeLine{1365         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1366       \textcolor{keywordflow}{return} this-\/>get\_block\_(idx);}
\DoxyCodeLine{1367       \textcolor{comment}{// cytnx\_error\_msg(true,"{}[Developing]\%s"{},"{}\(\backslash\)n"{});}}
\DoxyCodeLine{1368     \}}
\DoxyCodeLine{1369     \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1370       \textcolor{keywordflow}{if} (!force)}
\DoxyCodeLine{1371         cytnx\_error\_msg(}
\DoxyCodeLine{1372           !this-\/>is\_braket\_form(),}
\DoxyCodeLine{1373           \textcolor{stringliteral}{"{}[ERROR][Un-\/physical] cannot get the block by qnums when bra-\/ket/in-\/out bonds mismatch "{}}}
\DoxyCodeLine{1374           \textcolor{stringliteral}{"{}the row/col space.\(\backslash\)n permute to the correct physical space first, then get block.\%s"{}},}
\DoxyCodeLine{1375           \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1376 }
\DoxyCodeLine{1377       cytnx\_error\_msg(}
\DoxyCodeLine{1378         this-\/>is\_contiguous() == \textcolor{keyword}{false},}
\DoxyCodeLine{1379         \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] cannot use get\_block\_() on non-\/contiguous UniTensor with "{}}}
\DoxyCodeLine{1380         \textcolor{stringliteral}{"{}symmetry.\(\backslash\)n suggest options: \(\backslash\)n  1) Call contiguous\_()/contiguous() first, then call "{}}}
\DoxyCodeLine{1381         \textcolor{stringliteral}{"{}get\_blocks\_()\(\backslash\)n  2) Try get\_block()/get\_blocks()\%s"{}},}
\DoxyCodeLine{1382         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1383 }
\DoxyCodeLine{1384       \textcolor{comment}{// get dtype from qnum:}}
\DoxyCodeLine{1385       cytnx\_int64 idx = -\/1;}
\DoxyCodeLine{1386       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < this-\/>\_blockqnums.size(); i++) \{}
\DoxyCodeLine{1387         \textcolor{keywordflow}{if} (qnum == this-\/>\_blockqnums[i]) \{}
\DoxyCodeLine{1388           idx = i;}
\DoxyCodeLine{1389           \textcolor{keywordflow}{break};}
\DoxyCodeLine{1390         \}}
\DoxyCodeLine{1391       \}}
\DoxyCodeLine{1392       cytnx\_error\_msg(}
\DoxyCodeLine{1393         idx < 0, \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] no block with [qnum] exists in the current UniTensor.\%s"{}},}
\DoxyCodeLine{1394         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1395       \textcolor{keywordflow}{return} this-\/>get\_block\_(idx);}
\DoxyCodeLine{1396     \}}
\DoxyCodeLine{1397 }
\DoxyCodeLine{1398     std::vector<Tensor> get\_blocks()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1399       \textcolor{keywordflow}{if} (this-\/>\_contiguous) \{}
\DoxyCodeLine{1400         \textcolor{keywordflow}{return} vec\_clone(this-\/>\_blocks);}
\DoxyCodeLine{1401       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1402         \textcolor{comment}{// cytnx\_error\_msg(true,"{}[Developing]\%s"{},"{}\(\backslash\)n"{});}}
\DoxyCodeLine{1403         boost::intrusive\_ptr<UniTensor\_base> tmp = this-\/>clone();}
\DoxyCodeLine{1404         tmp-\/>contiguous\_();}
\DoxyCodeLine{1405         SparseUniTensor *ttmp = (SparseUniTensor *)tmp.get();}
\DoxyCodeLine{1406         \textcolor{keywordflow}{return} ttmp-\/>\_blocks;}
\DoxyCodeLine{1407       \}}
\DoxyCodeLine{1408     \};}
\DoxyCodeLine{1409 }
\DoxyCodeLine{1410     \textcolor{keyword}{const} std::vector<Tensor> \&get\_blocks\_(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&silent = \textcolor{keyword}{false})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1411       \textcolor{comment}{// cout << "{}[call this]"{} << endl;}}
\DoxyCodeLine{1412       \textcolor{keywordflow}{if} (this-\/>\_contiguous) \{}
\DoxyCodeLine{1413         \textcolor{keywordflow}{return} this-\/>\_blocks;}
\DoxyCodeLine{1414       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1415         \textcolor{comment}{// cytnx\_error\_msg(true,"{}[Developing]\%s"{},"{}\(\backslash\)n"{});}}
\DoxyCodeLine{1416         \textcolor{keywordflow}{if} (!silent)}
\DoxyCodeLine{1417           cytnx\_warning\_msg(}
\DoxyCodeLine{1418             \textcolor{keyword}{true},}
\DoxyCodeLine{1419             \textcolor{stringliteral}{"{}[WARNING][SparseUniTensor] call get\_blocks\_() with a non-\/contiguous UniTensor should "{}}}
\DoxyCodeLine{1420             \textcolor{stringliteral}{"{}be used with caution. \(\backslash\)ntry: \(\backslash\)n1) get\_blocks()\(\backslash\)n2) call contiguous/contiguous\_() "{}}}
\DoxyCodeLine{1421             \textcolor{stringliteral}{"{}first, then get\_blocks\_() to get concise results\%s"{}},}
\DoxyCodeLine{1422             \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1423 }
\DoxyCodeLine{1424         \textcolor{keywordflow}{return} this-\/>\_blocks;}
\DoxyCodeLine{1425       \}}
\DoxyCodeLine{1426     \};}
\DoxyCodeLine{1427     std::vector<Tensor> \&get\_blocks\_(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&silent = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{1428       \textcolor{comment}{// cout << "{}[call this]"{} << endl;}}
\DoxyCodeLine{1429       \textcolor{keywordflow}{if} (this-\/>\_contiguous) \{}
\DoxyCodeLine{1430         \textcolor{keywordflow}{return} this-\/>\_blocks;}
\DoxyCodeLine{1431       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1432         \textcolor{keywordflow}{if} (!silent)}
\DoxyCodeLine{1433           cytnx\_warning\_msg(}
\DoxyCodeLine{1434             \textcolor{keyword}{true},}
\DoxyCodeLine{1435             \textcolor{stringliteral}{"{}[WARNING][SparseUniTensor] call get\_blocks\_() with a non-\/contiguous UniTensor should "{}}}
\DoxyCodeLine{1436             \textcolor{stringliteral}{"{}be used with caution. \(\backslash\)ntry: \(\backslash\)n1) get\_blocks()\(\backslash\)n2) call contiguous/contiguous\_() "{}}}
\DoxyCodeLine{1437             \textcolor{stringliteral}{"{}first, then get\_blocks\_() to get concise results\%s"{}},}
\DoxyCodeLine{1438             \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1439 }
\DoxyCodeLine{1440         \textcolor{keywordflow}{return} this-\/>\_blocks;}
\DoxyCodeLine{1441       \}}
\DoxyCodeLine{1442     \};}
\DoxyCodeLine{1443 }
\DoxyCodeLine{1444     \textcolor{keywordtype}{bool} same\_data(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1445       \textcolor{keywordflow}{if} (rhs-\/>uten\_type() != UTenType.Sparse) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{1446       \textcolor{keywordflow}{if} (rhs-\/>get\_blocks\_(1).size() != this-\/>get\_blocks\_(1).size()) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{1447 }
\DoxyCodeLine{1448       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < rhs-\/>get\_blocks\_(1).size(); i++)}
\DoxyCodeLine{1449         \textcolor{keywordflow}{if} (this-\/>get\_blocks\_(1)[i].same\_data(rhs-\/>get\_blocks\_(1)[i]) == \textcolor{keyword}{false}) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{1450 }
\DoxyCodeLine{1451       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{1452     \}}
\DoxyCodeLine{1453 }
\DoxyCodeLine{1454     \textcolor{keywordtype}{void} put\_block\_(\mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} cytnx\_uint64 \&idx = 0) \{}
\DoxyCodeLine{1455       cytnx\_error\_msg(}
\DoxyCodeLine{1456         this-\/>is\_contiguous() == \textcolor{keyword}{false},}
\DoxyCodeLine{1457         \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] cannot use put\_block\_() on non-\/contiguous UniTensor with "{}}}
\DoxyCodeLine{1458         \textcolor{stringliteral}{"{}symmetry.\(\backslash\)n suggest options: \(\backslash\)n  1) Call contiguous\_()/contiguous() first, then call "{}}}
\DoxyCodeLine{1459         \textcolor{stringliteral}{"{}put\_blocks\_()\(\backslash\)n  2) Try put\_block()/put\_blocks()\%s"{}},}
\DoxyCodeLine{1460         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1461 }
\DoxyCodeLine{1462       cytnx\_error\_msg(idx >= this-\/>\_blocks.size(), \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] index out of range\%s"{}},}
\DoxyCodeLine{1463                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1464       cytnx\_error\_msg(in.\mbox{\hyperlink{classcytnx_1_1Tensor_af36ef858677f13dcda8512fd9b5ae475}{shape}}() != this-\/>\_blocks[idx].shape(),}
\DoxyCodeLine{1465                       \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] the shape of input tensor does not match the shape "{}}}
\DoxyCodeLine{1466                       \textcolor{stringliteral}{"{}of block @ idx=\%d\(\backslash\)n"{}},}
\DoxyCodeLine{1467                       idx);}
\DoxyCodeLine{1468       this-\/>\_blocks[idx] = in;}
\DoxyCodeLine{1469     \};}
\DoxyCodeLine{1470     \textcolor{keywordtype}{void} put\_block(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} cytnx\_uint64 \&idx = 0) \{}
\DoxyCodeLine{1471       cytnx\_error\_msg(idx >= this-\/>\_blocks.size(), \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] index out of range\%s"{}},}
\DoxyCodeLine{1472                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1473       \textcolor{keywordflow}{if} (this-\/>\_contiguous) \{}
\DoxyCodeLine{1474         cytnx\_error\_msg(in.\mbox{\hyperlink{classcytnx_1_1Tensor_af36ef858677f13dcda8512fd9b5ae475}{shape}}() != this-\/>\_blocks[idx].shape(),}
\DoxyCodeLine{1475                         \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] the shape of input tensor does not match the "{}}}
\DoxyCodeLine{1476                         \textcolor{stringliteral}{"{}shape of block @ idx=\%d\(\backslash\)n"{}},}
\DoxyCodeLine{1477                         idx);}
\DoxyCodeLine{1478         this-\/>\_blocks[idx] = in.\mbox{\hyperlink{classcytnx_1_1Tensor_a5e2248e9babdb786167ed349df9084ae}{clone}}();}
\DoxyCodeLine{1479       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1480         cytnx\_error\_msg(\textcolor{keyword}{true},}
\DoxyCodeLine{1481                         \textcolor{stringliteral}{"{}[Developing] put block to a non-\/contiguous SparseUniTensor is currently "{}}}
\DoxyCodeLine{1482                         \textcolor{stringliteral}{"{}not support. Call contiguous()/contiguous\_() first.\%s"{}},}
\DoxyCodeLine{1483                         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1484       \}}
\DoxyCodeLine{1485     \};}
\DoxyCodeLine{1486     \textcolor{keywordtype}{void} put\_block(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force) \{}
\DoxyCodeLine{1487       \textcolor{keywordflow}{if} (!force)}
\DoxyCodeLine{1488         cytnx\_error\_msg(}
\DoxyCodeLine{1489           !this-\/>is\_braket\_form(),}
\DoxyCodeLine{1490           \textcolor{stringliteral}{"{}[ERROR][Un-\/physical] cannot get the block by qnums when bra-\/ket/in-\/out bonds mismatch "{}}}
\DoxyCodeLine{1491           \textcolor{stringliteral}{"{}the row/col space.\(\backslash\)n permute to the correct physical space first, then get block.\%s"{}},}
\DoxyCodeLine{1492           \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1493 }
\DoxyCodeLine{1494       \textcolor{comment}{// get dtype from qnum:}}
\DoxyCodeLine{1495       cytnx\_int64 idx = -\/1;}
\DoxyCodeLine{1496       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < this-\/>\_blockqnums.size(); i++) \{}
\DoxyCodeLine{1497         \textcolor{keywordflow}{if} (qnum == this-\/>\_blockqnums[i]) \{}
\DoxyCodeLine{1498           idx = i;}
\DoxyCodeLine{1499           \textcolor{keywordflow}{break};}
\DoxyCodeLine{1500         \}}
\DoxyCodeLine{1501       \}}
\DoxyCodeLine{1502       cytnx\_error\_msg(}
\DoxyCodeLine{1503         idx < 0, \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] no block with [qnum] exists in the current UniTensor.\%s"{}},}
\DoxyCodeLine{1504         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1505       this-\/>put\_block(in, idx);}
\DoxyCodeLine{1506     \};}
\DoxyCodeLine{1507     \textcolor{keywordtype}{void} put\_block\_(\mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force) \{}
\DoxyCodeLine{1508       \textcolor{keywordflow}{if} (!force)}
\DoxyCodeLine{1509         cytnx\_error\_msg(}
\DoxyCodeLine{1510           !this-\/>is\_braket\_form(),}
\DoxyCodeLine{1511           \textcolor{stringliteral}{"{}[ERROR][Un-\/physical] cannot get the block by qnums when bra-\/ket/in-\/out bonds mismatch "{}}}
\DoxyCodeLine{1512           \textcolor{stringliteral}{"{}the row/col space.\(\backslash\)n permute to the correct physical space first, then get block.\%s"{}},}
\DoxyCodeLine{1513           \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1514 }
\DoxyCodeLine{1515       \textcolor{comment}{// get dtype from qnum:}}
\DoxyCodeLine{1516       cytnx\_int64 idx = -\/1;}
\DoxyCodeLine{1517       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < this-\/>\_blockqnums.size(); i++) \{}
\DoxyCodeLine{1518         \textcolor{keywordflow}{if} (qnum == this-\/>\_blockqnums[i]) \{}
\DoxyCodeLine{1519           idx = i;}
\DoxyCodeLine{1520           \textcolor{keywordflow}{break};}
\DoxyCodeLine{1521         \}}
\DoxyCodeLine{1522       \}}
\DoxyCodeLine{1523       cytnx\_error\_msg(}
\DoxyCodeLine{1524         idx < 0, \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] no block with [qnum] exists in the current UniTensor.\%s"{}},}
\DoxyCodeLine{1525         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1526       this-\/>put\_block\_(in, idx);}
\DoxyCodeLine{1527     \};}
\DoxyCodeLine{1528 }
\DoxyCodeLine{1529     \textcolor{comment}{// this will only work on non-\/symm tensor (DenseUniTensor)}}
\DoxyCodeLine{1530     boost::intrusive\_ptr<UniTensor\_base> get(\textcolor{keyword}{const} std::vector<Accessor> \&accessors) \{}
\DoxyCodeLine{1531       cytnx\_error\_msg(\textcolor{keyword}{true},}
\DoxyCodeLine{1532                       \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor][get] cannot use get on a UniTensor with "{}}}
\DoxyCodeLine{1533                       \textcolor{stringliteral}{"{}Symmetry.\(\backslash\)n suggestion: try get\_block()/get\_blocks() first.\%s"{}},}
\DoxyCodeLine{1534                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1535       \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{1536     \}}
\DoxyCodeLine{1537     \textcolor{comment}{// this will only work on non-\/symm tensor (DenseUniTensor)}}
\DoxyCodeLine{1538     \textcolor{keywordtype}{void} set(\textcolor{keyword}{const} std::vector<Accessor> \&accessors, \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&rhs) \{}
\DoxyCodeLine{1539       cytnx\_error\_msg(\textcolor{keyword}{true},}
\DoxyCodeLine{1540                       \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor][set] cannot use set on a UniTensor with "{}}}
\DoxyCodeLine{1541                       \textcolor{stringliteral}{"{}Symmetry.\(\backslash\)n suggestion: try get\_block()/get\_blocks() first.\%s"{}},}
\DoxyCodeLine{1542                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1543     \}}
\DoxyCodeLine{1544     \textcolor{keywordtype}{void} reshape\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_shape, \textcolor{keyword}{const} cytnx\_uint64 \&rowrank = 0) \{}
\DoxyCodeLine{1545       cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR] cannot reshape a UniTensor with symmetry.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1546     \}}
\DoxyCodeLine{1547     boost::intrusive\_ptr<UniTensor\_base> reshape(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_shape,}
\DoxyCodeLine{1548                                                  \textcolor{keyword}{const} cytnx\_uint64 \&rowrank = 0) \{}
\DoxyCodeLine{1549       cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR] cannot reshape a UniTensor with symmetry.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1550       \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{1551     \}}
\DoxyCodeLine{1552     boost::intrusive\_ptr<UniTensor\_base> to\_dense() \{}
\DoxyCodeLine{1553       cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR] cannot to\_dense a UniTensor with symmetry.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1554       \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{1555     \}}
\DoxyCodeLine{1556     \textcolor{keywordtype}{void} to\_dense\_() \{}
\DoxyCodeLine{1557       cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR] cannot to\_dense\_ a UniTensor with symmetry.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1558     \}}
\DoxyCodeLine{1568     \textcolor{keywordtype}{void} combineBonds(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&indicators, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force,}
\DoxyCodeLine{1569                       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label) \{}
\DoxyCodeLine{1570       cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[Developing]\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1571     \};}
\DoxyCodeLine{1572     \textcolor{keywordtype}{void} combineBonds(\textcolor{keyword}{const} std::vector<std::string> \&indicators, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{true}) \{}
\DoxyCodeLine{1573       cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[Developing]\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1574     \};}
\DoxyCodeLine{1575     \textcolor{keywordtype}{void} combineBonds(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&indicators, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{true}) \{}
\DoxyCodeLine{1576       cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[Developing]\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1577     \};}
\DoxyCodeLine{1578     boost::intrusive\_ptr<UniTensor\_base> contract(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs,}
\DoxyCodeLine{1579                                                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&mv\_elem\_self = \textcolor{keyword}{false},}
\DoxyCodeLine{1580                                                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&mv\_elem\_rhs = \textcolor{keyword}{false});}
\DoxyCodeLine{1581     std::vector<Bond> getTotalQnums(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&physical = \textcolor{keyword}{false});}
\DoxyCodeLine{1582     std::vector<std::vector<cytnx\_int64>> get\_blocks\_qnums()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_blockqnums; \}}
\DoxyCodeLine{1583     \string~SparseUniTensor()\{\};}
\DoxyCodeLine{1584 }
\DoxyCodeLine{1585     \textcolor{comment}{// arithmetic}}
\DoxyCodeLine{1586     \textcolor{keywordtype}{void} Add\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{1587     \textcolor{keywordtype}{void} Add\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{1588 }
\DoxyCodeLine{1589     \textcolor{keywordtype}{void} Mul\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{1590     \textcolor{keywordtype}{void} Mul\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{1591 }
\DoxyCodeLine{1592     \textcolor{keywordtype}{void} Sub\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{1593     \textcolor{keywordtype}{void} Sub\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{1594     \textcolor{keywordtype}{void} lSub\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&lhs);}
\DoxyCodeLine{1595 }
\DoxyCodeLine{1596     \textcolor{keywordtype}{void} Div\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{1597     \textcolor{keywordtype}{void} Div\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{1598     \textcolor{keywordtype}{void} lDiv\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&lhs);}
\DoxyCodeLine{1599 }
\DoxyCodeLine{1600     boost::intrusive\_ptr<UniTensor\_base> \mbox{\hyperlink{namespacecytnx_1_1linalg_a470d0886432554a35ecaf961451c0806}{Conj}}() \{}
\DoxyCodeLine{1601       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{1602       out-\/>Conj\_();}
\DoxyCodeLine{1603       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1604     \}}
\DoxyCodeLine{1605 }
\DoxyCodeLine{1606     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecytnx_1_1linalg_adc3233bf8bc3eb6a435340f912412801}{Conj\_}}() \{}
\DoxyCodeLine{1607       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < this-\/>\_blocks.size(); i++) \{}
\DoxyCodeLine{1608         this-\/>\_blocks[i].Conj\_();}
\DoxyCodeLine{1609       \}}
\DoxyCodeLine{1610     \};}
\DoxyCodeLine{1611     boost::intrusive\_ptr<UniTensor\_base> Trace(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b);}
\DoxyCodeLine{1612     boost::intrusive\_ptr<UniTensor\_base> Trace(\textcolor{keyword}{const} std::string \&a, \textcolor{keyword}{const} std::string \&b);}
\DoxyCodeLine{1623     boost::intrusive\_ptr<UniTensor\_base> Trace(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b,}
\DoxyCodeLine{1624                                                \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{1625     \textcolor{keywordtype}{void} Trace\_(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b) \{}
\DoxyCodeLine{1626       cytnx\_error\_msg(\textcolor{keyword}{true},}
\DoxyCodeLine{1627                       \textcolor{stringliteral}{"{}[ERROR] Currently SparseUniTensor does not support inplace Trace!, call "{}}}
\DoxyCodeLine{1628                       \textcolor{stringliteral}{"{}Trace() instead!\%s"{}},}
\DoxyCodeLine{1629                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1630     \}}
\DoxyCodeLine{1631     \textcolor{keywordtype}{void} Trace\_(\textcolor{keyword}{const} std::string \&a, \textcolor{keyword}{const} std::string \&b) \{}
\DoxyCodeLine{1632       cytnx\_error\_msg(\textcolor{keyword}{true},}
\DoxyCodeLine{1633                       \textcolor{stringliteral}{"{}[ERROR] Currently SparseUniTensor does not support inplace Trace!, call "{}}}
\DoxyCodeLine{1634                       \textcolor{stringliteral}{"{}Trace() instead!\%s"{}},}
\DoxyCodeLine{1635                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1636     \}}
\DoxyCodeLine{1646     \textcolor{keywordtype}{void} Trace\_(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label) \{}
\DoxyCodeLine{1647       cytnx\_error\_msg(\textcolor{keyword}{true},}
\DoxyCodeLine{1648                       \textcolor{stringliteral}{"{}[ERROR] Currently SparseUniTensor does not support inplace Trace!, call "{}}}
\DoxyCodeLine{1649                       \textcolor{stringliteral}{"{}Trace() instead!\%s"{}},}
\DoxyCodeLine{1650                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1651     \}}
\DoxyCodeLine{1652 }
\DoxyCodeLine{1653     \textcolor{keywordtype}{void} Transpose\_();}
\DoxyCodeLine{1654     boost::intrusive\_ptr<UniTensor\_base> Transpose() \{}
\DoxyCodeLine{1655       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{1656       out-\/>Transpose\_();}
\DoxyCodeLine{1657       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1658     \}}
\DoxyCodeLine{1659 }
\DoxyCodeLine{1660     boost::intrusive\_ptr<UniTensor\_base> Dagger() \{}
\DoxyCodeLine{1661       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>\mbox{\hyperlink{namespacecytnx_1_1linalg_a470d0886432554a35ecaf961451c0806}{Conj}}();}
\DoxyCodeLine{1662       out-\/>Transpose\_();}
\DoxyCodeLine{1663       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1664     \}}
\DoxyCodeLine{1665     \textcolor{keywordtype}{void} Dagger\_() \{}
\DoxyCodeLine{1666       this-\/>\mbox{\hyperlink{namespacecytnx_1_1linalg_adc3233bf8bc3eb6a435340f912412801}{Conj\_}}();}
\DoxyCodeLine{1667       this-\/>Transpose\_();}
\DoxyCodeLine{1668     \}}
\DoxyCodeLine{1669 }
\DoxyCodeLine{1670     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \mbox{\hyperlink{namespacecytnx_1_1linalg_a9cd2be179860bb4742ebe320fa063680}{Norm}}() \textcolor{keyword}{const};}
\DoxyCodeLine{1671 }
\DoxyCodeLine{1672     \textcolor{keywordtype}{void} tag() \{}
\DoxyCodeLine{1673       \textcolor{comment}{// no-\/use!}}
\DoxyCodeLine{1674     \}}
\DoxyCodeLine{1684     \textcolor{keywordtype}{void} truncate\_(\textcolor{keyword}{const} cytnx\_int64 \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{1685     \textcolor{keywordtype}{void} truncate\_(\textcolor{keyword}{const} cytnx\_int64 \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim);}
\DoxyCodeLine{1686     \textcolor{keywordtype}{void} truncate\_(\textcolor{keyword}{const} std::string \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim);}
\DoxyCodeLine{1687     \textcolor{keyword}{const} Scalar::Sproxy at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator) \textcolor{keyword}{const};}
\DoxyCodeLine{1688     \textcolor{keyword}{const} cytnx\_complex128 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{1689                                           \textcolor{keyword}{const} cytnx\_complex128 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{1690     \textcolor{keyword}{const} cytnx\_complex64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{1691                                          \textcolor{keyword}{const} cytnx\_complex64 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{1692     \textcolor{keyword}{const} cytnx\_double \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{1693                                       \textcolor{keyword}{const} cytnx\_double \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{1694     \textcolor{keyword}{const} cytnx\_float \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{1695                                      \textcolor{keyword}{const} cytnx\_float \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{1696     \textcolor{keyword}{const} cytnx\_uint64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{1697                                       \textcolor{keyword}{const} cytnx\_uint64 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{1698     \textcolor{keyword}{const} cytnx\_int64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{1699                                      \textcolor{keyword}{const} cytnx\_int64 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{1700     \textcolor{keyword}{const} cytnx\_uint32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{1701                                       \textcolor{keyword}{const} cytnx\_uint32 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{1702     \textcolor{keyword}{const} cytnx\_int32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{1703                                      \textcolor{keyword}{const} cytnx\_int32 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{1704     \textcolor{keyword}{const} cytnx\_uint16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{1705                                       \textcolor{keyword}{const} cytnx\_uint16 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{1706     \textcolor{keyword}{const} cytnx\_int16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{1707                                      \textcolor{keyword}{const} cytnx\_int16 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{1708 }
\DoxyCodeLine{1709     Scalar::Sproxy at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator);}
\DoxyCodeLine{1710     cytnx\_complex128 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{1711                                     \textcolor{keyword}{const} cytnx\_complex128 \&aux);}
\DoxyCodeLine{1712     cytnx\_complex64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{1713                                    \textcolor{keyword}{const} cytnx\_complex64 \&aux);}
\DoxyCodeLine{1714     cytnx\_double \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_double \&aux);}
\DoxyCodeLine{1715     cytnx\_float \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_float \&aux);}
\DoxyCodeLine{1716     cytnx\_uint64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_uint64 \&aux);}
\DoxyCodeLine{1717     cytnx\_int64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_int64 \&aux);}
\DoxyCodeLine{1718     cytnx\_uint32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_uint32 \&aux);}
\DoxyCodeLine{1719     cytnx\_int32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_int32 \&aux);}
\DoxyCodeLine{1720     cytnx\_uint16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_uint16 \&aux);}
\DoxyCodeLine{1721     cytnx\_int16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_int16 \&aux);}
\DoxyCodeLine{1722 }
\DoxyCodeLine{1723     \textcolor{keywordtype}{void} group\_basis\_()\{}
\DoxyCodeLine{1724         cytnx\_warning\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[WARNING] group basis will not have any effect on SparseUniTensor.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1725     \}}
\DoxyCodeLine{1726 }
\DoxyCodeLine{1727     \textcolor{keywordtype}{bool} elem\_exists(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator) \textcolor{keyword}{const};}
\DoxyCodeLine{1728     \textcolor{keywordtype}{void} \_save\_dispatch(std::fstream \&f) \textcolor{keyword}{const};}
\DoxyCodeLine{1729     \textcolor{keywordtype}{void} \_load\_dispatch(std::fstream \&f);}
\DoxyCodeLine{1730 }
\DoxyCodeLine{1731     \textcolor{keyword}{const} std::vector<cytnx\_uint64>\& get\_qindices(\textcolor{keyword}{const} cytnx\_uint64 \&bidx)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{1732         cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] get\_qindices can only be unsed on BlockUniTensor with Symmetry.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1733     \}}
\DoxyCodeLine{1734     std::vector<cytnx\_uint64>\& get\_qindices(\textcolor{keyword}{const} cytnx\_uint64 \&bidx)\{}
\DoxyCodeLine{1735         cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] get\_qindices can only be unsed on BlockUniTensor.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1736     \}}
\DoxyCodeLine{1737     \textcolor{keyword}{const} vec2d<cytnx\_uint64> \& get\_itoi()\textcolor{keyword}{ const}\{}
\DoxyCodeLine{1738         cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] get\_itoi can only be unsed on BlockUniTensor with Symmetry.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1739     \}}
\DoxyCodeLine{1740     vec2d<cytnx\_uint64> \& get\_itoi()\{}
\DoxyCodeLine{1741         cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] get\_itoi can only be unsed on BlockUniTensor with Symmetry.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1742     \}}
\DoxyCodeLine{1743 }
\DoxyCodeLine{1744 }
\DoxyCodeLine{1745     \textcolor{comment}{// end virtual func}}
\DoxyCodeLine{1746 }
\DoxyCodeLine{1747   \};}
\DoxyCodeLine{1749 }
\DoxyCodeLine{1750   \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{1752 \textcolor{comment}{}  \textcolor{keyword}{class }BlockUniTensor : \textcolor{keyword}{public} UniTensor\_base \{}
\DoxyCodeLine{1753     \textcolor{keyword}{protected}:}
\DoxyCodeLine{1754     \textcolor{keyword}{public}:}
\DoxyCodeLine{1755 }
\DoxyCodeLine{1756         std::vector<std::vector<cytnx\_uint64> > \_inner\_to\_outer\_idx; }
\DoxyCodeLine{1757         std::vector<Tensor> \_blocks;}
\DoxyCodeLine{1758         \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} NullRefTensor; \textcolor{comment}{// this returns when access block is not exists! }}
\DoxyCodeLine{1759 }
\DoxyCodeLine{1760         \textcolor{comment}{// given an index list [loc], get qnums from this-\/>\_bonds[loc] and return the combined qnums calculated from Symm object!}}
\DoxyCodeLine{1761         \textcolor{comment}{// this assume 1. symmetry are the same for each bond! }}
\DoxyCodeLine{1762         \textcolor{comment}{//             2. total\_qns are feeded with size len(symmetry)}}
\DoxyCodeLine{1763         \textcolor{keywordtype}{void} \_fx\_get\_total\_fluxs(std::vector<cytnx\_uint64> \&loc, \textcolor{keyword}{const} std::vector<Symmetry> \&syms, std::vector<cytnx\_int64> \&total\_qns)\{}
\DoxyCodeLine{1764             memset(\&total\_qns[0],0,\textcolor{keyword}{sizeof}(cytnx\_int64)*total\_qns.size());}
\DoxyCodeLine{1765            }
\DoxyCodeLine{1766             \textcolor{keywordflow}{for}(cytnx\_int32 i=0;i<syms.size();i++)\{}
\DoxyCodeLine{1767                 \textcolor{keywordflow}{if}(this-\/>\_bonds[0].type() == BD\_BRA)}
\DoxyCodeLine{1768                     total\_qns[i] = syms[0].reverse\_rule(this-\/>\_bonds[0].\_impl-\/>\_qnums[loc[0]][i]);}
\DoxyCodeLine{1769                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{1770                     total\_qns[i] = this-\/>\_bonds[0].\_impl-\/>\_qnums[loc[0]][i];}
\DoxyCodeLine{1771 }
\DoxyCodeLine{1772                 \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} j=1;j<loc.size();j++)\{}
\DoxyCodeLine{1773                     \textcolor{keywordflow}{if}(this-\/>\_bonds[j].type() == BD\_BRA)}
\DoxyCodeLine{1774                         total\_qns[i] = syms[i].combine\_rule(total\_qns[i],syms[i].reverse\_rule(this-\/>\_bonds[j].\_impl-\/>\_qnums[loc[j]][i]));}
\DoxyCodeLine{1775                     \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{1776                         total\_qns[i] = syms[i].combine\_rule(total\_qns[i],this-\/>\_bonds[j].\_impl-\/>\_qnums[loc[j]][i]);}
\DoxyCodeLine{1777                     \}}
\DoxyCodeLine{1778                 \}}
\DoxyCodeLine{1779             \}             }
\DoxyCodeLine{1780 }
\DoxyCodeLine{1781 }
\DoxyCodeLine{1782         \}}
\DoxyCodeLine{1783 }
\DoxyCodeLine{1784         \textcolor{keywordtype}{void} \_fx\_locate\_elem(cytnx\_int64 \&bidx, std::vector<cytnx\_uint64> \&loc\_in\_T,\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator) \textcolor{keyword}{const};}
\DoxyCodeLine{1785 }
\DoxyCodeLine{1786         \textcolor{comment}{// internal function, grouping all duplicate qnums in all bonds}}
\DoxyCodeLine{1787         \textcolor{keywordtype}{void} \_fx\_group\_duplicates(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&dup\_bond\_idxs, \textcolor{keyword}{const} std::vector<std::vector<cytnx\_uint64> > \&idx\_mappers);        }
\DoxyCodeLine{1788 }
\DoxyCodeLine{1789 }
\DoxyCodeLine{1790         \textcolor{keywordtype}{void} set\_meta(BlockUniTensor *tmp, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&inner, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&outer)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1791           \textcolor{comment}{// outer meta}}
\DoxyCodeLine{1792           \textcolor{keywordflow}{if} (outer) \{}
\DoxyCodeLine{1793             tmp-\/>\_bonds = vec\_clone(this-\/>\_bonds);}
\DoxyCodeLine{1794             tmp-\/>\_labels = this-\/>\_labels;}
\DoxyCodeLine{1795             tmp-\/>\_is\_braket\_form = this-\/>\_is\_braket\_form;}
\DoxyCodeLine{1796             tmp-\/>\_rowrank = this-\/>\_rowrank;}
\DoxyCodeLine{1797             tmp-\/>\_name = this-\/>\_name;}
\DoxyCodeLine{1798           \}}
\DoxyCodeLine{1799 }
\DoxyCodeLine{1800           tmp-\/>\_is\_diag = this-\/>\_is\_diag;}
\DoxyCodeLine{1801 }
\DoxyCodeLine{1802           \textcolor{comment}{// inner meta}}
\DoxyCodeLine{1803           \textcolor{keywordflow}{if} (inner) \{}
\DoxyCodeLine{1804             tmp-\/>\_inner\_to\_outer\_idx = this-\/>\_inner\_to\_outer\_idx;}
\DoxyCodeLine{1805           \}}
\DoxyCodeLine{1806         \}}
\DoxyCodeLine{1807 }
\DoxyCodeLine{1808 }
\DoxyCodeLine{1809         BlockUniTensor *clone\_meta(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&inner, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&outer)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1810           BlockUniTensor *tmp = \textcolor{keyword}{new} BlockUniTensor();}
\DoxyCodeLine{1811           this-\/>set\_meta(tmp, inner, outer);}
\DoxyCodeLine{1812           \textcolor{keywordflow}{return} tmp;}
\DoxyCodeLine{1813         \};}
\DoxyCodeLine{1814 }
\DoxyCodeLine{1815 }
\DoxyCodeLine{1816 }
\DoxyCodeLine{1817     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}};}
\DoxyCodeLine{1818     BlockUniTensor()\{}
\DoxyCodeLine{1819         this-\/>uten\_type\_id = UTenType.Block;}
\DoxyCodeLine{1820         this-\/>\_is\_tag = \textcolor{keyword}{true};}
\DoxyCodeLine{1821     \} }
\DoxyCodeLine{1822 }
\DoxyCodeLine{1823     \textcolor{comment}{//virtual functions:}}
\DoxyCodeLine{1824     \textcolor{comment}{//void Init(const std::vector<Bond> \&bonds, const std::vector<cytnx\_int64> \&in\_labels = \{\},}}
\DoxyCodeLine{1825     \textcolor{comment}{//          const cytnx\_int64 \&rowrank = -\/1, const unsigned int \&dtype = Type.Double,}}
\DoxyCodeLine{1826     \textcolor{comment}{//          const int \&device = Device.cpu, const bool \&is\_diag = false,}}
\DoxyCodeLine{1827     \textcolor{comment}{//          const bool \&no\_alloc = false);}}
\DoxyCodeLine{1828     }
\DoxyCodeLine{1829     \textcolor{keywordtype}{void} Init(\textcolor{keyword}{const} std::vector<Bond> \&bonds, \textcolor{keyword}{const} std::vector<std::string> \&in\_labels = \{\},}
\DoxyCodeLine{1830               \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype = Type.Double,}
\DoxyCodeLine{1831               \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device = Device.cpu, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false},}
\DoxyCodeLine{1832               \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&no\_alloc = \textcolor{keyword}{false});}
\DoxyCodeLine{1833 }
\DoxyCodeLine{1834     \textcolor{keywordtype}{void} Init\_by\_Tensor(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in\_tensor, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false},}
\DoxyCodeLine{1835                         \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1) \{}
\DoxyCodeLine{1836       cytnx\_error\_msg(}
\DoxyCodeLine{1837         \textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] cannot use Init\_by\_tensor() on a BlockUniTensor.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1838     \}}
\DoxyCodeLine{1839     }
\DoxyCodeLine{1840 }
\DoxyCodeLine{1841     std::vector<cytnx\_uint64> shape()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1842       std::vector<cytnx\_uint64> out(this-\/>\_bonds.size());}
\DoxyCodeLine{1843       \textcolor{keywordflow}{for} (cytnx\_uint64 i = 0; i < out.size(); i++) \{}
\DoxyCodeLine{1844         out[i] = this-\/>\_bonds[i].dim();}
\DoxyCodeLine{1845       \}}
\DoxyCodeLine{1846       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1847     \}}
\DoxyCodeLine{1848 }
\DoxyCodeLine{1849     \textcolor{keywordtype}{bool} is\_blockform()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \textcolor{keyword}{true}; \}}
\DoxyCodeLine{1850     \textcolor{keywordtype}{bool} is\_contiguous()\textcolor{keyword}{ const }\{ }
\DoxyCodeLine{1851         \textcolor{keywordtype}{bool} out=\textcolor{keyword}{true};}
\DoxyCodeLine{1852         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<this-\/>\_blocks.size();i++)\{}
\DoxyCodeLine{1853             out \&= this-\/>\_blocks[i].is\_contiguous();}
\DoxyCodeLine{1854         \}}
\DoxyCodeLine{1855         \textcolor{keywordflow}{return} out; }
\DoxyCodeLine{1856     \};}
\DoxyCodeLine{1857     }
\DoxyCodeLine{1858     cytnx\_uint64 Nblocks()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_blocks.size(); \};}
\DoxyCodeLine{1859 }
\DoxyCodeLine{1860     \textcolor{keywordtype}{void} to\_(\textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device) \{}
\DoxyCodeLine{1861       \textcolor{keywordflow}{for} (cytnx\_uint64 i = 0; i < this-\/>\_blocks.size(); i++) \{}
\DoxyCodeLine{1862         this-\/>\_blocks[i].to\_(device);}
\DoxyCodeLine{1863       \}}
\DoxyCodeLine{1864     \};}
\DoxyCodeLine{1865 }
\DoxyCodeLine{1866     boost::intrusive\_ptr<UniTensor\_base> to(\textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device) \{}
\DoxyCodeLine{1867       \textcolor{keywordflow}{if} (this-\/>device() == device) \{}
\DoxyCodeLine{1868         \textcolor{keywordflow}{return} \textcolor{keyword}{this};}
\DoxyCodeLine{1869       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1870         boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{1871         out-\/>to\_(device);}
\DoxyCodeLine{1872         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1873       \}}
\DoxyCodeLine{1874     \};}
\DoxyCodeLine{1875     }
\DoxyCodeLine{1876     boost::intrusive\_ptr<UniTensor\_base> clone()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1877       BlockUniTensor *tmp = this-\/>clone\_meta(\textcolor{keyword}{true}, \textcolor{keyword}{true});}
\DoxyCodeLine{1878       tmp-\/>\_blocks = vec\_clone(this-\/>\_blocks);}
\DoxyCodeLine{1879       boost::intrusive\_ptr<UniTensor\_base> out(tmp);}
\DoxyCodeLine{1880       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1881     \};}
\DoxyCodeLine{1882 }
\DoxyCodeLine{1883     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} dtype()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1884 \textcolor{preprocessor}{\#ifdef UNI\_DEBUG}}
\DoxyCodeLine{1885       cytnx\_error\_msg(this-\/>\_blocks.size() == 0, \textcolor{stringliteral}{"{}[ERROR][internal] empty blocks for blockform.\%s"{}},}
\DoxyCodeLine{1886                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1887 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1888       \textcolor{keywordflow}{return} this-\/>\_blocks[0].dtype();}
\DoxyCodeLine{1889     \};}
\DoxyCodeLine{1890     \textcolor{keywordtype}{int} device()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1891 \textcolor{preprocessor}{\#ifdef UNI\_DEBUG}}
\DoxyCodeLine{1892       cytnx\_error\_msg(this-\/>\_blocks.size() == 0, \textcolor{stringliteral}{"{}[ERROR][internal] empty blocks for blockform.\%s"{}},}
\DoxyCodeLine{1893                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1894 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1895       \textcolor{keywordflow}{return} this-\/>\_blocks[0].device();}
\DoxyCodeLine{1896     \};}
\DoxyCodeLine{1897     std::string dtype\_str()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1898 \textcolor{preprocessor}{\#ifdef UNI\_DEBUG}}
\DoxyCodeLine{1899       cytnx\_error\_msg(this-\/>\_blocks.size() == 0, \textcolor{stringliteral}{"{}[ERROR][internal] empty blocks for blockform.\%s"{}},}
\DoxyCodeLine{1900                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1901 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1902       \textcolor{keywordflow}{return} this-\/>\_blocks[0].dtype\_str();}
\DoxyCodeLine{1903     \};}
\DoxyCodeLine{1904     std::string device\_str()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1905 \textcolor{preprocessor}{\#ifdef UNI\_DEBUG}}
\DoxyCodeLine{1906       cytnx\_error\_msg(this-\/>\_blocks.size() == 0, \textcolor{stringliteral}{"{}[ERROR][internal] empty blocks for blockform.\%s"{}},}
\DoxyCodeLine{1907                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1908 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1909       \textcolor{keywordflow}{return} this-\/>\_blocks[0].device\_str();}
\DoxyCodeLine{1910 }
\DoxyCodeLine{1911     \};}
\DoxyCodeLine{1912 }
\DoxyCodeLine{1913     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} get\_block(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1914       cytnx\_error\_msg(idx >= this-\/>\_blocks.size(), \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] index out of range\%s"{}},}
\DoxyCodeLine{1915                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1916       \textcolor{keywordflow}{return} this-\/>\_blocks[idx].clone();  }
\DoxyCodeLine{1917     \};}
\DoxyCodeLine{1918 }
\DoxyCodeLine{1919     \textcolor{comment}{// this one for Block will return the indicies!!}}
\DoxyCodeLine{1920     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} get\_block(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&indices, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force\_return)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1921          }
\DoxyCodeLine{1922         cytnx\_error\_msg(indices.size()!=this-\/>rank(),\textcolor{stringliteral}{"{}[ERROR][get\_block][BlockUniTensor] len(indices) must be the same as the Tensor rank (number of legs).\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1923         }
\DoxyCodeLine{1924         std::vector<cytnx\_uint64> inds(indices.begin(),indices.end());}
\DoxyCodeLine{1925 }
\DoxyCodeLine{1926 }
\DoxyCodeLine{1927         \textcolor{comment}{//find if the indices specify exists!}}
\DoxyCodeLine{1928         cytnx\_int64 b = -\/1;}
\DoxyCodeLine{1929         \textcolor{keywordflow}{for}(cytnx\_uint64 i=0;i<this-\/>\_inner\_to\_outer\_idx.size();i++)\{}
\DoxyCodeLine{1930             \textcolor{keywordflow}{if}(inds == this-\/>\_inner\_to\_outer\_idx[i])\{}
\DoxyCodeLine{1931                 b = i;}
\DoxyCodeLine{1932                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{1933             \}}
\DoxyCodeLine{1934         \}}
\DoxyCodeLine{1935         }
\DoxyCodeLine{1936         \textcolor{keywordflow}{if}(b<0)\{}
\DoxyCodeLine{1937             \textcolor{keywordflow}{if}(force\_return)\{}
\DoxyCodeLine{1938                 \textcolor{keywordflow}{return} NullRefTensor;}
\DoxyCodeLine{1939             \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{1940                 cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR][get\_block][BlockUniTensor] no avaliable block exists, force\_return=false, so error throws. \(\backslash\)n    If you want to return an empty block without error when block is not avaliable, set force\_return=True.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1941             \}}
\DoxyCodeLine{1942         \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{1943             \textcolor{keywordflow}{return} this-\/>\_blocks[b].clone();}
\DoxyCodeLine{1944         \} }
\DoxyCodeLine{1945     \}}
\DoxyCodeLine{1946     }
\DoxyCodeLine{1947     \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}}\& get\_block\_(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1948       cytnx\_error\_msg(idx >= this-\/>\_blocks.size(), \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] index out of range\%s"{}},}
\DoxyCodeLine{1949                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1950       \textcolor{keywordflow}{return} this-\/>\_blocks[idx];}
\DoxyCodeLine{1951     \};}
\DoxyCodeLine{1952     }
\DoxyCodeLine{1953     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}}\& get\_block\_(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0) \{}
\DoxyCodeLine{1954       cytnx\_error\_msg(idx >= this-\/>\_blocks.size(), \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] index out of range\%s"{}},}
\DoxyCodeLine{1955                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1956       \textcolor{keywordflow}{return} this-\/>\_blocks[idx];}
\DoxyCodeLine{1957     \};}
\DoxyCodeLine{1958     }
\DoxyCodeLine{1959     \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&indices, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force\_return)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1960         cytnx\_error\_msg(indices.size()!=this-\/>rank(),\textcolor{stringliteral}{"{}[ERROR][get\_block][BlockUniTensor] len(indices) must be the same as the Tensor rank (number of legs).\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1961         }
\DoxyCodeLine{1962         std::vector<cytnx\_uint64> inds(indices.begin(),indices.end());}
\DoxyCodeLine{1963 }
\DoxyCodeLine{1964         \textcolor{comment}{//find if the indices specify exists!}}
\DoxyCodeLine{1965         cytnx\_int64 b = -\/1;}
\DoxyCodeLine{1966         \textcolor{keywordflow}{for}(cytnx\_uint64 i=0;i<this-\/>\_inner\_to\_outer\_idx.size();i++)\{}
\DoxyCodeLine{1967             \textcolor{keywordflow}{if}(inds == this-\/>\_inner\_to\_outer\_idx[i])\{}
\DoxyCodeLine{1968                 b = i;}
\DoxyCodeLine{1969                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{1970             \}}
\DoxyCodeLine{1971         \}}
\DoxyCodeLine{1972         }
\DoxyCodeLine{1973         \textcolor{keywordflow}{if}(b<0)\{}
\DoxyCodeLine{1974             \textcolor{keywordflow}{if}(force\_return)\{}
\DoxyCodeLine{1975                 \textcolor{keywordflow}{return} this-\/>NullRefTensor;}
\DoxyCodeLine{1976             \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{1977                 cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR][get\_block][BlockUniTensor] no avaliable block exists, force\_return=false, so error throws. \(\backslash\)n    If you want to return an empty block without error when block is not avaliable, set force\_return=True.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1978             \}}
\DoxyCodeLine{1979         \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{1980             \textcolor{keywordflow}{return} this-\/>\_blocks[b];}
\DoxyCodeLine{1981         \} }
\DoxyCodeLine{1982 }
\DoxyCodeLine{1983     \}}
\DoxyCodeLine{1984     }
\DoxyCodeLine{1985     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&indices, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force\_return)\{}
\DoxyCodeLine{1986         cytnx\_error\_msg(indices.size()!=this-\/>rank(),\textcolor{stringliteral}{"{}[ERROR][get\_block][BlockUniTensor] len(indices) must be the same as the Tensor rank (number of legs).\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{1987         }
\DoxyCodeLine{1988         std::vector<cytnx\_uint64> inds(indices.begin(),indices.end());}
\DoxyCodeLine{1989 }
\DoxyCodeLine{1990         \textcolor{comment}{//find if the indices specify exists!}}
\DoxyCodeLine{1991         cytnx\_int64 b = -\/1;}
\DoxyCodeLine{1992         \textcolor{keywordflow}{for}(cytnx\_uint64 i=0;i<this-\/>\_inner\_to\_outer\_idx.size();i++)\{}
\DoxyCodeLine{1993             \textcolor{keywordflow}{if}(inds == this-\/>\_inner\_to\_outer\_idx[i])\{}
\DoxyCodeLine{1994                 b = i;}
\DoxyCodeLine{1995                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{1996             \}}
\DoxyCodeLine{1997         \}}
\DoxyCodeLine{1998         }
\DoxyCodeLine{1999         \textcolor{keywordflow}{if}(b<0)\{}
\DoxyCodeLine{2000             \textcolor{keywordflow}{if}(force\_return)\{}
\DoxyCodeLine{2001                 \textcolor{keywordflow}{return} this-\/>NullRefTensor;}
\DoxyCodeLine{2002             \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{2003                 cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR][get\_block][BlockUniTensor] no avaliable block exists, force\_return=false, so error throws. \(\backslash\)n    If you want to return an empty block without error when block is not avaliable, set force\_return=True.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2004             \}}
\DoxyCodeLine{2005         \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{2006             \textcolor{keywordflow}{return} this-\/>\_blocks[b];}
\DoxyCodeLine{2007         \} }
\DoxyCodeLine{2008 }
\DoxyCodeLine{2009     \}}
\DoxyCodeLine{2010 }
\DoxyCodeLine{2011     std::vector<Tensor> get\_blocks()\textcolor{keyword}{ const}\{}
\DoxyCodeLine{2012         \textcolor{keywordflow}{return} vec\_clone(this-\/>\_blocks);}
\DoxyCodeLine{2013     \}}
\DoxyCodeLine{2014     \textcolor{keyword}{const} std::vector<Tensor> \&get\_blocks\_(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{2015         \textcolor{keywordflow}{return} this-\/>\_blocks;}
\DoxyCodeLine{2016     \}}
\DoxyCodeLine{2017     std::vector<Tensor> \&get\_blocks\_(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&)\{}
\DoxyCodeLine{2018         \textcolor{keywordflow}{return} this-\/>\_blocks;}
\DoxyCodeLine{2019     \}}
\DoxyCodeLine{2020 }
\DoxyCodeLine{2021 }
\DoxyCodeLine{2022     }
\DoxyCodeLine{2023     \textcolor{keywordtype}{bool} same\_data(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2024       \textcolor{keywordflow}{if} (rhs-\/>uten\_type() != UTenType.Block) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{2025       \textcolor{keywordflow}{if} (rhs-\/>get\_blocks\_(1).size() != this-\/>get\_blocks\_(1).size()) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{2026 }
\DoxyCodeLine{2027       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < rhs-\/>get\_blocks\_(1).size(); i++)}
\DoxyCodeLine{2028         \textcolor{keywordflow}{if} (this-\/>get\_blocks\_(1)[i].same\_data(rhs-\/>get\_blocks\_(1)[i]) == \textcolor{keyword}{false}) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{2029 }
\DoxyCodeLine{2030       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{2031     \}}
\DoxyCodeLine{2032 }
\DoxyCodeLine{2033 }
\DoxyCodeLine{2034 }
\DoxyCodeLine{2035     \textcolor{keywordtype}{void} set\_rowrank(\textcolor{keyword}{const} cytnx\_uint64 \&new\_rowrank) \{}
\DoxyCodeLine{2036       cytnx\_error\_msg(new\_rowrank > this-\/>rank(),}
\DoxyCodeLine{2037                       \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] rowrank should be [>=0] and [<=UniTensor.rank].\%s"{}},}
\DoxyCodeLine{2038                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2039       \textcolor{keywordflow}{if}(this-\/>is\_diag())\{}
\DoxyCodeLine{2040         cytnx\_error\_msg(new\_rowrank != 1,}
\DoxyCodeLine{2041                       \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] rowrank should be [==1] when is\_diag =true!.\%s"{}},}
\DoxyCodeLine{2042                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2043       \}}
\DoxyCodeLine{2044       this-\/>\_rowrank = new\_rowrank;}
\DoxyCodeLine{2045       this-\/>\_is\_braket\_form = this-\/>\_update\_braket();}
\DoxyCodeLine{2046     \}}
\DoxyCodeLine{2047    }
\DoxyCodeLine{2048     boost::intrusive\_ptr<UniTensor\_base> permute(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&mapper,}
\DoxyCodeLine{2049                                                          \textcolor{keyword}{const} cytnx\_int64 \&rowrank=-\/1,}
\DoxyCodeLine{2050                                                          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label=\textcolor{keyword}{false});}
\DoxyCodeLine{2051     boost::intrusive\_ptr<UniTensor\_base> permute(\textcolor{keyword}{const} std::vector<std::string> \&mapper,}
\DoxyCodeLine{2052                                                          \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1);}
\DoxyCodeLine{2053     \textcolor{comment}{//boost::intrusive\_ptr<UniTensor\_base> permute(const std::vector<cytnx\_int64> \&mapper,}}
\DoxyCodeLine{2054     \textcolor{comment}{//                                                     const cytnx\_int64 \&rowrank = -\/1);}}
\DoxyCodeLine{2055 }
\DoxyCodeLine{2056     \textcolor{keywordtype}{void} permute\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank=-\/1,}
\DoxyCodeLine{2057                           \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label=\textcolor{keyword}{false});}
\DoxyCodeLine{2058     \textcolor{keywordtype}{void} permute\_(\textcolor{keyword}{const} std::vector<std::string> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1);}
\DoxyCodeLine{2059     \textcolor{comment}{//void permute\_(const std::vector<cytnx\_int64> \&mapper, const cytnx\_int64 \&rowrank = -\/1);}}
\DoxyCodeLine{2060 }
\DoxyCodeLine{2061  }
\DoxyCodeLine{2062     boost::intrusive\_ptr<UniTensor\_base> contiguous\_() \{}
\DoxyCodeLine{2063       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} b=0;b<this-\/>\_blocks.size();b++)}
\DoxyCodeLine{2064         this-\/>\_blocks[b].contiguous\_();}
\DoxyCodeLine{2065       \textcolor{keywordflow}{return} boost::intrusive\_ptr<UniTensor\_base>(\textcolor{keyword}{this}); }
\DoxyCodeLine{2066     \}}
\DoxyCodeLine{2067 }
\DoxyCodeLine{2068     boost::intrusive\_ptr<UniTensor\_base> contiguous();}
\DoxyCodeLine{2069 }
\DoxyCodeLine{2070 }
\DoxyCodeLine{2071     \textcolor{keywordtype}{void} print\_diagram(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&bond\_info = \textcolor{keyword}{false});}
\DoxyCodeLine{2072     \textcolor{keywordtype}{void} print\_blocks(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&full\_info=\textcolor{keyword}{true}) \textcolor{keyword}{const};}
\DoxyCodeLine{2073     \textcolor{keywordtype}{void} print\_block(\textcolor{keyword}{const} cytnx\_int64 \&idx, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&full\_info=\textcolor{keyword}{true}) \textcolor{keyword}{const};}
\DoxyCodeLine{2074 }
\DoxyCodeLine{2075     boost::intrusive\_ptr<UniTensor\_base> contract(}
\DoxyCodeLine{2076       \textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&mv\_elem\_self = \textcolor{keyword}{false},}
\DoxyCodeLine{2077       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&mv\_elem\_rhs = \textcolor{keyword}{false});}
\DoxyCodeLine{2078    }
\DoxyCodeLine{2079 }
\DoxyCodeLine{2080     boost::intrusive\_ptr<UniTensor\_base> relabels(}
\DoxyCodeLine{2081       \textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_labels);}
\DoxyCodeLine{2082     boost::intrusive\_ptr<UniTensor\_base> relabels(}
\DoxyCodeLine{2083       \textcolor{keyword}{const} std::vector<std::string> \&new\_labels);}
\DoxyCodeLine{2084     boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} cytnx\_int64 \&inx,}
\DoxyCodeLine{2085                                                          \textcolor{keyword}{const} cytnx\_int64 \&new\_label,}
\DoxyCodeLine{2086                                                          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{2087     boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} std::string \&inx,}
\DoxyCodeLine{2088                                                          \textcolor{keyword}{const} std::string \&new\_label);}
\DoxyCodeLine{2089     boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} cytnx\_int64 \&inx,}
\DoxyCodeLine{2090                                                          \textcolor{keyword}{const} cytnx\_int64 \&new\_label);}
\DoxyCodeLine{2091     boost::intrusive\_ptr<UniTensor\_base> relabel(\textcolor{keyword}{const} cytnx\_int64 \&inx,}
\DoxyCodeLine{2092                                                          \textcolor{keyword}{const} std::string \&new\_label);}
\DoxyCodeLine{2093  }
\DoxyCodeLine{2094     std::vector<Symmetry> syms() \textcolor{keyword}{const};}
\DoxyCodeLine{2095 }
\DoxyCodeLine{2096     \textcolor{keywordtype}{void} reshape\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_shape, \textcolor{keyword}{const} cytnx\_uint64 \&rowrank = 0) \{}
\DoxyCodeLine{2097       cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR] cannot reshape a UniTensor with symmetry.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2098     \}}
\DoxyCodeLine{2099     boost::intrusive\_ptr<UniTensor\_base> reshape(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_shape,}
\DoxyCodeLine{2100                                                  \textcolor{keyword}{const} cytnx\_uint64 \&rowrank = 0) \{}
\DoxyCodeLine{2101       cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR] cannot reshape a UniTensor with symmetry.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2102       \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{2103     \}}
\DoxyCodeLine{2104 }
\DoxyCodeLine{2105     boost::intrusive\_ptr<UniTensor\_base> astype(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2106       BlockUniTensor *tmp = this-\/>clone\_meta(\textcolor{keyword}{true}, \textcolor{keyword}{true});}
\DoxyCodeLine{2107       tmp-\/>\_blocks.resize(this-\/>\_blocks.size());}
\DoxyCodeLine{2108       \textcolor{keywordflow}{for} (cytnx\_int64 blk = 0; blk < this-\/>\_blocks.size(); blk++) \{}
\DoxyCodeLine{2109         tmp-\/>\_blocks[blk] = this-\/>\_blocks[blk].astype(dtype);}
\DoxyCodeLine{2110       \}}
\DoxyCodeLine{2111       boost::intrusive\_ptr<UniTensor\_base> out(tmp);}
\DoxyCodeLine{2112       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2113     \};}
\DoxyCodeLine{2114 }
\DoxyCodeLine{2115     \textcolor{comment}{// this will only work on non-\/symm tensor (DenseUniTensor)}}
\DoxyCodeLine{2116     boost::intrusive\_ptr<UniTensor\_base> get(\textcolor{keyword}{const} std::vector<Accessor> \&accessors)\{}
\DoxyCodeLine{2117         cytnx\_error\_msg(\textcolor{keyword}{true},}
\DoxyCodeLine{2118                       \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor][get] cannot use get on a UniTensor with "{}}}
\DoxyCodeLine{2119                       \textcolor{stringliteral}{"{}Symmetry.\(\backslash\)n suggestion: try get\_block/get\_block\_/get\_blocks/get\_blocks\_ first.\%s"{}},}
\DoxyCodeLine{2120                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2121       \textcolor{keywordflow}{return} \textcolor{keyword}{nullptr};}
\DoxyCodeLine{2122 }
\DoxyCodeLine{2123     \}}
\DoxyCodeLine{2124 }
\DoxyCodeLine{2125     \textcolor{comment}{// this will only work on non-\/symm tensor (DenseUniTensor)}}
\DoxyCodeLine{2126     \textcolor{keywordtype}{void} set(\textcolor{keyword}{const} std::vector<Accessor> \&accessors, \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&rhs)\{}
\DoxyCodeLine{2127         cytnx\_error\_msg(\textcolor{keyword}{true},}
\DoxyCodeLine{2128                       \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor][get] cannot use get on a UniTensor with "{}}}
\DoxyCodeLine{2129                       \textcolor{stringliteral}{"{}Symmetry.\(\backslash\)n suggestion: try get\_block/get\_block\_/get\_blocks/get\_blocks\_ first.\%s"{}},}
\DoxyCodeLine{2130                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2131     \}}
\DoxyCodeLine{2132 }
\DoxyCodeLine{2133     \textcolor{keywordtype}{void} put\_block(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} cytnx\_uint64 \&idx = 0)\{}
\DoxyCodeLine{2134         cytnx\_error\_msg(idx >= this-\/>\_blocks.size(), \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] index out of range\%s"{}},}
\DoxyCodeLine{2135                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2136         cytnx\_error\_msg(in.\mbox{\hyperlink{classcytnx_1_1Tensor_af36ef858677f13dcda8512fd9b5ae475}{shape}}() != this-\/>\_blocks[idx].shape(),}
\DoxyCodeLine{2137                       \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] the shape of input tensor does not match the shape "{}}}
\DoxyCodeLine{2138                       \textcolor{stringliteral}{"{}of block @ idx=\%d\(\backslash\)n"{}},}
\DoxyCodeLine{2139                       idx);}
\DoxyCodeLine{2140 }
\DoxyCodeLine{2141         this-\/>\_blocks[idx] = in.\mbox{\hyperlink{classcytnx_1_1Tensor_a5e2248e9babdb786167ed349df9084ae}{clone}}();}
\DoxyCodeLine{2142     \}}
\DoxyCodeLine{2143     \textcolor{keywordtype}{void} put\_block\_(\mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} cytnx\_uint64 \&idx = 0)\{}
\DoxyCodeLine{2144         cytnx\_error\_msg(idx >= this-\/>\_blocks.size(), \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] index out of range\%s"{}},}
\DoxyCodeLine{2145                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2146         cytnx\_error\_msg(in.\mbox{\hyperlink{classcytnx_1_1Tensor_af36ef858677f13dcda8512fd9b5ae475}{shape}}() != this-\/>\_blocks[idx].shape(),}
\DoxyCodeLine{2147                       \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] the shape of input tensor does not match the shape "{}}}
\DoxyCodeLine{2148                       \textcolor{stringliteral}{"{}of block @ idx=\%d\(\backslash\)n"{}},}
\DoxyCodeLine{2149                       idx);}
\DoxyCodeLine{2150 }
\DoxyCodeLine{2151         this-\/>\_blocks[idx] = in;}
\DoxyCodeLine{2152 }
\DoxyCodeLine{2153     \}}
\DoxyCodeLine{2154     \textcolor{keywordtype}{void} put\_block(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&indices,}
\DoxyCodeLine{2155                    \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&check)\{}
\DoxyCodeLine{2156 }
\DoxyCodeLine{2157         cytnx\_error\_msg(indices.size()!=this-\/>rank(),\textcolor{stringliteral}{"{}[ERROR][put\_block][BlockUniTensor] len(indices) must be the same as the Tensor rank (number of legs).\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2158 }
\DoxyCodeLine{2159         std::vector<cytnx\_uint64> inds(indices.begin(),indices.end());}
\DoxyCodeLine{2160 }
\DoxyCodeLine{2161         \textcolor{comment}{//find if the indices specify exists!}}
\DoxyCodeLine{2162         cytnx\_int64 b = -\/1;}
\DoxyCodeLine{2163         \textcolor{keywordflow}{for}(cytnx\_uint64 i=0;i<this-\/>\_inner\_to\_outer\_idx.size();i++)\{}
\DoxyCodeLine{2164             \textcolor{keywordflow}{if}(inds == this-\/>\_inner\_to\_outer\_idx[i])\{}
\DoxyCodeLine{2165                 b = i;}
\DoxyCodeLine{2166                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{2167             \}}
\DoxyCodeLine{2168         \}}
\DoxyCodeLine{2169 }
\DoxyCodeLine{2170         \textcolor{keywordflow}{if}(b<0)\{}
\DoxyCodeLine{2171             \textcolor{keywordflow}{if}(check)\{}
\DoxyCodeLine{2172                 cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR][put\_block][BlockUniTensor] no avaliable block exists, check=true, so error throws. \(\backslash\)n    If you want without error when block is not avaliable, set check=false.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2173             \}}
\DoxyCodeLine{2174         \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{2175             cytnx\_error\_msg(in.\mbox{\hyperlink{classcytnx_1_1Tensor_af36ef858677f13dcda8512fd9b5ae475}{shape}}() != this-\/>\_blocks[b].shape(),}
\DoxyCodeLine{2176                           \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] the shape of input tensor does not match the shape "{}}}
\DoxyCodeLine{2177                           \textcolor{stringliteral}{"{}of block @ idx=\%d\(\backslash\)n"{}},}
\DoxyCodeLine{2178                           b);}
\DoxyCodeLine{2179 }
\DoxyCodeLine{2180             this-\/>\_blocks[b] = in.\mbox{\hyperlink{classcytnx_1_1Tensor_a5e2248e9babdb786167ed349df9084ae}{clone}}();}
\DoxyCodeLine{2181         \}}
\DoxyCodeLine{2182 }
\DoxyCodeLine{2183 }
\DoxyCodeLine{2184     \}}
\DoxyCodeLine{2185     \textcolor{keywordtype}{void} put\_block\_(\mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&indices, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&check)\{}
\DoxyCodeLine{2186         cytnx\_error\_msg(indices.size()!=this-\/>rank(),\textcolor{stringliteral}{"{}[ERROR][put\_block][BlockUniTensor] len(indices) must be the same as the Tensor rank (number of legs).\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2187 }
\DoxyCodeLine{2188         std::vector<cytnx\_uint64> inds(indices.begin(),indices.end());}
\DoxyCodeLine{2189 }
\DoxyCodeLine{2190         \textcolor{comment}{//find if the indices specify exists!}}
\DoxyCodeLine{2191         cytnx\_int64 b = -\/1;}
\DoxyCodeLine{2192         \textcolor{keywordflow}{for}(cytnx\_uint64 i=0;i<this-\/>\_inner\_to\_outer\_idx.size();i++)\{}
\DoxyCodeLine{2193             \textcolor{keywordflow}{if}(inds == this-\/>\_inner\_to\_outer\_idx[i])\{}
\DoxyCodeLine{2194                 b = i;}
\DoxyCodeLine{2195                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{2196             \}}
\DoxyCodeLine{2197         \}}
\DoxyCodeLine{2198 }
\DoxyCodeLine{2199         \textcolor{keywordflow}{if}(b<0)\{}
\DoxyCodeLine{2200             \textcolor{keywordflow}{if}(check)\{}
\DoxyCodeLine{2201                 cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR][put\_block][BlockUniTensor] no avaliable block exists, check=true, so error throws. \(\backslash\)n    If you want without error when block is not avaliable, set check=false.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2202             \}}
\DoxyCodeLine{2203         \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{2204             cytnx\_error\_msg(in.\mbox{\hyperlink{classcytnx_1_1Tensor_af36ef858677f13dcda8512fd9b5ae475}{shape}}() != this-\/>\_blocks[b].shape(),}
\DoxyCodeLine{2205                           \textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] the shape of input tensor does not match the shape "{}}}
\DoxyCodeLine{2206                           \textcolor{stringliteral}{"{}of block @ idx=\%d\(\backslash\)n"{}},}
\DoxyCodeLine{2207                           b);}
\DoxyCodeLine{2208             this-\/>\_blocks[b] = in;}
\DoxyCodeLine{2209         \}}
\DoxyCodeLine{2210 }
\DoxyCodeLine{2211     \}}
\DoxyCodeLine{2212 }
\DoxyCodeLine{2213     \textcolor{keywordtype}{void} tag() \{}
\DoxyCodeLine{2214       \textcolor{comment}{// no-\/use!}}
\DoxyCodeLine{2215     \}}
\DoxyCodeLine{2216 }
\DoxyCodeLine{2217 }
\DoxyCodeLine{2218     boost::intrusive\_ptr<UniTensor\_base> \mbox{\hyperlink{namespacecytnx_1_1linalg_a470d0886432554a35ecaf961451c0806}{Conj}}() \{}
\DoxyCodeLine{2219       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{2220       out-\/>Conj\_();}
\DoxyCodeLine{2221       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2222     \}}
\DoxyCodeLine{2223 }
\DoxyCodeLine{2224     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacecytnx_1_1linalg_adc3233bf8bc3eb6a435340f912412801}{Conj\_}}() \{}
\DoxyCodeLine{2225       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < this-\/>\_blocks.size(); i++) \{}
\DoxyCodeLine{2226         this-\/>\_blocks[i].Conj\_();}
\DoxyCodeLine{2227       \}}
\DoxyCodeLine{2228     \};}
\DoxyCodeLine{2229 }
\DoxyCodeLine{2230     \textcolor{keywordtype}{void} Transpose\_();}
\DoxyCodeLine{2231     boost::intrusive\_ptr<UniTensor\_base> Transpose() \{}
\DoxyCodeLine{2232       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{2233       out-\/>Transpose\_();}
\DoxyCodeLine{2234       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2235     \}}
\DoxyCodeLine{2236 }
\DoxyCodeLine{2237     boost::intrusive\_ptr<UniTensor\_base> Dagger() \{}
\DoxyCodeLine{2238       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>\mbox{\hyperlink{namespacecytnx_1_1linalg_a470d0886432554a35ecaf961451c0806}{Conj}}();}
\DoxyCodeLine{2239       out-\/>Transpose\_();}
\DoxyCodeLine{2240       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2241     \}}
\DoxyCodeLine{2242     \textcolor{keywordtype}{void} Dagger\_() \{}
\DoxyCodeLine{2243       this-\/>\mbox{\hyperlink{namespacecytnx_1_1linalg_adc3233bf8bc3eb6a435340f912412801}{Conj\_}}();}
\DoxyCodeLine{2244       this-\/>Transpose\_();}
\DoxyCodeLine{2245     \}}
\DoxyCodeLine{2246 }
\DoxyCodeLine{2247     \textcolor{keywordtype}{void} Trace\_(\textcolor{keyword}{const} std::string \&a, \textcolor{keyword}{const} std::string \&b);}
\DoxyCodeLine{2248     \textcolor{keywordtype}{void} Trace\_(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b);}
\DoxyCodeLine{2249     \textcolor{keywordtype}{void} Trace\_(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{2250 }
\DoxyCodeLine{2251     boost::intrusive\_ptr<UniTensor\_base> Trace(\textcolor{keyword}{const} std::string \&a, \textcolor{keyword}{const} std::string \&b) \{}
\DoxyCodeLine{2252       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{2253       out-\/>Trace\_(a, b);}
\DoxyCodeLine{2254       \textcolor{keywordflow}{if}(out-\/>rank()==0)\{}
\DoxyCodeLine{2255         DenseUniTensor *tmp = \textcolor{keyword}{new} DenseUniTensor();}
\DoxyCodeLine{2256         tmp-\/>\_block = ((BlockUniTensor*)out.get())-\/>\_blocks[0];}
\DoxyCodeLine{2257         out = boost::intrusive\_ptr<UniTensor\_base>(tmp);}
\DoxyCodeLine{2258       \}}
\DoxyCodeLine{2259       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2260     \}}
\DoxyCodeLine{2261     boost::intrusive\_ptr<UniTensor\_base> Trace(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b) \{}
\DoxyCodeLine{2262       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{2263       out-\/>Trace\_(a, b);}
\DoxyCodeLine{2264       \textcolor{keywordflow}{if}(out-\/>rank()==0)\{}
\DoxyCodeLine{2265         DenseUniTensor *tmp = \textcolor{keyword}{new} DenseUniTensor();}
\DoxyCodeLine{2266         tmp-\/>\_block = ((BlockUniTensor*)out.get())-\/>\_blocks[0];}
\DoxyCodeLine{2267         out = boost::intrusive\_ptr<UniTensor\_base>(tmp);}
\DoxyCodeLine{2268       \}}
\DoxyCodeLine{2269       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2270     \}}
\DoxyCodeLine{2280     boost::intrusive\_ptr<UniTensor\_base> Trace(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b,}
\DoxyCodeLine{2281                                                \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label) \{}
\DoxyCodeLine{2282       boost::intrusive\_ptr<UniTensor\_base> out = this-\/>clone();}
\DoxyCodeLine{2283       out-\/>Trace\_(a, b, by\_label);}
\DoxyCodeLine{2284       \textcolor{keywordflow}{if}(out-\/>rank()==0)\{}
\DoxyCodeLine{2285         DenseUniTensor *tmp = \textcolor{keyword}{new} DenseUniTensor();}
\DoxyCodeLine{2286         tmp-\/>\_block = ((BlockUniTensor*)out.get())-\/>\_blocks[0];}
\DoxyCodeLine{2287         out = boost::intrusive\_ptr<UniTensor\_base>(tmp);}
\DoxyCodeLine{2288       \}}
\DoxyCodeLine{2289       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2290     \}}
\DoxyCodeLine{2291 }
\DoxyCodeLine{2292     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \mbox{\hyperlink{namespacecytnx_1_1linalg_a9cd2be179860bb4742ebe320fa063680}{Norm}}() \textcolor{keyword}{const};}
\DoxyCodeLine{2293 }
\DoxyCodeLine{2294     \textcolor{keywordtype}{bool} elem\_exists(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator) \textcolor{keyword}{const};}
\DoxyCodeLine{2295 }
\DoxyCodeLine{2296     \textcolor{keyword}{const} Scalar::Sproxy at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator) \textcolor{keyword}{const};}
\DoxyCodeLine{2297     \textcolor{keyword}{const} cytnx\_complex128 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{2298                                           \textcolor{keyword}{const} cytnx\_complex128 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{2299     \textcolor{keyword}{const} cytnx\_complex64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{2300                                          \textcolor{keyword}{const} cytnx\_complex64 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{2301     \textcolor{keyword}{const} cytnx\_double \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{2302                                       \textcolor{keyword}{const} cytnx\_double \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{2303     \textcolor{keyword}{const} cytnx\_float \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{2304                                      \textcolor{keyword}{const} cytnx\_float \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{2305     \textcolor{keyword}{const} cytnx\_uint64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{2306                                       \textcolor{keyword}{const} cytnx\_uint64 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{2307     \textcolor{keyword}{const} cytnx\_int64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{2308                                      \textcolor{keyword}{const} cytnx\_int64 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{2309     \textcolor{keyword}{const} cytnx\_uint32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{2310                                       \textcolor{keyword}{const} cytnx\_uint32 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{2311     \textcolor{keyword}{const} cytnx\_int32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{2312                                      \textcolor{keyword}{const} cytnx\_int32 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{2313     \textcolor{keyword}{const} cytnx\_uint16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{2314                                       \textcolor{keyword}{const} cytnx\_uint16 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{2315     \textcolor{keyword}{const} cytnx\_int16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{2316                                      \textcolor{keyword}{const} cytnx\_int16 \&aux) \textcolor{keyword}{const};}
\DoxyCodeLine{2317 }
\DoxyCodeLine{2318     Scalar::Sproxy at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator);}
\DoxyCodeLine{2319     cytnx\_complex128 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{2320                                     \textcolor{keyword}{const} cytnx\_complex128 \&aux);}
\DoxyCodeLine{2321     cytnx\_complex64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator,}
\DoxyCodeLine{2322                                    \textcolor{keyword}{const} cytnx\_complex64 \&aux);}
\DoxyCodeLine{2323     cytnx\_double \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_double \&aux);}
\DoxyCodeLine{2324     cytnx\_float \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_float \&aux);}
\DoxyCodeLine{2325     cytnx\_uint64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_uint64 \&aux);}
\DoxyCodeLine{2326     cytnx\_int64 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_int64 \&aux);}
\DoxyCodeLine{2327     cytnx\_uint32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_uint32 \&aux);}
\DoxyCodeLine{2328     cytnx\_int32 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_int32 \&aux);}
\DoxyCodeLine{2329     cytnx\_uint16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_uint16 \&aux);}
\DoxyCodeLine{2330     cytnx\_int16 \&at\_for\_sparse(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} cytnx\_int16 \&aux);}
\DoxyCodeLine{2331 }
\DoxyCodeLine{2332     \textcolor{keywordtype}{void} \_save\_dispatch(std::fstream \&f) \textcolor{keyword}{const};}
\DoxyCodeLine{2333     \textcolor{keywordtype}{void} \_load\_dispatch(std::fstream \&f);}
\DoxyCodeLine{2334 }
\DoxyCodeLine{2335     \textcolor{comment}{// this will remove the [q\_index]-\/th qnum at [bond\_idx]-\/th Bond! }}
\DoxyCodeLine{2336     \textcolor{keywordtype}{void} truncate\_(\textcolor{keyword}{const} cytnx\_int64 \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&q\_index,}
\DoxyCodeLine{2337                            \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{2338     \textcolor{keywordtype}{void} truncate\_(\textcolor{keyword}{const} std::string \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&q\_index);}
\DoxyCodeLine{2339     \textcolor{keywordtype}{void} truncate\_(\textcolor{keyword}{const} cytnx\_int64 \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&q\_index);}
\DoxyCodeLine{2340 }
\DoxyCodeLine{2341 }
\DoxyCodeLine{2342     \textcolor{keywordtype}{void} Add\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{2343     \textcolor{keywordtype}{void} Add\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs)\{}
\DoxyCodeLine{2344         cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR] cannot perform elementwise arithmetic '+' btwn Scalar and BlockUniTensor.\(\backslash\)n \%s \(\backslash\)n"{}},}
\DoxyCodeLine{2345                     \textcolor{stringliteral}{"{}This operation will destroy block structure. [Suggest] using get/set\_block(s) to do operation on the block(s)."{}});}
\DoxyCodeLine{2346     \}}
\DoxyCodeLine{2347 }
\DoxyCodeLine{2348     \textcolor{keywordtype}{void} Mul\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{2349     \textcolor{keywordtype}{void} Mul\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{2350 }
\DoxyCodeLine{2351     \textcolor{keywordtype}{void} Sub\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs);}
\DoxyCodeLine{2352     \textcolor{keywordtype}{void} Sub\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs)\{}
\DoxyCodeLine{2353         cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR] cannot perform elementwise arithmetic '+' btwn Scalar and BlockUniTensor.\(\backslash\)n \%s \(\backslash\)n"{}},}
\DoxyCodeLine{2354                     \textcolor{stringliteral}{"{}This operation will destroy block structure. [Suggest] using get/set\_block(s) to do operation on the block(s)."{}});}
\DoxyCodeLine{2355     \}}
\DoxyCodeLine{2356     \textcolor{keywordtype}{void} lSub\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&lhs)\{}
\DoxyCodeLine{2357         cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR] cannot perform elementwise arithmetic '+' btwn Scalar and BlockUniTensor.\(\backslash\)n \%s \(\backslash\)n"{}},}
\DoxyCodeLine{2358                     \textcolor{stringliteral}{"{}This operation will destroy block structure. [Suggest] using get/set\_block(s) to do operation on the block(s)."{}});}
\DoxyCodeLine{2359     \}}
\DoxyCodeLine{2360 }
\DoxyCodeLine{2361     \textcolor{keywordtype}{void} Div\_(\textcolor{keyword}{const} boost::intrusive\_ptr<UniTensor\_base> \&rhs)\{}
\DoxyCodeLine{2362         cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR] cannot perform elementwise arithmetic '+' btwn Scalar and BlockUniTensor.\(\backslash\)n \%s \(\backslash\)n"{}},}
\DoxyCodeLine{2363                     \textcolor{stringliteral}{"{}This operation will destroy block structure. [Suggest] using get/set\_block(s) to do operation on the block(s)."{}});}
\DoxyCodeLine{2364 }
\DoxyCodeLine{2365     \}}
\DoxyCodeLine{2366     \textcolor{keywordtype}{void} Div\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs);}
\DoxyCodeLine{2367     \textcolor{keywordtype}{void} lDiv\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&lhs)\{}
\DoxyCodeLine{2368         cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR] cannot perform elementwise arithmetic '+' btwn Scalar and BlockUniTensor.\(\backslash\)n \%s \(\backslash\)n"{}},}
\DoxyCodeLine{2369                     \textcolor{stringliteral}{"{}This operation will destroy block structure. [Suggest] using get/set\_block(s) to do operation on the block(s)."{}});}
\DoxyCodeLine{2370     \}}
\DoxyCodeLine{2371 }
\DoxyCodeLine{2372     \textcolor{keywordtype}{void} group\_basis\_();}
\DoxyCodeLine{2373     }
\DoxyCodeLine{2374     \textcolor{keywordtype}{void} combineBonds(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&indicators,}
\DoxyCodeLine{2375                               \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{false});}
\DoxyCodeLine{2376     \textcolor{keywordtype}{void} combineBonds(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&indicators, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force,}
\DoxyCodeLine{2377                               \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label);}
\DoxyCodeLine{2378     \textcolor{keywordtype}{void} combineBonds(\textcolor{keyword}{const} std::vector<std::string> \&indicators,}
\DoxyCodeLine{2379                               \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{false});}
\DoxyCodeLine{2380 }
\DoxyCodeLine{2381     \textcolor{keyword}{const} std::vector<cytnx\_uint64>\& get\_qindices(\textcolor{keyword}{const} cytnx\_uint64 \&bidx)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{2382         cytnx\_error\_msg(bidx>=this-\/>Nblocks(),\textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] bidx out of bound! only \%d blocks in current UTen.\(\backslash\)n"{}},this-\/>Nblocks());}
\DoxyCodeLine{2383         \textcolor{keywordflow}{return} this-\/>\_inner\_to\_outer\_idx[bidx];}
\DoxyCodeLine{2384     \}}
\DoxyCodeLine{2385     std::vector<cytnx\_uint64>\& get\_qindices(\textcolor{keyword}{const} cytnx\_uint64 \&bidx)\{}
\DoxyCodeLine{2386         cytnx\_error\_msg(bidx>=this-\/>Nblocks(),\textcolor{stringliteral}{"{}[ERROR][BlockUniTensor] bidx out of bound! only \%d blocks in current UTen.\(\backslash\)n"{}},this-\/>Nblocks());}
\DoxyCodeLine{2387         \textcolor{keywordflow}{return} this-\/>\_inner\_to\_outer\_idx[bidx];}
\DoxyCodeLine{2388     \}}
\DoxyCodeLine{2389 }
\DoxyCodeLine{2390     \textcolor{keyword}{const} vec2d<cytnx\_uint64> \& get\_itoi()\textcolor{keyword}{ const}\{}
\DoxyCodeLine{2391         \textcolor{keywordflow}{return} this-\/>\_inner\_to\_outer\_idx;}
\DoxyCodeLine{2392     \}}
\DoxyCodeLine{2393     vec2d<cytnx\_uint64> \& get\_itoi()\{}
\DoxyCodeLine{2394         \textcolor{keywordflow}{return} this-\/>\_inner\_to\_outer\_idx;}
\DoxyCodeLine{2395     \}}
\DoxyCodeLine{2396 }
\DoxyCodeLine{2397 }
\DoxyCodeLine{2398 }
\DoxyCodeLine{2399   \};}
\DoxyCodeLine{2401   \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{2402 }
\DoxyCodeLine{2404   \textcolor{keyword}{class }\mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \{}
\DoxyCodeLine{2405    \textcolor{keyword}{public}:}
\DoxyCodeLine{2407     boost::intrusive\_ptr<UniTensor\_base> \_impl;}
\DoxyCodeLine{2408     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}}() : \_impl(\textcolor{keyword}{new} UniTensor\_base())\{\};}
\DoxyCodeLine{2409     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \{ this-\/>\_impl = rhs.\_impl; \}}
\DoxyCodeLine{2410     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \{}
\DoxyCodeLine{2411       this-\/>\_impl = rhs.\_impl;}
\DoxyCodeLine{2412       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2413     \}}
\DoxyCodeLine{2415 }
\DoxyCodeLine{2417 }
\DoxyCodeLine{2443     \textcolor{keyword}{explicit} \mbox{\hyperlink{classcytnx_1_1UniTensor_a3908e5f31c276031e4a9bdf3539b3fbd}{UniTensor}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in\_tensor, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false},}
\DoxyCodeLine{2444                        \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1)}
\DoxyCodeLine{2445         : \_impl(new UniTensor\_base()) \{}
\DoxyCodeLine{2446       this-\/>Init(in\_tensor, is\_diag, rowrank);}
\DoxyCodeLine{2447     \}}
\DoxyCodeLine{2448     \textcolor{keywordtype}{void} Init(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in\_tensor, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false},}
\DoxyCodeLine{2449               \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1) \{}
\DoxyCodeLine{2450       \textcolor{comment}{//std::cout << "{}[entry!]"{} << std::endl;}}
\DoxyCodeLine{2451       boost::intrusive\_ptr<UniTensor\_base> out(\textcolor{keyword}{new} DenseUniTensor());}
\DoxyCodeLine{2452       out-\/>Init\_by\_Tensor(in\_tensor, is\_diag, rowrank);}
\DoxyCodeLine{2453       this-\/>\_impl = out;}
\DoxyCodeLine{2454     \}}
\DoxyCodeLine{2456 }
\DoxyCodeLine{2458 }
\DoxyCodeLine{2476     \mbox{\hyperlink{classcytnx_1_1UniTensor_ade54cebf78868bc7dcc17bfcbad064f6}{UniTensor}}(\textcolor{keyword}{const} std::vector<Bond> \&bonds, \textcolor{keyword}{const} std::vector<std::string> \&in\_labels = \{\},}
\DoxyCodeLine{2477               \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype = Type.Double,}
\DoxyCodeLine{2478               \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device = Device.cpu, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false})}
\DoxyCodeLine{2479         : \_impl(\textcolor{keyword}{new} UniTensor\_base()) \{}
\DoxyCodeLine{2480 \textcolor{preprocessor}{\#ifdef UNI\_DEBUG}}
\DoxyCodeLine{2481       cytnx\_warning\_msg(}
\DoxyCodeLine{2482         \textcolor{keyword}{true},}
\DoxyCodeLine{2483         \textcolor{stringliteral}{"{}[DEBUG] message: entry for UniTensor(const std::vector<Bond> \&bonds, const "{}}}
\DoxyCodeLine{2484         \textcolor{stringliteral}{"{}std::vector<std::string> \&in\_labels=\{\}, const cytnx\_int64 \&rowrank=-\/1, const unsigned int "{}}}
\DoxyCodeLine{2485         \textcolor{stringliteral}{"{}\&dtype=Type.Double, const int \&device = Device.cpu, const bool \&is\_diag=false)\%s"{}},}
\DoxyCodeLine{2486         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2487 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2488       this-\/>Init(bonds, in\_labels, rowrank, dtype, device, is\_diag);}
\DoxyCodeLine{2489     \}}
\DoxyCodeLine{2502     \mbox{\hyperlink{classcytnx_1_1UniTensor_acf1e438ccbcdc15802f097a5082e015e}{UniTensor}}(\textcolor{keyword}{const} std::vector<Bond> \&bonds, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&in\_labels,}
\DoxyCodeLine{2503               \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype = Type.Double,}
\DoxyCodeLine{2504               \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device = Device.cpu, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false})}
\DoxyCodeLine{2505         : \_impl(new UniTensor\_base()) \{}
\DoxyCodeLine{2506 \textcolor{preprocessor}{\#ifdef UNI\_DEBUG}}
\DoxyCodeLine{2507       cytnx\_warning\_msg(}
\DoxyCodeLine{2508         \textcolor{keyword}{true},}
\DoxyCodeLine{2509         \textcolor{stringliteral}{"{}[DEBUG] message: entry for UniTensor(const std::vector<Bond> \&bonds, const "{}}}
\DoxyCodeLine{2510         \textcolor{stringliteral}{"{}std::vector<cytnx\_int64> \&in\_labels=\{\}, const cytnx\_int64 \&rowrank=-\/1, const unsigned int "{}}}
\DoxyCodeLine{2511         \textcolor{stringliteral}{"{}\&dtype=Type.Double, const int \&device = Device.cpu, const bool \&is\_diag=false)\%s"{}},}
\DoxyCodeLine{2512         \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2513 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2514       std::vector<std::string> vs;}
\DoxyCodeLine{2515       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < (int)in\_labels.size(); i++) vs.push\_back(std::to\_string(in\_labels[i]));}
\DoxyCodeLine{2516       this-\/>Init(bonds, vs, rowrank, dtype, device, is\_diag);}
\DoxyCodeLine{2517     \}}
\DoxyCodeLine{2518     \textcolor{keywordtype}{void} Init(\textcolor{keyword}{const} std::vector<Bond> \&bonds, \textcolor{keyword}{const} std::vector<std::string> \&in\_labels = \{\},}
\DoxyCodeLine{2519               \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype = Type.Double,}
\DoxyCodeLine{2520               \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device = Device.cpu, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{2521       \textcolor{comment}{// checking type:}}
\DoxyCodeLine{2522       \textcolor{keywordtype}{bool} is\_sym = \textcolor{keyword}{false};}
\DoxyCodeLine{2523       \textcolor{keywordtype}{int} sym\_fver = -\/1;}
\DoxyCodeLine{2524 }
\DoxyCodeLine{2525       \textcolor{keywordflow}{for} (cytnx\_uint64 i = 0; i < bonds.size(); i++) \{}
\DoxyCodeLine{2526         \textcolor{comment}{// check}}
\DoxyCodeLine{2527         \textcolor{keywordflow}{if} (bonds[i].syms().size() != 0)\{}
\DoxyCodeLine{2528           is\_sym = \textcolor{keyword}{true};}
\DoxyCodeLine{2529           \textcolor{keywordflow}{if}(sym\_fver == -\/1) sym\_fver = bonds[i].\_impl-\/>\_degs.size();}
\DoxyCodeLine{2530           \textcolor{keywordflow}{else}\{ }
\DoxyCodeLine{2531             \textcolor{comment}{//std::cout << sym\_fver << "{} "{} <<}}
\DoxyCodeLine{2532             \textcolor{comment}{//bonds[i].\_impl-\/>\_degs.size() << std::endl;}}
\DoxyCodeLine{2533             cytnx\_error\_msg((\textcolor{keywordtype}{bool}(sym\_fver)\string^\textcolor{keywordtype}{bool}(bonds[i].\_impl-\/>\_degs.size())), \textcolor{stringliteral}{"{}[ERROR] All the Bond when init a UniTensor with symmetric must be in the same format!\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2534           \}}
\DoxyCodeLine{2535         \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{2536           cytnx\_error\_msg(}
\DoxyCodeLine{2537             is\_sym, \textcolor{stringliteral}{"{}[ERROR] cannot have bonds with mixing of symmetry and non-\/symmetry.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2538       \}}
\DoxyCodeLine{2539 }
\DoxyCodeLine{2540       \textcolor{comment}{// dynamical dispatch:}}
\DoxyCodeLine{2541       \textcolor{keywordflow}{if} (is\_sym) \{}
\DoxyCodeLine{2542 \textcolor{preprocessor}{\#ifdef UNI\_DEBUG}}
\DoxyCodeLine{2543         cytnx\_warning\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[DEBUG] message: entry dispatch: UniTensor: symmetric\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2544 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{2545         \textcolor{comment}{// cytnx\_warning\_msg(true,"{}[warning, still developing, some functions will display}}
\DoxyCodeLine{2546         \textcolor{comment}{// \(\backslash\)"{}[Developing]\(\backslash\)"{}][SparseUniTensor]\%s"{},"{}\(\backslash\)n"{});}}
\DoxyCodeLine{2547         \textcolor{keywordflow}{if}(sym\_fver == 0)\{}
\DoxyCodeLine{2548             boost::intrusive\_ptr<UniTensor\_base> out(\textcolor{keyword}{new} SparseUniTensor());}
\DoxyCodeLine{2549             this-\/>\_impl = out;}
\DoxyCodeLine{2550         \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(sym\_fver==-\/1)\{}
\DoxyCodeLine{2551             cytnx\_error\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[ERROR] internal error! the Bond is symmetry but the version is not properly determined!\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2552         \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{2553             boost::intrusive\_ptr<UniTensor\_base> out(\textcolor{keyword}{new} BlockUniTensor());}
\DoxyCodeLine{2554             this-\/>\_impl = out;}
\DoxyCodeLine{2555         \}}
\DoxyCodeLine{2556       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2557         boost::intrusive\_ptr<UniTensor\_base> out(\textcolor{keyword}{new} DenseUniTensor());}
\DoxyCodeLine{2558         this-\/>\_impl = out;}
\DoxyCodeLine{2559       \}}
\DoxyCodeLine{2560       this-\/>\_impl-\/>Init(bonds, in\_labels, rowrank, dtype, device, is\_diag, \textcolor{keyword}{false});}
\DoxyCodeLine{2561     \}}
\DoxyCodeLine{2574     \textcolor{keywordtype}{void} \mbox{\hyperlink{classcytnx_1_1UniTensor_af88d05dc8c534accadc7d894dc691d1b}{Init}}(\textcolor{keyword}{const} std::vector<Bond> \&bonds, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&in\_labels,}
\DoxyCodeLine{2575               \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype = Type.Double,}
\DoxyCodeLine{2576               \textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device = Device.cpu, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_diag = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{2577       std::vector<std::string> vs;}
\DoxyCodeLine{2578       cytnx\_warning\_msg(\textcolor{keyword}{true},\textcolor{stringliteral}{"{}[Deprecated warning] specify label with integers will be depreated soon. use string instead.\%s"{}},\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2579       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < (int)in\_labels.size(); i++) vs.push\_back(std::to\_string(in\_labels[i]));}
\DoxyCodeLine{2580       this-\/>Init(bonds, vs, rowrank, dtype, device, is\_diag);}
\DoxyCodeLine{2581     \}}
\DoxyCodeLine{2582 }
\DoxyCodeLine{2584 }
\DoxyCodeLine{2590     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a9ea55737e39a8d81f4e90a81fd47692d}{set\_name}}(\textcolor{keyword}{const} std::string \&in) \{}
\DoxyCodeLine{2591       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a9ea55737e39a8d81f4e90a81fd47692d}{set\_name}}(in);}
\DoxyCodeLine{2592       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2593     \}}
\DoxyCodeLine{2605     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a87b35b1dab8103b195f83fef23fa16ea}{set\_label}}(\textcolor{keyword}{const} cytnx\_int64 \&idx, \textcolor{keyword}{const} cytnx\_int64 \&new\_label,}
\DoxyCodeLine{2606                          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label) \{}
\DoxyCodeLine{2607       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a87b35b1dab8103b195f83fef23fa16ea}{set\_label}}(idx, new\_label, by\_label);}
\DoxyCodeLine{2608       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2609     \}}
\DoxyCodeLine{2621     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a0fa37d97d1501ab1c13486d9faa6286d}{set\_label}}(\textcolor{keyword}{const} cytnx\_int64 \&idx, \textcolor{keyword}{const} cytnx\_int64 \&new\_label) \{}
\DoxyCodeLine{2622       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a87b35b1dab8103b195f83fef23fa16ea}{set\_label}}(idx, new\_label);}
\DoxyCodeLine{2623       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2624     \}}
\DoxyCodeLine{2635     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a6e81820a5c1de5e398ccff44ae3cb3a5}{set\_label}}(\textcolor{keyword}{const} cytnx\_int64 \&idx, \textcolor{keyword}{const} std::string \&new\_label) \{}
\DoxyCodeLine{2636       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a87b35b1dab8103b195f83fef23fa16ea}{set\_label}}(idx, new\_label);}
\DoxyCodeLine{2637       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2638     \}}
\DoxyCodeLine{2639 }
\DoxyCodeLine{2640     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a87b35b1dab8103b195f83fef23fa16ea}{set\_label}}(\textcolor{keyword}{const} cytnx\_int64 \&idx, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* new\_label)\{}
\DoxyCodeLine{2641       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a87b35b1dab8103b195f83fef23fa16ea}{set\_label}}(idx, std::string(new\_label));}
\DoxyCodeLine{2642       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2643     \}}
\DoxyCodeLine{2644 }
\DoxyCodeLine{2655     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a32f8c1ca6d2e782c2fd1a443df4884fa}{set\_label}}(\textcolor{keyword}{const} std::string \&old\_label, \textcolor{keyword}{const} std::string \&new\_label) \{}
\DoxyCodeLine{2656       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a87b35b1dab8103b195f83fef23fa16ea}{set\_label}}(old\_label, new\_label);}
\DoxyCodeLine{2657       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2658     \}}
\DoxyCodeLine{2659 }
\DoxyCodeLine{2660     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a87b35b1dab8103b195f83fef23fa16ea}{set\_label}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* old\_label, \textcolor{keyword}{const} std::string \&new\_label) \{}
\DoxyCodeLine{2661       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a87b35b1dab8103b195f83fef23fa16ea}{set\_label}}(std::string(old\_label), new\_label);}
\DoxyCodeLine{2662       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2663     \}}
\DoxyCodeLine{2664  }
\DoxyCodeLine{2665     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a87b35b1dab8103b195f83fef23fa16ea}{set\_label}}(\textcolor{keyword}{const} std::string \&old\_label, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* new\_label) \{}
\DoxyCodeLine{2666       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a87b35b1dab8103b195f83fef23fa16ea}{set\_label}}(old\_label, std::string(new\_label));}
\DoxyCodeLine{2667       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2668     \}}
\DoxyCodeLine{2669 }
\DoxyCodeLine{2670     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a87b35b1dab8103b195f83fef23fa16ea}{set\_label}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* old\_label, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* new\_label) \{}
\DoxyCodeLine{2671       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a87b35b1dab8103b195f83fef23fa16ea}{set\_label}}(std::string(old\_label), std::string(new\_label));}
\DoxyCodeLine{2672       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2673     \}}
\DoxyCodeLine{2674 }
\DoxyCodeLine{2675 }
\DoxyCodeLine{2686     \textcolor{comment}{/*}}
\DoxyCodeLine{2687 \textcolor{comment}{    UniTensor\& change\_label(const cytnx\_int64 \&old\_lbl, const cytnx\_int64 \&new\_label)\{}}
\DoxyCodeLine{2688 \textcolor{comment}{        this-\/>\_impl-\/>change\_label(old\_lbl,new\_label);}}
\DoxyCodeLine{2689 \textcolor{comment}{        return *this;}}
\DoxyCodeLine{2690 \textcolor{comment}{    \}}}
\DoxyCodeLine{2691 \textcolor{comment}{    */}}
\DoxyCodeLine{2692 }
\DoxyCodeLine{2703     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a8223345c1161d4ffd52ea8276f54a32a}{set\_labels}}(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_labels) \{}
\DoxyCodeLine{2704       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a8223345c1161d4ffd52ea8276f54a32a}{set\_labels}}(new\_labels);}
\DoxyCodeLine{2705       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2706     \}}
\DoxyCodeLine{2716     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a54712d4aedcfe01324bd7d4aa042cf8c}{set\_labels}}(\textcolor{keyword}{const} std::vector<std::string> \&new\_labels) \{}
\DoxyCodeLine{2717       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a8223345c1161d4ffd52ea8276f54a32a}{set\_labels}}(new\_labels);}
\DoxyCodeLine{2718       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2719     \}}
\DoxyCodeLine{2720     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a8223345c1161d4ffd52ea8276f54a32a}{set\_labels}}(\textcolor{keyword}{const} std::initializer\_list<char*> \&new\_labels) \{}
\DoxyCodeLine{2721       std::vector<char*> new\_lbls(new\_labels);}
\DoxyCodeLine{2722       std::vector<std::string> vs(new\_lbls.size());}
\DoxyCodeLine{2723       transform(new\_lbls.begin(),new\_lbls.end(), vs.begin(),[](\textcolor{keywordtype}{char} * x) -\/> std::string \{ return std::string(x); \});}
\DoxyCodeLine{2724  }
\DoxyCodeLine{2725       this-\/>\_impl-\/>set\_labels(vs);}
\DoxyCodeLine{2726       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2727     \}}
\DoxyCodeLine{2728 }
\DoxyCodeLine{2729     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&set\_rowrank(\textcolor{keyword}{const} cytnx\_uint64 \&new\_rowrank) \{}
\DoxyCodeLine{2730       this-\/>\_impl-\/>set\_rowrank(new\_rowrank);}
\DoxyCodeLine{2731       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{2732     \}}
\DoxyCodeLine{2733 }
\DoxyCodeLine{2734     \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{2735     T \&item() \{}
\DoxyCodeLine{2736       cytnx\_error\_msg(this-\/>is\_blockform(),}
\DoxyCodeLine{2737                       \textcolor{stringliteral}{"{}[ERROR] cannot use item on UniTensor with Symmetry.\(\backslash\)n suggestion: use "{}}}
\DoxyCodeLine{2738                       \textcolor{stringliteral}{"{}get\_block()/get\_blocks() first.\%s"{}},}
\DoxyCodeLine{2739                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2740 }
\DoxyCodeLine{2741       DenseUniTensor *tmp = \textcolor{keyword}{static\_cast<}DenseUniTensor *\textcolor{keyword}{>}(this-\/>\_impl.get());}
\DoxyCodeLine{2742       \textcolor{keywordflow}{return} tmp-\/>\_block.item<T>();}
\DoxyCodeLine{2743     \}}
\DoxyCodeLine{2744 }
\DoxyCodeLine{2745     Scalar::Sproxy item()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2746       cytnx\_error\_msg(this-\/>is\_blockform(),}
\DoxyCodeLine{2747                       \textcolor{stringliteral}{"{}[ERROR] cannot use item on UniTensor with Symmetry.\(\backslash\)n suggestion: use "{}}}
\DoxyCodeLine{2748                       \textcolor{stringliteral}{"{}get\_block()/get\_blocks() first.\%s"{}},}
\DoxyCodeLine{2749                       \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2750 }
\DoxyCodeLine{2751       DenseUniTensor *tmp = \textcolor{keyword}{static\_cast<}DenseUniTensor *\textcolor{keyword}{>}(this-\/>\_impl.get());}
\DoxyCodeLine{2752       \textcolor{keywordflow}{return} tmp-\/>\_block.item();}
\DoxyCodeLine{2753     \}}
\DoxyCodeLine{2754 }
\DoxyCodeLine{2755     cytnx\_uint64 Nblocks()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>Nblocks(); \}}
\DoxyCodeLine{2756     cytnx\_uint64 rank()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>rank(); \}}
\DoxyCodeLine{2757     cytnx\_uint64 rowrank()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>rowrank(); \}}
\DoxyCodeLine{2758     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} dtype()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>dtype(); \}}
\DoxyCodeLine{2759     \textcolor{keywordtype}{int} uten\_type()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>uten\_type(); \}}
\DoxyCodeLine{2760     \textcolor{keywordtype}{int} device()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>device(); \}}
\DoxyCodeLine{2761     std::string name()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>name(); \}}
\DoxyCodeLine{2762     std::string dtype\_str()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>dtype\_str(); \}}
\DoxyCodeLine{2763     std::string device\_str()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>device\_str(); \}}
\DoxyCodeLine{2764     std::string uten\_type\_str()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>uten\_type\_str(); \}}
\DoxyCodeLine{2765     \textcolor{keywordtype}{bool} is\_contiguous()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>is\_contiguous(); \}}
\DoxyCodeLine{2766     \textcolor{keywordtype}{bool} is\_diag()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>is\_diag(); \}}
\DoxyCodeLine{2767     \textcolor{keywordtype}{bool} is\_tag()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>is\_tag(); \}}
\DoxyCodeLine{2768     std::vector<Symmetry> syms()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>syms(); \}}
\DoxyCodeLine{2769     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&is\_braket\_form()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>is\_braket\_form(); \}}
\DoxyCodeLine{2770     \textcolor{keyword}{const} std::vector<std::string> \&labels()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>labels(); \}}
\DoxyCodeLine{2777     cytnx\_int64 \mbox{\hyperlink{classcytnx_1_1UniTensor_a1c7a9eebcb74305bbf42e57d667086d8}{get\_index}}(std::string lbl)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_index(lbl); \}}
\DoxyCodeLine{2778     \textcolor{keyword}{const} std::vector<Bond> \&bonds()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>bonds(); \}}
\DoxyCodeLine{2779     std::vector<Bond> \&bonds() \{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>bonds(); \}}
\DoxyCodeLine{2780     std::vector<cytnx\_uint64> shape()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>shape(); \}}
\DoxyCodeLine{2781     \textcolor{keywordtype}{bool} is\_blockform()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>is\_blockform(); \}}
\DoxyCodeLine{2782 }
\DoxyCodeLine{2783     \textcolor{keywordtype}{void} to\_(\textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device) \{ this-\/>\_impl-\/>to\_(device); \}}
\DoxyCodeLine{2784     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} to(\textcolor{keyword}{const} \textcolor{keywordtype}{int} \&device)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2785       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{2786       out.\_impl = this-\/>\_impl-\/>to(device);}
\DoxyCodeLine{2787       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2788     \}}
\DoxyCodeLine{2789     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} clone()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2790       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{2791       out.\_impl = this-\/>\_impl-\/>clone();}
\DoxyCodeLine{2792       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2793     \}}
\DoxyCodeLine{2802     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \mbox{\hyperlink{classcytnx_1_1UniTensor_a04977b5c16428f35abeefbc7b3e235e1}{relabels}}(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_labels)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2803       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{2804       out.\_impl = this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a04977b5c16428f35abeefbc7b3e235e1}{relabels}}(new\_labels);}
\DoxyCodeLine{2805       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2806     \}}
\DoxyCodeLine{2807     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \mbox{\hyperlink{classcytnx_1_1UniTensor_a04977b5c16428f35abeefbc7b3e235e1}{relabels}}(\textcolor{keyword}{const} std::vector<std::string> \&new\_labels)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2808       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{2809       out.\_impl = this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a04977b5c16428f35abeefbc7b3e235e1}{relabels}}(new\_labels);}
\DoxyCodeLine{2810       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2811     \}}
\DoxyCodeLine{2812     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \mbox{\hyperlink{classcytnx_1_1UniTensor_a04977b5c16428f35abeefbc7b3e235e1}{relabels}}(\textcolor{keyword}{const} std::initializer\_list<char*> \&new\_lbls)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{2813         std::vector<char*> new\_labels(new\_lbls);}
\DoxyCodeLine{2814         std::vector<std::string> vs(new\_labels.size());}
\DoxyCodeLine{2815         transform(new\_labels.begin(),new\_labels.end(), vs.begin(),[](\textcolor{keywordtype}{char} * x) -\/> std::string \{ return std::string(x); \});}
\DoxyCodeLine{2816         \textcolor{comment}{//std::cout << new\_labels.size() << std::endl;}}
\DoxyCodeLine{2817         \textcolor{comment}{//std::cout << vs << std::endl;}}
\DoxyCodeLine{2818 }
\DoxyCodeLine{2819         \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{2820         out.\_impl =  this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a04977b5c16428f35abeefbc7b3e235e1}{relabels}}(vs);}
\DoxyCodeLine{2821         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2822     \}}
\DoxyCodeLine{2823 }
\DoxyCodeLine{2834     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \mbox{\hyperlink{classcytnx_1_1UniTensor_a497ff915bf717edacbc5a8813393eb3d}{relabel}}(\textcolor{keyword}{const} cytnx\_int64 \&inx, \textcolor{keyword}{const} cytnx\_int64 \&new\_label,}
\DoxyCodeLine{2835                       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label=\textcolor{keyword}{false})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2836       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{2837       out.\_impl = this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a497ff915bf717edacbc5a8813393eb3d}{relabel}}(inx, new\_label, by\_label);}
\DoxyCodeLine{2838       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2839     \}}
\DoxyCodeLine{2840     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \mbox{\hyperlink{classcytnx_1_1UniTensor_a497ff915bf717edacbc5a8813393eb3d}{relabel}}(\textcolor{keyword}{const} cytnx\_int64 \&inx, \textcolor{keyword}{const} std::string \&new\_label)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2841       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{2842       out.\_impl = this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a497ff915bf717edacbc5a8813393eb3d}{relabel}}(inx, new\_label);}
\DoxyCodeLine{2843       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2844     \}}
\DoxyCodeLine{2845     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \mbox{\hyperlink{classcytnx_1_1UniTensor_a497ff915bf717edacbc5a8813393eb3d}{relabel}}(\textcolor{keyword}{const} std::string \&old\_label, \textcolor{keyword}{const} std::string \&new\_label)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2846       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{2847       out.\_impl = this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a497ff915bf717edacbc5a8813393eb3d}{relabel}}(old\_label, new\_label);}
\DoxyCodeLine{2848       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2849     \}}
\DoxyCodeLine{2850 }
\DoxyCodeLine{2851     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} astype(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&dtype)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2852       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{2853       \textcolor{keywordflow}{if} (this-\/>dtype() == dtype) \{}
\DoxyCodeLine{2854         out.\_impl = this-\/>\_impl;}
\DoxyCodeLine{2855       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2856         out.\_impl = this-\/>\_impl-\/>astype(dtype);}
\DoxyCodeLine{2857       \}}
\DoxyCodeLine{2858       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2859     \}}
\DoxyCodeLine{2870     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \mbox{\hyperlink{classcytnx_1_1UniTensor_a21b20022105038b58f97a3770fdef97b}{permute}}(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank=-\/1,}
\DoxyCodeLine{2871                       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label=\textcolor{keyword}{false}) \{}
\DoxyCodeLine{2872       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{2873       out.\_impl = this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a21b20022105038b58f97a3770fdef97b}{permute}}(mapper, rowrank, by\_label);}
\DoxyCodeLine{2874       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2875     \}}
\DoxyCodeLine{2876     \textcolor{comment}{//UniTensor permute(const std::vector<cytnx\_int64> \&mapper, const cytnx\_int64 \&rowrank = -\/1) \{}}
\DoxyCodeLine{2877     \textcolor{comment}{//  UniTensor out;}}
\DoxyCodeLine{2878     \textcolor{comment}{//  out.\_impl = this-\/>\_impl-\/>permute(mapper, rowrank);}}
\DoxyCodeLine{2879     \textcolor{comment}{//  return out;}}
\DoxyCodeLine{2880     \textcolor{comment}{//\}}}
\DoxyCodeLine{2881     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \mbox{\hyperlink{classcytnx_1_1UniTensor_a21b20022105038b58f97a3770fdef97b}{permute}}(\textcolor{keyword}{const} std::vector<std::string> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1) \{}
\DoxyCodeLine{2882       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{2883       out.\_impl = this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a21b20022105038b58f97a3770fdef97b}{permute}}(mapper, rowrank);}
\DoxyCodeLine{2884       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2885     \}}
\DoxyCodeLine{2886     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \mbox{\hyperlink{classcytnx_1_1UniTensor_a21b20022105038b58f97a3770fdef97b}{permute}}( \textcolor{keyword}{const} std::initializer\_list<char*> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank= -\/1)\{}
\DoxyCodeLine{2887         std::vector<char*> mprs = mapper;}
\DoxyCodeLine{2888         std::vector<std::string> vs(mprs.size());}
\DoxyCodeLine{2889         transform(mprs.begin(),mprs.end(),vs.begin(),[](\textcolor{keywordtype}{char} * x) -\/> std::string \{ return std::string(x); \});}
\DoxyCodeLine{2890 }
\DoxyCodeLine{2891         \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a21b20022105038b58f97a3770fdef97b}{permute}}(vs,rowrank);}
\DoxyCodeLine{2892     \}}
\DoxyCodeLine{2893 }
\DoxyCodeLine{2894     }
\DoxyCodeLine{2895 }
\DoxyCodeLine{2905     \textcolor{keywordtype}{void} \mbox{\hyperlink{classcytnx_1_1UniTensor_af9d72a33b623bf197ede54cb8b9fc866}{permute\_}}(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank=-\/1,}
\DoxyCodeLine{2906                   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label=\textcolor{keyword}{false}) \{}
\DoxyCodeLine{2907       this-\/>\_impl-\/>permute\_(mapper, rowrank, by\_label);}
\DoxyCodeLine{2908     \}}
\DoxyCodeLine{2909     \textcolor{keywordtype}{void} \mbox{\hyperlink{classcytnx_1_1UniTensor_af9d72a33b623bf197ede54cb8b9fc866}{permute\_}}(\textcolor{keyword}{const} std::vector<std::string> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank = -\/1) \{}
\DoxyCodeLine{2910       this-\/>\_impl-\/>permute\_(mapper, rowrank);}
\DoxyCodeLine{2911     \}}
\DoxyCodeLine{2912     \textcolor{keywordtype}{void} \mbox{\hyperlink{classcytnx_1_1UniTensor_af9d72a33b623bf197ede54cb8b9fc866}{permute\_}}( \textcolor{keyword}{const} std::initializer\_list<char*> \&mapper, \textcolor{keyword}{const} cytnx\_int64 \&rowrank= -\/1)\{}
\DoxyCodeLine{2913         std::vector<char*> mprs = mapper;}
\DoxyCodeLine{2914         std::vector<std::string> vs(mprs.size());}
\DoxyCodeLine{2915         transform(mprs.begin(),mprs.end(),vs.begin(),[](\textcolor{keywordtype}{char} * x) -\/> std::string \{ return std::string(x); \});}
\DoxyCodeLine{2916 }
\DoxyCodeLine{2917         this-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_af9d72a33b623bf197ede54cb8b9fc866}{permute\_}}(vs,rowrank);}
\DoxyCodeLine{2918     \}}
\DoxyCodeLine{2919 }
\DoxyCodeLine{2920     \textcolor{comment}{//void permute\_(const std::vector<cytnx\_int64> \&mapper, const cytnx\_int64 \&rowrank = -\/1) \{}}
\DoxyCodeLine{2921     \textcolor{comment}{//  this-\/>\_impl-\/>permute\_(mapper, rowrank);}}
\DoxyCodeLine{2922     \textcolor{comment}{//\}}}
\DoxyCodeLine{2923     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} contiguous()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2924       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{2925       out.\_impl = this-\/>\_impl-\/>contiguous();}
\DoxyCodeLine{2926       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2927     \}}
\DoxyCodeLine{2928     \textcolor{keywordtype}{void} contiguous\_() \{ this-\/>\_impl = this-\/>\_impl-\/>contiguous\_(); \}}
\DoxyCodeLine{2929     \textcolor{keywordtype}{void} print\_diagram(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&bond\_info = \textcolor{keyword}{false}) \{ this-\/>\_impl-\/>print\_diagram(bond\_info); \}}
\DoxyCodeLine{2930     \textcolor{keywordtype}{void} print\_blocks(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&full\_info=\textcolor{keyword}{true})\textcolor{keyword}{ const}\{ this-\/>\_impl-\/>print\_blocks(full\_info); \}}
\DoxyCodeLine{2931     \textcolor{keywordtype}{void} print\_block(\textcolor{keyword}{const} cytnx\_int64 \&idx, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&full\_info=\textcolor{keyword}{true})\textcolor{keyword}{ const}\{this-\/>\_impl-\/>print\_block(idx,full\_info);\}}
\DoxyCodeLine{2932 }
\DoxyCodeLine{2933     \textcolor{keywordtype}{void} group\_basis\_()\{}
\DoxyCodeLine{2934         this-\/>\_impl-\/>group\_basis\_(); }
\DoxyCodeLine{2935     \}}
\DoxyCodeLine{2936 }
\DoxyCodeLine{2937     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} group\_basis()\textcolor{keyword}{ const}\{}
\DoxyCodeLine{2938         \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out = this-\/>clone();}
\DoxyCodeLine{2939         out.group\_basis\_();}
\DoxyCodeLine{2940         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{2941     \}}
\DoxyCodeLine{2942 }
\DoxyCodeLine{2943  }
\DoxyCodeLine{2944     \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{2945     T \&at(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator)\{}
\DoxyCodeLine{2946       \textcolor{comment}{// std::cout << "{}at "{} << this-\/>is\_blockform()  << std::endl;}}
\DoxyCodeLine{2947       \textcolor{keywordflow}{if} (this-\/>uten\_type() ==UTenType.Block)\{}
\DoxyCodeLine{2948         \textcolor{comment}{// [NEW] this will not check if it exists, if it is not then error will throw!}}
\DoxyCodeLine{2949         T aux;}
\DoxyCodeLine{2950         \textcolor{keywordflow}{return} this-\/>\_impl-\/>at\_for\_sparse(locator, aux);}
\DoxyCodeLine{2951 }
\DoxyCodeLine{2952       \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (this-\/>uten\_type() == UTenType.Sparse) \{}
\DoxyCodeLine{2953         \textcolor{keywordflow}{if} (this-\/>\_impl-\/>elem\_exists(locator)) \{}
\DoxyCodeLine{2954           T aux;}
\DoxyCodeLine{2955           \textcolor{keywordflow}{return} this-\/>\_impl-\/>at\_for\_sparse(locator, aux);}
\DoxyCodeLine{2956         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2957           cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] invalid location. break qnum block.\%s"{}},}
\DoxyCodeLine{2958                           \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2959         \}}
\DoxyCodeLine{2960       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2961         \textcolor{keywordflow}{return} this-\/>get\_block\_().\mbox{\hyperlink{classcytnx_1_1Tensor_a55f6e4c4106c0964f23fb06ac63d75ec}{at}}<T>(locator);}
\DoxyCodeLine{2962       \}}
\DoxyCodeLine{2963     \}}
\DoxyCodeLine{2964 }
\DoxyCodeLine{2965     \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{2966     \textcolor{keyword}{const} T \&at(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2967       \textcolor{comment}{// std::cout << "{}at "{} << this-\/>is\_blockform()  << std::endl;}}
\DoxyCodeLine{2968       \textcolor{keywordflow}{if} (this-\/>uten\_type() ==UTenType.Block)\{}
\DoxyCodeLine{2969         \textcolor{comment}{// [NEW] this will not check if it exists, if it is not then error will throw!}}
\DoxyCodeLine{2970         T aux;}
\DoxyCodeLine{2971         \textcolor{keywordflow}{return} this-\/>\_impl-\/>at\_for\_sparse(locator, aux);}
\DoxyCodeLine{2972 }
\DoxyCodeLine{2973       \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (this-\/>uten\_type() == UTenType.Sparse) \{}
\DoxyCodeLine{2974         \textcolor{keywordflow}{if} (this-\/>\_impl-\/>elem\_exists(locator)) \{}
\DoxyCodeLine{2975           T aux;  \textcolor{comment}{// [workaround] use aux to dispatch.}}
\DoxyCodeLine{2976           \textcolor{keywordflow}{return} this-\/>\_impl-\/>at\_for\_sparse(locator, aux);}
\DoxyCodeLine{2977         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2978           cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] invalid location. break qnum block.\%s"{}},}
\DoxyCodeLine{2979                           \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2980         \}}
\DoxyCodeLine{2981       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2982         \textcolor{keywordflow}{return} this-\/>get\_block\_().\mbox{\hyperlink{classcytnx_1_1Tensor_a55f6e4c4106c0964f23fb06ac63d75ec}{at}}<T>(locator);}
\DoxyCodeLine{2983       \}}
\DoxyCodeLine{2984     \}}
\DoxyCodeLine{2985 }
\DoxyCodeLine{2986     \textcolor{keyword}{const} Scalar::Sproxy at(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2987       \textcolor{keywordflow}{if} (this-\/>uten\_type() == UTenType.Block)\{}
\DoxyCodeLine{2988         \textcolor{keywordflow}{return} this-\/>\_impl-\/>at\_for\_sparse(locator);}
\DoxyCodeLine{2989       \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (this-\/>uten\_type() == UTenType.Sparse) \{}
\DoxyCodeLine{2990         \textcolor{keywordflow}{if} (this-\/>\_impl-\/>elem\_exists(locator)) \{}
\DoxyCodeLine{2991           \textcolor{keywordflow}{return} this-\/>\_impl-\/>at\_for\_sparse(locator);}
\DoxyCodeLine{2992         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2993           cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] invalid location. break qnum block.\%s"{}},}
\DoxyCodeLine{2994                           \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{2995         \}}
\DoxyCodeLine{2996       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2997         \textcolor{keywordflow}{return} this-\/>get\_block\_().\mbox{\hyperlink{classcytnx_1_1Tensor_a55f6e4c4106c0964f23fb06ac63d75ec}{at}}(locator);}
\DoxyCodeLine{2998       \}}
\DoxyCodeLine{2999     \}}
\DoxyCodeLine{3000 }
\DoxyCodeLine{3001     Scalar::Sproxy at(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator) \{}
\DoxyCodeLine{3002       \textcolor{keywordflow}{if} (this-\/>uten\_type() == UTenType.Block)\{ }
\DoxyCodeLine{3003         \textcolor{keywordflow}{return} this-\/>\_impl-\/>at\_for\_sparse(locator);}
\DoxyCodeLine{3004       \}\textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (this-\/>uten\_type() == UTenType.Sparse) \{}
\DoxyCodeLine{3005         \textcolor{keywordflow}{if} (this-\/>\_impl-\/>elem\_exists(locator)) \{}
\DoxyCodeLine{3006           \textcolor{keywordflow}{return} this-\/>\_impl-\/>at\_for\_sparse(locator);}
\DoxyCodeLine{3007         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3008           cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][SparseUniTensor] invalid location. break qnum block.\%s"{}},}
\DoxyCodeLine{3009                           \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{3010         \}}
\DoxyCodeLine{3011       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{3012         \textcolor{keywordflow}{return} this-\/>get\_block\_().\mbox{\hyperlink{classcytnx_1_1Tensor_a55f6e4c4106c0964f23fb06ac63d75ec}{at}}(locator);}
\DoxyCodeLine{3013       \}}
\DoxyCodeLine{3014     \}}
\DoxyCodeLine{3015 }
\DoxyCodeLine{3016     \textcolor{comment}{// return a clone of block}}
\DoxyCodeLine{3017     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} get\_block(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_block(idx); \};}
\DoxyCodeLine{3018     \textcolor{comment}{//================================}}
\DoxyCodeLine{3019     \textcolor{comment}{// return a clone of block}}
\DoxyCodeLine{3020     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} get\_block(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{false})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3021       \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_block(qnum, force);}
\DoxyCodeLine{3022     \}}
\DoxyCodeLine{3023     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} get\_block(\textcolor{keyword}{const} std::initializer\_list<cytnx\_int64> \&qnum,}
\DoxyCodeLine{3024                      \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{false})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3025       std::vector<cytnx\_int64> tmp = qnum;}
\DoxyCodeLine{3026       \textcolor{keywordflow}{return} get\_block(tmp, force);}
\DoxyCodeLine{3027     \}}
\DoxyCodeLine{3028     \textcolor{comment}{//================================}}
\DoxyCodeLine{3029     \textcolor{comment}{// this only work for non-\/symm tensor. return a shared view of block}}
\DoxyCodeLine{3030     \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3031       \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_block\_(idx);}
\DoxyCodeLine{3032     \}}
\DoxyCodeLine{3033     \textcolor{comment}{//================================}}
\DoxyCodeLine{3034     \textcolor{comment}{// this only work for non-\/symm tensor. return a shared view of block}}
\DoxyCodeLine{3035     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} cytnx\_uint64 \&idx = 0) \{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_block\_(idx); \}}
\DoxyCodeLine{3036     \textcolor{comment}{//================================}}
\DoxyCodeLine{3037     \textcolor{comment}{// this only work for non-\/symm tensor. return a shared view of block}}
\DoxyCodeLine{3038     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{3039       \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_block\_(qnum, force);}
\DoxyCodeLine{3040     \}}
\DoxyCodeLine{3041     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} std::initializer\_list<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{3042       std::vector<cytnx\_int64> tmp = qnum;}
\DoxyCodeLine{3043       \textcolor{keywordflow}{return} get\_block\_(tmp, force);}
\DoxyCodeLine{3044     \}}
\DoxyCodeLine{3045     \textcolor{comment}{//================================}}
\DoxyCodeLine{3046 }
\DoxyCodeLine{3047     \textcolor{comment}{// this only work for non-\/symm tensor. return a shared view of block}}
\DoxyCodeLine{3048     \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum,}
\DoxyCodeLine{3049                              \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{false})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3050       \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_block\_(qnum, force);}
\DoxyCodeLine{3051     \}}
\DoxyCodeLine{3052     \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&get\_block\_(\textcolor{keyword}{const} std::initializer\_list<cytnx\_int64> \&qnum,}
\DoxyCodeLine{3053                              \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{false})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3054       std::vector<cytnx\_int64> tmp = qnum;}
\DoxyCodeLine{3055       \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_block\_(tmp, force);}
\DoxyCodeLine{3056     \}}
\DoxyCodeLine{3057     \textcolor{comment}{//================================}}
\DoxyCodeLine{3058     \textcolor{comment}{// this return a shared view of blocks for non-\/symm tensor.}}
\DoxyCodeLine{3059     \textcolor{comment}{// for symmetry tensor, it call contiguous first and return a shared view of blocks. [dev]}}
\DoxyCodeLine{3060     std::vector<Tensor> get\_blocks()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_blocks(); \}}
\DoxyCodeLine{3061     \textcolor{comment}{// this return a shared view of blocks for non-\/symm tensor.}}
\DoxyCodeLine{3062     \textcolor{comment}{// for symmetry tensor, it call contiguous first and return a shared view of blocks. [dev]}}
\DoxyCodeLine{3063     \textcolor{keyword}{const} std::vector<Tensor> \&get\_blocks\_(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&silent = \textcolor{keyword}{false})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3064       \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_blocks\_(silent);}
\DoxyCodeLine{3065     \}}
\DoxyCodeLine{3066     \textcolor{comment}{// for symmetry tensor, it call contiguous first and return a shared view of blocks. [dev]}}
\DoxyCodeLine{3067     std::vector<Tensor> \&get\_blocks\_(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&silent = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{3068       \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_blocks\_(silent);}
\DoxyCodeLine{3069     \}}
\DoxyCodeLine{3070 }
\DoxyCodeLine{3071     \textcolor{comment}{// the put block will have shared view with the internal block, i.e. non-\/clone.}}
\DoxyCodeLine{3072     \textcolor{keywordtype}{void} put\_block(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} cytnx\_uint64 \&idx = 0) \{}
\DoxyCodeLine{3073       this-\/>\_impl-\/>put\_block(in, idx);}
\DoxyCodeLine{3074     \}}
\DoxyCodeLine{3075     \textcolor{comment}{// the put block will have shared view with the internal block, i.e. non-\/clone.}}
\DoxyCodeLine{3076     \textcolor{keywordtype}{void} put\_block(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force) \{}
\DoxyCodeLine{3077       this-\/>\_impl-\/>put\_block(in, qnum, force);}
\DoxyCodeLine{3078     \}}
\DoxyCodeLine{3079     \textcolor{comment}{// the put block will have shared view with the internal block, i.e. non-\/clone.}}
\DoxyCodeLine{3080     \textcolor{keywordtype}{void} put\_block\_(\mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} cytnx\_uint64 \&idx = 0) \{ this-\/>\_impl-\/>put\_block\_(in, idx); \}}
\DoxyCodeLine{3081     \textcolor{comment}{// the put block will have shared view with the internal block, i.e. non-\/clone.}}
\DoxyCodeLine{3082     \textcolor{keywordtype}{void} put\_block\_(\mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&in, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&qnum, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force) \{}
\DoxyCodeLine{3083       this-\/>\_impl-\/>put\_block\_(in, qnum, force);}
\DoxyCodeLine{3084     \}}
\DoxyCodeLine{3085     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} get(\textcolor{keyword}{const} std::vector<Accessor> \&accessors)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3086       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{3087       out.\_impl = this-\/>\_impl-\/>get(accessors);}
\DoxyCodeLine{3088       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3089     \}}
\DoxyCodeLine{3090     \textcolor{keywordtype}{void} set(\textcolor{keyword}{const} std::vector<Accessor> \&accessors, \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} \&rhs) \{}
\DoxyCodeLine{3091       this-\/>\_impl-\/>set(accessors, rhs);}
\DoxyCodeLine{3092     \}}
\DoxyCodeLine{3093     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} reshape(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_shape, \textcolor{keyword}{const} cytnx\_uint64 \&rowrank = 0) \{}
\DoxyCodeLine{3094       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{3095       out.\_impl = this-\/>\_impl-\/>reshape(new\_shape, rowrank);}
\DoxyCodeLine{3096       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3097     \}}
\DoxyCodeLine{3098     \textcolor{keywordtype}{void} reshape\_(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&new\_shape, \textcolor{keyword}{const} cytnx\_uint64 \&rowrank = 0) \{}
\DoxyCodeLine{3099       this-\/>\_impl-\/>reshape\_(new\_shape, rowrank);}
\DoxyCodeLine{3100     \}}
\DoxyCodeLine{3101     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} to\_dense() \{}
\DoxyCodeLine{3102       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{3103       out.\_impl = this-\/>\_impl-\/>to\_dense();}
\DoxyCodeLine{3104       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3105     \}}
\DoxyCodeLine{3106     \textcolor{keywordtype}{void} to\_dense\_() \{ this-\/>\_impl-\/>to\_dense\_(); \}}
\DoxyCodeLine{3116     \textcolor{keywordtype}{void} \mbox{\hyperlink{classcytnx_1_1UniTensor_aaadfa8d665c76353ea6eef35d5be976d}{combineBonds}}(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&indicators, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force,}
\DoxyCodeLine{3117                       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label) \{}
\DoxyCodeLine{3118       this-\/>\_impl-\/>combineBonds(indicators, force, by\_label);}
\DoxyCodeLine{3119     \}}
\DoxyCodeLine{3120     \textcolor{keywordtype}{void} \mbox{\hyperlink{classcytnx_1_1UniTensor_aaadfa8d665c76353ea6eef35d5be976d}{combineBonds}}(\textcolor{keyword}{const} std::vector<std::string> \&indicators, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{3121       this-\/>\_impl-\/>combineBonds(indicators, force);}
\DoxyCodeLine{3122     \}}
\DoxyCodeLine{3123     \textcolor{keywordtype}{void} \mbox{\hyperlink{classcytnx_1_1UniTensor_aaadfa8d665c76353ea6eef35d5be976d}{combineBonds}}(\textcolor{keyword}{const} std::vector<cytnx\_int64> \&indicators, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&force = \textcolor{keyword}{false}) \{}
\DoxyCodeLine{3124       this-\/>\_impl-\/>combineBonds(indicators, force);}
\DoxyCodeLine{3125     \}}
\DoxyCodeLine{3126     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} contract(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&inR, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&mv\_elem\_self = \textcolor{keyword}{false},}
\DoxyCodeLine{3127                        \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&mv\_elem\_rhs = \textcolor{keyword}{false})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3128       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{3129       out.\_impl = this-\/>\_impl-\/>contract(inR.\_impl, mv\_elem\_self, mv\_elem\_rhs);}
\DoxyCodeLine{3130       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3131     \}}
\DoxyCodeLine{3132     std::vector<Bond> getTotalQnums(\textcolor{keyword}{const} \textcolor{keywordtype}{bool} physical = \textcolor{keyword}{false})\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3133       \textcolor{keywordflow}{return} this-\/>\_impl-\/>getTotalQnums(physical);}
\DoxyCodeLine{3134     \}}
\DoxyCodeLine{3135     std::vector<std::vector<cytnx\_int64>> get\_blocks\_qnums()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3136       \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_blocks\_qnums();}
\DoxyCodeLine{3137     \}}
\DoxyCodeLine{3138 }
\DoxyCodeLine{3139     \textcolor{keywordtype}{bool} same\_data(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3140       \textcolor{comment}{// check same type:}}
\DoxyCodeLine{3141       \textcolor{keywordflow}{if} (this-\/>\_impl-\/>uten\_type() != rhs.\_impl-\/>uten\_type()) \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{3142 }
\DoxyCodeLine{3143       \textcolor{keywordflow}{return} this-\/>\_impl-\/>same\_data(rhs.\_impl);}
\DoxyCodeLine{3144     \}}
\DoxyCodeLine{3145 }
\DoxyCodeLine{3146     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Add\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \{}
\DoxyCodeLine{3147       this-\/>\_impl-\/>Add\_(rhs.\_impl);}
\DoxyCodeLine{3148       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3149     \}}
\DoxyCodeLine{3150 }
\DoxyCodeLine{3151     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Mul\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \{}
\DoxyCodeLine{3152       this-\/>\_impl-\/>Mul\_(rhs.\_impl);}
\DoxyCodeLine{3153       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3154     \}}
\DoxyCodeLine{3155 }
\DoxyCodeLine{3156     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Sub\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \{}
\DoxyCodeLine{3157       this-\/>\_impl-\/>Sub\_(rhs.\_impl);}
\DoxyCodeLine{3158       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3159     \}}
\DoxyCodeLine{3160 }
\DoxyCodeLine{3161     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Div\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \{}
\DoxyCodeLine{3162       this-\/>\_impl-\/>Div\_(rhs.\_impl);}
\DoxyCodeLine{3163       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3164     \}}
\DoxyCodeLine{3165 }
\DoxyCodeLine{3166     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Add\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs) \{}
\DoxyCodeLine{3167       this-\/>\_impl-\/>Add\_(rhs);}
\DoxyCodeLine{3168       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3169     \}}
\DoxyCodeLine{3170 }
\DoxyCodeLine{3171     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Mul\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs) \{}
\DoxyCodeLine{3172       this-\/>\_impl-\/>Mul\_(rhs);}
\DoxyCodeLine{3173       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3174     \}}
\DoxyCodeLine{3175 }
\DoxyCodeLine{3176     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Sub\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs) \{}
\DoxyCodeLine{3177       this-\/>\_impl-\/>Sub\_(rhs);}
\DoxyCodeLine{3178       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3179     \}}
\DoxyCodeLine{3180 }
\DoxyCodeLine{3181     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Div\_(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs) \{}
\DoxyCodeLine{3182       this-\/>\_impl-\/>Div\_(rhs);}
\DoxyCodeLine{3183       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3184     \}}
\DoxyCodeLine{3185 }
\DoxyCodeLine{3186     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Add(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \textcolor{keyword}{const};}
\DoxyCodeLine{3187     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Add(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs) \textcolor{keyword}{const};}
\DoxyCodeLine{3188     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Mul(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \textcolor{keyword}{const};}
\DoxyCodeLine{3189     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Mul(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs) \textcolor{keyword}{const};}
\DoxyCodeLine{3190     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Div(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \textcolor{keyword}{const};}
\DoxyCodeLine{3191     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Div(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs) \textcolor{keyword}{const};}
\DoxyCodeLine{3192     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Sub(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \textcolor{keyword}{const};}
\DoxyCodeLine{3193     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Sub(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs) \textcolor{keyword}{const};}
\DoxyCodeLine{3194 }
\DoxyCodeLine{3195     \mbox{\hyperlink{classcytnx_1_1Tensor}{Tensor}} Norm()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>Norm(); \};}
\DoxyCodeLine{3196 }
\DoxyCodeLine{3197     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&operator+=(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \{}
\DoxyCodeLine{3198       this-\/>Add\_(rhs);}
\DoxyCodeLine{3199       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3200     \}}
\DoxyCodeLine{3201     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&operator-\/=(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \{}
\DoxyCodeLine{3202       this-\/>Sub\_(rhs);}
\DoxyCodeLine{3203       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3204     \}}
\DoxyCodeLine{3205     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&operator/=(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \{}
\DoxyCodeLine{3206       this-\/>Div\_(rhs);}
\DoxyCodeLine{3207       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3208     \}}
\DoxyCodeLine{3209     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&operator*=(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&rhs) \{}
\DoxyCodeLine{3210       this-\/>Mul\_(rhs);}
\DoxyCodeLine{3211       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3212     \}}
\DoxyCodeLine{3213     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&operator+=(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs) \{}
\DoxyCodeLine{3214       this-\/>Add\_(rhs);}
\DoxyCodeLine{3215       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3216     \}}
\DoxyCodeLine{3217     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&operator-\/=(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs) \{}
\DoxyCodeLine{3218       this-\/>Sub\_(rhs);}
\DoxyCodeLine{3219       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3220     \}}
\DoxyCodeLine{3221     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&operator/=(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs) \{}
\DoxyCodeLine{3222       this-\/>Div\_(rhs);}
\DoxyCodeLine{3223       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3224     \}}
\DoxyCodeLine{3225     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&operator*=(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} \&rhs) \{}
\DoxyCodeLine{3226       this-\/>Mul\_(rhs);}
\DoxyCodeLine{3227       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3228     \}}
\DoxyCodeLine{3229 }
\DoxyCodeLine{3230     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Conj() \{}
\DoxyCodeLine{3231       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{3232       out.\_impl = this-\/>\_impl-\/>Conj();}
\DoxyCodeLine{3233       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3234     \}}
\DoxyCodeLine{3235 }
\DoxyCodeLine{3236     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Conj\_() \{}
\DoxyCodeLine{3237       this-\/>\_impl-\/>Conj\_();}
\DoxyCodeLine{3238       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3239     \}}
\DoxyCodeLine{3240 }
\DoxyCodeLine{3241     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Transpose()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3242       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{3243       out.\_impl = this-\/>\_impl-\/>Transpose();}
\DoxyCodeLine{3244       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3245     \}}
\DoxyCodeLine{3246     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Transpose\_() \{}
\DoxyCodeLine{3247       this-\/>\_impl-\/>Transpose\_();}
\DoxyCodeLine{3248       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3249     \}}
\DoxyCodeLine{3250 }
\DoxyCodeLine{3251     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Trace(\textcolor{keyword}{const} std::string \&a, \textcolor{keyword}{const} std::string \&b)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3252       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{3253       out.\_impl = this-\/>\_impl-\/>Trace(a, b);}
\DoxyCodeLine{3254       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3255     \}}
\DoxyCodeLine{3256     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Trace(\textcolor{keyword}{const} cytnx\_int64 \&a = 0, \textcolor{keyword}{const} cytnx\_int64 \&b = 1)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3257       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{3258       out.\_impl = this-\/>\_impl-\/>Trace(a, b);}
\DoxyCodeLine{3259       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3260     \}}
\DoxyCodeLine{3270     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \mbox{\hyperlink{classcytnx_1_1UniTensor_a5b1311d9ef1d586b8a1bc8da0723dde0}{Trace}}(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3271       \textcolor{keywordflow}{return} Trace(a, b, by\_label);}
\DoxyCodeLine{3272     \}}
\DoxyCodeLine{3273 }
\DoxyCodeLine{3274     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Trace\_(\textcolor{keyword}{const} std::string \&a, \textcolor{keyword}{const} std::string \&b) \{}
\DoxyCodeLine{3275       this-\/>\_impl-\/>Trace\_(a, b);}
\DoxyCodeLine{3276       \textcolor{keywordflow}{if}(this-\/>uten\_type()==UTenType.Block)\{}
\DoxyCodeLine{3277         \textcolor{comment}{// handle if no leg left case for BlockUniTensor.}}
\DoxyCodeLine{3278         \textcolor{keywordflow}{if}(this-\/>rank()==0)\{}
\DoxyCodeLine{3279             DenseUniTensor *tmp = \textcolor{keyword}{new} DenseUniTensor();}
\DoxyCodeLine{3280             tmp-\/>\_block = this-\/>get\_blocks\_(\textcolor{keyword}{true})[0];}
\DoxyCodeLine{3281             this-\/>\_impl = boost::intrusive\_ptr<UniTensor\_base>(tmp);}
\DoxyCodeLine{3282         \}}
\DoxyCodeLine{3283       \}}
\DoxyCodeLine{3284       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3285     \}}
\DoxyCodeLine{3286     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Trace\_(\textcolor{keyword}{const} cytnx\_int64 \&a = 0, \textcolor{keyword}{const} cytnx\_int64 \&b = 1) \{}
\DoxyCodeLine{3287       this-\/>\_impl-\/>Trace\_(a, b);}
\DoxyCodeLine{3288       \textcolor{keywordflow}{if}(this-\/>uten\_type()==UTenType.Block)\{}
\DoxyCodeLine{3289         \textcolor{comment}{// handle if no leg left case for BlockUniTensor.}}
\DoxyCodeLine{3290         \textcolor{keywordflow}{if}(this-\/>rank()==0)\{}
\DoxyCodeLine{3291             DenseUniTensor *tmp = \textcolor{keyword}{new} DenseUniTensor();}
\DoxyCodeLine{3292             tmp-\/>\_block = this-\/>get\_blocks\_(\textcolor{keyword}{true})[0];}
\DoxyCodeLine{3293             this-\/>\_impl = boost::intrusive\_ptr<UniTensor\_base>(tmp);}
\DoxyCodeLine{3294         \}}
\DoxyCodeLine{3295       \}}
\DoxyCodeLine{3296       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3297     \}}
\DoxyCodeLine{3307     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a84fc453e18c73323887ce155bf7dd247}{Trace\_}}(\textcolor{keyword}{const} cytnx\_int64 \&a, \textcolor{keyword}{const} cytnx\_int64 \&b, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label) \{}
\DoxyCodeLine{3308       this-\/>\_impl-\/>Trace\_(a, b, by\_label);}
\DoxyCodeLine{3309       \textcolor{keywordflow}{if}(this-\/>uten\_type()==UTenType.Block)\{}
\DoxyCodeLine{3310         \textcolor{comment}{// handle if no leg left case for BlockUniTensor.}}
\DoxyCodeLine{3311         \textcolor{keywordflow}{if}(this-\/>rank()==0)\{}
\DoxyCodeLine{3312             DenseUniTensor *tmp = \textcolor{keyword}{new} DenseUniTensor();}
\DoxyCodeLine{3313             tmp-\/>\_block = this-\/>get\_blocks\_(\textcolor{keyword}{true})[0];}
\DoxyCodeLine{3314             this-\/>\_impl = boost::intrusive\_ptr<UniTensor\_base>(tmp);}
\DoxyCodeLine{3315         \}}
\DoxyCodeLine{3316       \}}
\DoxyCodeLine{3317       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3318     \}}
\DoxyCodeLine{3319 }
\DoxyCodeLine{3320     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Dagger()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3321       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out;}
\DoxyCodeLine{3322       out.\_impl = this-\/>\_impl-\/>Dagger();}
\DoxyCodeLine{3323       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3324     \}}
\DoxyCodeLine{3325 }
\DoxyCodeLine{3326     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Dagger\_() \{}
\DoxyCodeLine{3327       this-\/>\_impl-\/>Dagger\_();}
\DoxyCodeLine{3328       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3329     \}}
\DoxyCodeLine{3330 }
\DoxyCodeLine{3331     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&tag() \{}
\DoxyCodeLine{3332       this-\/>\_impl-\/>tag();}
\DoxyCodeLine{3333       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3334     \}}
\DoxyCodeLine{3335 }
\DoxyCodeLine{3336     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Pow(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&p) \textcolor{keyword}{const};}
\DoxyCodeLine{3337     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&Pow\_(\textcolor{keyword}{const} \textcolor{keywordtype}{double} \&p);}
\DoxyCodeLine{3338 }
\DoxyCodeLine{3339     \textcolor{keywordtype}{bool} elem\_exists(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3340       \textcolor{keywordflow}{return} this-\/>\_impl-\/>elem\_exists(locator);}
\DoxyCodeLine{3341     \}}
\DoxyCodeLine{3342 }
\DoxyCodeLine{3343     \textcolor{comment}{// [C++: Deprecated soon, use at]}}
\DoxyCodeLine{3344     \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{3345     T get\_elem(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3346       \textcolor{keywordflow}{return} this-\/>at<T>(locator);}
\DoxyCodeLine{3347     \}}
\DoxyCodeLine{3348 }
\DoxyCodeLine{3349     \textcolor{comment}{// [C++: Deprecated soon, use at]}}
\DoxyCodeLine{3350     \textcolor{keyword}{template} <\textcolor{keyword}{class} T2>}
\DoxyCodeLine{3351     \textcolor{keywordtype}{void} set\_elem(\textcolor{keyword}{const} std::vector<cytnx\_uint64> \&locator, \textcolor{keyword}{const} T2 \&rc) \{}
\DoxyCodeLine{3352       \textcolor{comment}{// cytnx\_error\_msg(true,"{}[ERROR] invalid type\%s"{},"{}\(\backslash\)n"{});}}
\DoxyCodeLine{3353       this-\/>at(locator) = rc;}
\DoxyCodeLine{3354     \}}
\DoxyCodeLine{3355 }
\DoxyCodeLine{3356     \textcolor{keywordtype}{void} Save(\textcolor{keyword}{const} std::string \&fname) \textcolor{keyword}{const};}
\DoxyCodeLine{3357     \textcolor{keywordtype}{void} Save(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *fname) \textcolor{keyword}{const};}
\DoxyCodeLine{3358     \textcolor{keyword}{static} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Load(\textcolor{keyword}{const} std::string \&fname);}
\DoxyCodeLine{3359     \textcolor{keyword}{static} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Load(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *fname);}
\DoxyCodeLine{3370     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a8cb549e31b88cad78ee53b92107cfb3a}{truncate\_}}(\textcolor{keyword}{const} cytnx\_int64 \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim,}
\DoxyCodeLine{3371                          \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label) \{}
\DoxyCodeLine{3372       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a8cb549e31b88cad78ee53b92107cfb3a}{truncate\_}}(bond\_idx, dim, by\_label);}
\DoxyCodeLine{3373       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3374     \}}
\DoxyCodeLine{3375     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a8cb549e31b88cad78ee53b92107cfb3a}{truncate\_}}(\textcolor{keyword}{const} std::string \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim) \{}
\DoxyCodeLine{3376       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a8cb549e31b88cad78ee53b92107cfb3a}{truncate\_}}(bond\_idx, dim);}
\DoxyCodeLine{3377       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3378     \}}
\DoxyCodeLine{3379     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&\mbox{\hyperlink{classcytnx_1_1UniTensor_a8cb549e31b88cad78ee53b92107cfb3a}{truncate\_}}(\textcolor{keyword}{const} cytnx\_int64 \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim) \{}
\DoxyCodeLine{3380       this-\/>\_impl-\/>\mbox{\hyperlink{classcytnx_1_1UniTensor_a8cb549e31b88cad78ee53b92107cfb3a}{truncate\_}}(bond\_idx, dim);}
\DoxyCodeLine{3381       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{3382     \}}
\DoxyCodeLine{3393     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \mbox{\hyperlink{classcytnx_1_1UniTensor_a22a06f64274ea1ac34d83bd6e2ff264e}{truncate}}(\textcolor{keyword}{const} cytnx\_int64 \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim,}
\DoxyCodeLine{3394                        \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&by\_label)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3395       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out = this-\/>clone();}
\DoxyCodeLine{3396       out.\mbox{\hyperlink{classcytnx_1_1UniTensor_a8cb549e31b88cad78ee53b92107cfb3a}{truncate\_}}(bond\_idx, dim, by\_label);}
\DoxyCodeLine{3397       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3398     \}}
\DoxyCodeLine{3399     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \mbox{\hyperlink{classcytnx_1_1UniTensor_a22a06f64274ea1ac34d83bd6e2ff264e}{truncate}}(\textcolor{keyword}{const} std::string \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3400       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out = this-\/>clone();}
\DoxyCodeLine{3401       out.\mbox{\hyperlink{classcytnx_1_1UniTensor_a8cb549e31b88cad78ee53b92107cfb3a}{truncate\_}}(bond\_idx, dim);}
\DoxyCodeLine{3402       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3403     \}}
\DoxyCodeLine{3404     \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \mbox{\hyperlink{classcytnx_1_1UniTensor_a22a06f64274ea1ac34d83bd6e2ff264e}{truncate}}(\textcolor{keyword}{const} cytnx\_int64 \&bond\_idx, \textcolor{keyword}{const} cytnx\_uint64 \&dim)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3405       \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} out = this-\/>clone();}
\DoxyCodeLine{3406       out.\mbox{\hyperlink{classcytnx_1_1UniTensor_a8cb549e31b88cad78ee53b92107cfb3a}{truncate\_}}(bond\_idx, dim);}
\DoxyCodeLine{3407       \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{3408     \}}
\DoxyCodeLine{3409 }
\DoxyCodeLine{3417     \textcolor{keyword}{const} std::vector<cytnx\_uint64>\& \mbox{\hyperlink{classcytnx_1_1UniTensor_ad323800d8b97faa8aad9b980eb6b9c7f}{get\_qindices}}(\textcolor{keyword}{const} cytnx\_uint64 \&bidx)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{3418         \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_qindices(bidx);}
\DoxyCodeLine{3419     \}}
\DoxyCodeLine{3427     std::vector<cytnx\_uint64>\& \mbox{\hyperlink{classcytnx_1_1UniTensor_a118c7e66008dd037063e3e71604ebd74}{get\_qindices}}(\textcolor{keyword}{const} cytnx\_uint64 \&bidx)\{}
\DoxyCodeLine{3428         \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_qindices(bidx);}
\DoxyCodeLine{3429     \}}
\DoxyCodeLine{3430 }
\DoxyCodeLine{3431     }
\DoxyCodeLine{3432 }
\DoxyCodeLine{3439     \textcolor{keyword}{const} vec2d<cytnx\_uint64> \& \mbox{\hyperlink{classcytnx_1_1UniTensor_ae7525954cafa6cf69b4fc69dcabae4c3}{get\_itoi}}()\textcolor{keyword}{ const}\{}
\DoxyCodeLine{3440         \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_itoi();}
\DoxyCodeLine{3441     \}}
\DoxyCodeLine{3442     vec2d<cytnx\_uint64> \& \mbox{\hyperlink{classcytnx_1_1UniTensor_ae7525954cafa6cf69b4fc69dcabae4c3}{get\_itoi}}()\{}
\DoxyCodeLine{3443         \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_itoi();}
\DoxyCodeLine{3444     \}}
\DoxyCodeLine{3445 }
\DoxyCodeLine{3446 }
\DoxyCodeLine{3447 }
\DoxyCodeLine{3449     \textcolor{keywordtype}{void} \_Load(std::fstream \&f);}
\DoxyCodeLine{3450     \textcolor{keywordtype}{void} \_Save(std::fstream \&f) \textcolor{keyword}{const};}
\DoxyCodeLine{3452 }
\DoxyCodeLine{3453   \};  \textcolor{comment}{// class UniTensor}}
\DoxyCodeLine{3454 }
\DoxyCodeLine{3456   std::ostream \&operator<<(std::ostream \&os, \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&in);}
\DoxyCodeLine{3458 }
\DoxyCodeLine{3471   \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Contract(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&inL, \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&inR, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&cacheL = \textcolor{keyword}{false},}
\DoxyCodeLine{3472                      \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \&cacheR = \textcolor{keyword}{false});}
\DoxyCodeLine{3473 }
\DoxyCodeLine{3484   \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Contracts(\textcolor{keyword}{const} std::vector<UniTensor> \&TNs);}
\DoxyCodeLine{3485 }
\DoxyCodeLine{3487   \textcolor{keywordtype}{void} \_resolve\_CT(std::vector<UniTensor> \&TNlist);}
\DoxyCodeLine{3488   \textcolor{keyword}{template} <\textcolor{keyword}{class}... T>}
\DoxyCodeLine{3489   \textcolor{keywordtype}{void} \_resolve\_CT(std::vector<UniTensor> \&TNlist, \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&in, \textcolor{keyword}{const} T \&...args) \{}
\DoxyCodeLine{3490     TNlist.push\_back(in);}
\DoxyCodeLine{3491     \_resolve\_CT(TNlist, args...);}
\DoxyCodeLine{3492   \}}
\DoxyCodeLine{3494 }
\DoxyCodeLine{3506   \textcolor{keyword}{template} <\textcolor{keyword}{class}... T>}
\DoxyCodeLine{3507   \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} Contracts(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1UniTensor}{UniTensor}} \&in, \textcolor{keyword}{const} T \&...args) \{}
\DoxyCodeLine{3508     std::vector<UniTensor> TNlist;}
\DoxyCodeLine{3509     \_resolve\_CT(TNlist, in, args...);}
\DoxyCodeLine{3510     \textcolor{keywordflow}{return} Contracts(TNlist);}
\DoxyCodeLine{3511   \}}
\DoxyCodeLine{3512 }
\DoxyCodeLine{3513 \}  \textcolor{comment}{// namespace cytnx}}
\DoxyCodeLine{3514 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
