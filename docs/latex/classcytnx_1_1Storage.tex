\hypertarget{classcytnx_1_1Storage}{}\section{cytnx\+:\+:Storage Class Reference}
\label{classcytnx_1_1Storage}\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}}


an memeory storage with multi-\/type/multi-\/device support  




{\ttfamily \#include $<$Storage.\+hpp$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classcytnx_1_1Storage_a6cf79f362c4ae68ab7623f0ebac9355e}{Init} (const unsigned long long \&\hyperlink{classcytnx_1_1Storage_aaf36262622abdab03c90b713c454f78e}{size}, const unsigned int \&\hyperlink{classcytnx_1_1Storage_a643824801e81ab86aca055f1dd1f34d7}{dtype}=Type.\+Double, int \hyperlink{classcytnx_1_1Storage_a4c3e27582d7f951e6b76ccbb92f7c537}{device}=-\/1)
\begin{DoxyCompactList}\small\item\em initialize a \hyperlink{classcytnx_1_1Storage}{Storage} \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classcytnx_1_1Storage_a281c06bd64e9ea3338083c18c4c32eda}\label{classcytnx_1_1Storage_a281c06bd64e9ea3338083c18c4c32eda}} 
{\bfseries Storage} (const unsigned long long \&\hyperlink{classcytnx_1_1Storage_aaf36262622abdab03c90b713c454f78e}{size}, const unsigned int \&\hyperlink{classcytnx_1_1Storage_a643824801e81ab86aca055f1dd1f34d7}{dtype}=Type.\+Double, int \hyperlink{classcytnx_1_1Storage_a4c3e27582d7f951e6b76ccbb92f7c537}{device}=-\/1)
\item 
\hyperlink{classcytnx_1_1Storage}{Storage} \hyperlink{classcytnx_1_1Storage_a8310d8dbb70510272ded2e3d01be25f0}{astype} (const unsigned int \&new\+\_\+type) const
\begin{DoxyCompactList}\small\item\em cast the type of current \hyperlink{classcytnx_1_1Storage}{Storage} \end{DoxyCompactList}\item 
const unsigned int \& \hyperlink{classcytnx_1_1Storage_a643824801e81ab86aca055f1dd1f34d7}{dtype} () const
\begin{DoxyCompactList}\small\item\em the dtype-\/id of current \hyperlink{classcytnx_1_1Storage}{Storage} \end{DoxyCompactList}\item 
const std\+::string \hyperlink{classcytnx_1_1Storage_ab6e9fb01ad4655701a2d54dc978eef17}{dtype\+\_\+str} () const
\begin{DoxyCompactList}\small\item\em the dtype (std\+::string) of current \hyperlink{classcytnx_1_1Storage}{Storage} \end{DoxyCompactList}\item 
const int \& \hyperlink{classcytnx_1_1Storage_a4c3e27582d7f951e6b76ccbb92f7c537}{device} () const
\begin{DoxyCompactList}\small\item\em the device-\/id of current \hyperlink{classcytnx_1_1Storage}{Storage} \end{DoxyCompactList}\item 
const std\+::string \hyperlink{classcytnx_1_1Storage_ae0d90d5275fa7e52a0a2dc10512ba71f}{device\+\_\+str} () const
\begin{DoxyCompactList}\small\item\em the device (std\+::string) of current \hyperlink{classcytnx_1_1Storage}{Storage} \end{DoxyCompactList}\item 
void \hyperlink{classcytnx_1_1Storage_a0bbf2cbefb5d0835bcb4f0d05e400870}{to\+\_\+} (const int \&\hyperlink{classcytnx_1_1Storage_a4c3e27582d7f951e6b76ccbb92f7c537}{device})
\begin{DoxyCompactList}\small\item\em move the current \hyperlink{classcytnx_1_1Storage}{Storage} to different deivce. \end{DoxyCompactList}\item 
\hyperlink{classcytnx_1_1Storage}{Storage} \hyperlink{classcytnx_1_1Storage_a2abfcaacf807934be5dd21c254fdb30e}{to} (const int \&\hyperlink{classcytnx_1_1Storage_a4c3e27582d7f951e6b76ccbb92f7c537}{device})
\begin{DoxyCompactList}\small\item\em move a new \hyperlink{classcytnx_1_1Storage}{Storage} with same content as current \hyperlink{classcytnx_1_1Storage}{Storage} on different deivce. \end{DoxyCompactList}\item 
\hyperlink{classcytnx_1_1Storage}{Storage} \hyperlink{classcytnx_1_1Storage_aed0530dd20f3fb352d45653ba46a3d50}{clone} () const
\begin{DoxyCompactList}\small\item\em return a copy of current storage. \end{DoxyCompactList}\item 
const unsigned long long \& \hyperlink{classcytnx_1_1Storage_aaf36262622abdab03c90b713c454f78e}{size} () const
\begin{DoxyCompactList}\small\item\em the size ( no. of elements ) in the \hyperlink{classcytnx_1_1Storage}{Storage} \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classcytnx_1_1Storage_a0ae2bee5e15c651b05dadf5dbbdb36f5}\label{classcytnx_1_1Storage_a0ae2bee5e15c651b05dadf5dbbdb36f5}} 
void \hyperlink{classcytnx_1_1Storage_a0ae2bee5e15c651b05dadf5dbbdb36f5}{print\+\_\+info} ()
\begin{DoxyCompactList}\small\item\em print the info of the \hyperlink{classcytnx_1_1Storage}{Storage}, including the device, dtype and size. \end{DoxyCompactList}\item 
void \hyperlink{classcytnx_1_1Storage_a7e854529c99108b0acc3e5e2b185244b}{set\+\_\+zeros} ()
\begin{DoxyCompactList}\small\item\em set all the elements to zero. \end{DoxyCompactList}\item 
bool \hyperlink{classcytnx_1_1Storage_ad304e00cf3d472ea0355af6b40c4529d}{operator==} (const \hyperlink{classcytnx_1_1Storage}{Storage} \&rhs)
\begin{DoxyCompactList}\small\item\em compare two \hyperlink{classcytnx_1_1Storage}{Storage} \end{DoxyCompactList}\item 
{\footnotesize template$<$class T $>$ }\\void \hyperlink{classcytnx_1_1Storage_a48f0424f051a4b3a821eb964be4cd5db}{fill} (const T \&val)
\begin{DoxyCompactList}\small\item\em set all the elements to the assigned value val \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
an memeory storage with multi-\/type/multi-\/device support 

\subsection{Member Function Documentation}
\mbox{\Hypertarget{classcytnx_1_1Storage_a8310d8dbb70510272ded2e3d01be25f0}\label{classcytnx_1_1Storage_a8310d8dbb70510272ded2e3d01be25f0}} 
\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}!astype@{astype}}
\index{astype@{astype}!cytnx\+::\+Storage@{cytnx\+::\+Storage}}
\subsubsection{\texorpdfstring{astype()}{astype()}}
{\footnotesize\ttfamily \hyperlink{classcytnx_1_1Storage}{Storage} cytnx\+::\+Storage\+::astype (\begin{DoxyParamCaption}\item[{const unsigned int \&}]{new\+\_\+type }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



cast the type of current \hyperlink{classcytnx_1_1Storage}{Storage} 


\begin{DoxyParams}{Parameters}
{\em new\+\_\+type} & the new type of the \hyperlink{classcytnx_1_1Storage}{Storage} instance. This can be any of type defined in cytnx\+::\+Type\\
\hline
\end{DoxyParams}
description\+:
\begin{DoxyEnumerate}
\item if the new\+\_\+type is the same as the dtype of current \hyperlink{classcytnx_1_1Storage}{Storage}, then return self; otherwise, return a new instance that has the same content as current \hyperlink{classcytnx_1_1Storage}{Storage} with dtype=new\+\_\+type
\item the return Stoarge will be on the same device as the current \hyperlink{classcytnx_1_1Storage}{Storage}.
\end{DoxyEnumerate}

\subsubsection*{Example\+:}

\paragraph*{c++ A\+PI\+:}


\begin{DoxyCodeInclude}
\textcolor{preprocessor}{#include "cytnx.hpp"}
\textcolor{preprocessor}{#include <iostream>}


\textcolor{keyword}{using namespace }\hyperlink{namespacecytnx}{cytnx};
\textcolor{keyword}{using namespace }std;
\textcolor{keywordtype}{int} main()\{ 

    \textcolor{comment}{/*}
\textcolor{comment}{        1. Create a Storage with }
\textcolor{comment}{        dtype =Type.Double [default],}
\textcolor{comment}{    */}
    \hyperlink{classcytnx_1_1Storage}{Storage} A(10);
    cout << A.\hyperlink{classcytnx_1_1Tensor_a9e09106c7529e8be90caa52e1541e498}{dtype\_str}() << endl;

    \textcolor{comment}{// the type is the same as A's type, so B shares the same object with A}
    \hyperlink{classcytnx_1_1Storage}{Storage} B = A.astype(Type.Double); 
    cout << B.\hyperlink{classcytnx_1_1Storage_ab6e9fb01ad4655701a2d54dc978eef17}{dtype\_str}() << endl;
    cout << is(B,A) << endl; \textcolor{comment}{// true}

    \textcolor{comment}{// cast A from Type.Double to Type.Float}
    \hyperlink{classcytnx_1_1Storage}{Storage} C = A.astype(Type.Float);
    cout << C.\hyperlink{classcytnx_1_1Storage_ab6e9fb01ad4655701a2d54dc978eef17}{dtype\_str}() << endl;
    cout << is(C, A) << endl; \textcolor{comment}{// false}


    \hyperlink{classcytnx_1_1Storage}{Storage} D(10,Type.Double,Device.cuda+0);
    \textcolor{comment}{// D is on GPU, so E is also on GPU}
    \hyperlink{classcytnx_1_1Storage}{Storage} E = D.\hyperlink{classcytnx_1_1Storage_a8310d8dbb70510272ded2e3d01be25f0}{astype}(Type.Float);

    cout << E.\hyperlink{classcytnx_1_1Storage_ae0d90d5275fa7e52a0a2dc10512ba71f}{device\_str}() << endl; 

 

    \textcolor{keywordflow}{return} 0;
\}

\end{DoxyCodeInclude}
 \subparagraph*{output$>$}


\begin{DoxyVerbInclude}
Double (Float64)
Double (Float64)
1
Float32
0
cytnx device: CUDA/GPU-id:0
\end{DoxyVerbInclude}
 \paragraph*{python A\+PI\+:}


\begin{DoxyCodeInclude}
\textcolor{keyword}{from} cytnx \textcolor{keyword}{import} *


A = Storage(10)
print(A.dtype\_str())

B = A.astype(Type.Double)
print(B.dtype\_str())
print(B \textcolor{keywordflow}{is} A)

C = A.astype(Type.Float)
print(C.dtype\_str())
print(C \textcolor{keywordflow}{is} A)

D = Storage(10,device=Device.cuda+0);
E = D.astype(Type.Float)
print(E.device\_str())

\end{DoxyCodeInclude}
 \subparagraph*{output$>$}


\begin{DoxyVerbInclude}
Double (Float64)
Double (Float64)
True
Float32
False
cytnx device: CUDA/GPU-id:0
\end{DoxyVerbInclude}
 \mbox{\Hypertarget{classcytnx_1_1Storage_aed0530dd20f3fb352d45653ba46a3d50}\label{classcytnx_1_1Storage_aed0530dd20f3fb352d45653ba46a3d50}} 
\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}!clone@{clone}}
\index{clone@{clone}!cytnx\+::\+Storage@{cytnx\+::\+Storage}}
\subsubsection{\texorpdfstring{clone()}{clone()}}
{\footnotesize\ttfamily \hyperlink{classcytnx_1_1Storage}{Storage} cytnx\+::\+Storage\+::clone (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



return a copy of current storage. 

\begin{DoxyReturn}{Returns}
\mbox{[}\hyperlink{classcytnx_1_1Storage}{Storage}\mbox{]}
\end{DoxyReturn}
\subsubsection*{Example\+:}

\paragraph*{c++ A\+PI\+:}


\begin{DoxyCodeInclude}
\textcolor{preprocessor}{#include "cytnx.hpp"}
\textcolor{preprocessor}{#include <iostream>}


\textcolor{keyword}{using namespace }\hyperlink{namespacecytnx}{cytnx};
\textcolor{keyword}{using namespace }std;
\textcolor{keywordtype}{int} main()\{ 

    \hyperlink{classcytnx_1_1Storage}{Storage} A(15);

    \hyperlink{classcytnx_1_1Storage}{Storage} B = A; \textcolor{comment}{// B shares same object with A}
    \hyperlink{classcytnx_1_1Storage}{Storage} C = A.\hyperlink{classcytnx_1_1Tensor_a5e2248e9babdb786167ed349df9084ae}{clone}(); \textcolor{comment}{// C is a copy of A}
    
    \textcolor{comment}{// use is() to check if two variable shares same object}
    cout << is(B,A) << endl;
    cout << is(C,A) << endl;

    \textcolor{keywordflow}{return} 0;
\}

\end{DoxyCodeInclude}
 \subparagraph*{output$>$}


\begin{DoxyVerbInclude}
1
0
\end{DoxyVerbInclude}
 \paragraph*{python A\+PI\+:}


\begin{DoxyCodeInclude}
\textcolor{keyword}{from} cytnx \textcolor{keyword}{import} *

A = Storage(15)

B = A
C = A.clone()

print(B \textcolor{keywordflow}{is} A)
print(C \textcolor{keywordflow}{is} A)

\end{DoxyCodeInclude}
 \subparagraph*{output$>$}


\begin{DoxyVerbInclude}
True
False
\end{DoxyVerbInclude}
 \mbox{\Hypertarget{classcytnx_1_1Storage_a4c3e27582d7f951e6b76ccbb92f7c537}\label{classcytnx_1_1Storage_a4c3e27582d7f951e6b76ccbb92f7c537}} 
\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}!device@{device}}
\index{device@{device}!cytnx\+::\+Storage@{cytnx\+::\+Storage}}
\subsubsection{\texorpdfstring{device()}{device()}}
{\footnotesize\ttfamily const int\& cytnx\+::\+Storage\+::device (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



the device-\/id of current \hyperlink{classcytnx_1_1Storage}{Storage} 

\begin{DoxyReturn}{Returns}
\mbox{[}cytnx\+\_\+int64\mbox{]} the device-\/id. 
\end{DoxyReturn}
\mbox{\Hypertarget{classcytnx_1_1Storage_ae0d90d5275fa7e52a0a2dc10512ba71f}\label{classcytnx_1_1Storage_ae0d90d5275fa7e52a0a2dc10512ba71f}} 
\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}!device\+\_\+str@{device\+\_\+str}}
\index{device\+\_\+str@{device\+\_\+str}!cytnx\+::\+Storage@{cytnx\+::\+Storage}}
\subsubsection{\texorpdfstring{device\+\_\+str()}{device\_str()}}
{\footnotesize\ttfamily const std\+::string cytnx\+::\+Storage\+::device\+\_\+str (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



the device (std\+::string) of current \hyperlink{classcytnx_1_1Storage}{Storage} 

\begin{DoxyReturn}{Returns}
\mbox{[}std\+::string\mbox{]} device name 
\end{DoxyReturn}
\mbox{\Hypertarget{classcytnx_1_1Storage_a643824801e81ab86aca055f1dd1f34d7}\label{classcytnx_1_1Storage_a643824801e81ab86aca055f1dd1f34d7}} 
\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}!dtype@{dtype}}
\index{dtype@{dtype}!cytnx\+::\+Storage@{cytnx\+::\+Storage}}
\subsubsection{\texorpdfstring{dtype()}{dtype()}}
{\footnotesize\ttfamily const unsigned int\& cytnx\+::\+Storage\+::dtype (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



the dtype-\/id of current \hyperlink{classcytnx_1_1Storage}{Storage} 

\begin{DoxyReturn}{Returns}
\mbox{[}cytnx\+\_\+uint64\mbox{]} the dtype-\/id. 
\end{DoxyReturn}
\mbox{\Hypertarget{classcytnx_1_1Storage_ab6e9fb01ad4655701a2d54dc978eef17}\label{classcytnx_1_1Storage_ab6e9fb01ad4655701a2d54dc978eef17}} 
\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}!dtype\+\_\+str@{dtype\+\_\+str}}
\index{dtype\+\_\+str@{dtype\+\_\+str}!cytnx\+::\+Storage@{cytnx\+::\+Storage}}
\subsubsection{\texorpdfstring{dtype\+\_\+str()}{dtype\_str()}}
{\footnotesize\ttfamily const std\+::string cytnx\+::\+Storage\+::dtype\+\_\+str (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



the dtype (std\+::string) of current \hyperlink{classcytnx_1_1Storage}{Storage} 

\begin{DoxyReturn}{Returns}
\mbox{[}std\+::string\mbox{]} dtype name 
\end{DoxyReturn}
\mbox{\Hypertarget{classcytnx_1_1Storage_a48f0424f051a4b3a821eb964be4cd5db}\label{classcytnx_1_1Storage_a48f0424f051a4b3a821eb964be4cd5db}} 
\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}!fill@{fill}}
\index{fill@{fill}!cytnx\+::\+Storage@{cytnx\+::\+Storage}}
\subsubsection{\texorpdfstring{fill()}{fill()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void cytnx\+::\+Storage\+::fill (\begin{DoxyParamCaption}\item[{const T \&}]{val }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



set all the elements to the assigned value val 


\begin{DoxyParams}{Parameters}
{\em val} & the value to set on all the elements. it can be any type defined in cytnx\+::\+Type\\
\hline
\end{DoxyParams}
\mbox{[}Note\mbox{]}
\begin{DoxyEnumerate}
\item cannot assign a complex value into a real \hyperlink{classcytnx_1_1Storage}{Storage}. 
\end{DoxyEnumerate}\mbox{\Hypertarget{classcytnx_1_1Storage_a6cf79f362c4ae68ab7623f0ebac9355e}\label{classcytnx_1_1Storage_a6cf79f362c4ae68ab7623f0ebac9355e}} 
\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}!Init@{Init}}
\index{Init@{Init}!cytnx\+::\+Storage@{cytnx\+::\+Storage}}
\subsubsection{\texorpdfstring{Init()}{Init()}}
{\footnotesize\ttfamily void cytnx\+::\+Storage\+::\+Init (\begin{DoxyParamCaption}\item[{const unsigned long long \&}]{size,  }\item[{const unsigned int \&}]{dtype = {\ttfamily Type.Double},  }\item[{int}]{device = {\ttfamily -\/1} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



initialize a \hyperlink{classcytnx_1_1Storage}{Storage} 


\begin{DoxyParams}{Parameters}
{\em size} & the number of elements for the \hyperlink{classcytnx_1_1Storage}{Storage} \\
\hline
{\em dtype} & the dtype of the \hyperlink{classcytnx_1_1Storage}{Storage} instance. This can be any of type defined in cytnx\+::\+Type \\
\hline
{\em device} & the device of the \hyperlink{classcytnx_1_1Storage}{Storage} instance. This can be cytnx\+::\+Device.\+cpu or cytnx\+::\+Device.\+cuda+$<$gpuid$>$\\
\hline
\end{DoxyParams}
\subsubsection*{Example\+:}

\paragraph*{c++ A\+PI\+:}


\begin{DoxyCodeInclude}
\textcolor{preprocessor}{#include "cytnx.hpp"}
\textcolor{preprocessor}{#include <iostream>}


\textcolor{keyword}{using namespace }\hyperlink{namespacecytnx}{cytnx};
\textcolor{keyword}{using namespace }std;
\textcolor{keywordtype}{int} main()\{ 

    \textcolor{comment}{/*}
\textcolor{comment}{        1. Create a Storage with }
\textcolor{comment}{        10 elements, }
\textcolor{comment}{        dtype =Type.Double [default],}
\textcolor{comment}{        device=Device.cpu [default]}
\textcolor{comment}{    */}
    \hyperlink{classcytnx_1_1Storage}{Storage} A(10);
    cout << A << endl;

    \textcolor{comment}{/*}
\textcolor{comment}{        2. Create a Storage with }
\textcolor{comment}{        10 elements, }
\textcolor{comment}{        dtype =Type.Uint64,}
\textcolor{comment}{        device=Device.cpu [default],}
\textcolor{comment}{        [Note] the dtype can be any one of the supported type.}
\textcolor{comment}{    */}
    \hyperlink{classcytnx_1_1Storage}{Storage} B(10,Type.Uint64);
    cout << B << endl;

    \textcolor{comment}{/*}
\textcolor{comment}{        3. Initialize a Storage with }
\textcolor{comment}{        10 elements,}
\textcolor{comment}{        dtype =Type.Double,}
\textcolor{comment}{        device=Device.cuda+0, (on gpu with gpu-id=0)}
\textcolor{comment}{        [Note] the gpu device can be set with Device.cuda+<gpu-id>}
\textcolor{comment}{    */}
    \hyperlink{classcytnx_1_1Storage}{Storage} C(10,Type.Double,Device.cuda+0);
    cout << C << endl;

    \textcolor{comment}{//4. Create an empty Storage, and init later}
    \hyperlink{classcytnx_1_1Storage}{Storage} D;
    D.\hyperlink{classcytnx_1_1Storage_a6cf79f362c4ae68ab7623f0ebac9355e}{Init}(10,Type.Double,Device.cpu);

    \textcolor{keywordflow}{return} 0;
\}

\end{DoxyCodeInclude}
 \subparagraph*{output$>$}


\begin{DoxyVerbInclude}
dtype : Double (Float64)
device: cytnx device: CPU
size  : 10
[ 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 ]

dtype : Uint64
device: cytnx device: CPU
size  : 10
[                   0                   0                   0                   0                   0                   0                   0                   0                   0                   0  ]

dtype : Double (Float64)
device: cytnx device: CUDA/GPU-id:0
size  : 10
[ 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 ]

\end{DoxyVerbInclude}
 \paragraph*{python A\+PI\+:}


\begin{DoxyCodeInclude}
\textcolor{keyword}{from} cytnx \textcolor{keyword}{import} *

A = Storage(10);
print(A)

B = Storage(10,dtype=Type.Uint64)
print(B)

C = Storage(10,device=Device.cuda+0)
print(C)

D = Storage()
D.Init(10,dtype=Type.Double,device=Device.cpu)


\end{DoxyCodeInclude}
 \subparagraph*{output$>$}


\begin{DoxyVerbInclude}
dtype : Double (Float64)
device: cytnx device: CPU
size  : 10
[ 6.95220e-310 6.95220e-310 -8.33544e-56 6.95220e-310 6.95220e-310 -2.65875e+270 6.95220e-310 4.68031e-310 9.08681e-112 6.95220e-310 ]

dtype : Uint64
device: cytnx device: CPU
size  : 10
[         -1942438752         -1942438752         -1967654392         -1967654448          -382484087         -1967654224         -1967654280           993223204         -1967654056         -1967654112  ]

dtype : Double (Float64)
device: cytnx device: CUDA/GPU-id:0
size  : 10
[ 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 ]




\end{DoxyVerbInclude}
 \mbox{\Hypertarget{classcytnx_1_1Storage_ad304e00cf3d472ea0355af6b40c4529d}\label{classcytnx_1_1Storage_ad304e00cf3d472ea0355af6b40c4529d}} 
\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}!operator==@{operator==}}
\index{operator==@{operator==}!cytnx\+::\+Storage@{cytnx\+::\+Storage}}
\subsubsection{\texorpdfstring{operator==()}{operator==()}}
{\footnotesize\ttfamily bool cytnx\+::\+Storage\+::operator== (\begin{DoxyParamCaption}\item[{const \hyperlink{classcytnx_1_1Storage}{Storage} \&}]{rhs }\end{DoxyParamCaption})}



compare two \hyperlink{classcytnx_1_1Storage}{Storage} 


\begin{DoxyParams}{Parameters}
{\em \hyperlink{classcytnx_1_1Storage}{Storage}} & another \hyperlink{classcytnx_1_1Storage}{Storage} to compare to\\
\hline
\end{DoxyParams}
\mbox{[}Note\mbox{]} the == operator will compare the content between two storages. use cytnx\+::is() for checking two variables share the same instance.

\subsubsection*{Example\+:}

\paragraph*{c++ A\+PI\+:}


\begin{DoxyCodeInclude}
\textcolor{preprocessor}{#include "cytnx.hpp"}
\textcolor{preprocessor}{#include <iostream>}


\textcolor{keyword}{using namespace }\hyperlink{namespacecytnx}{cytnx};
\textcolor{keyword}{using namespace }std;
\textcolor{keywordtype}{int} main()\{ 

    \textcolor{comment}{/*}
\textcolor{comment}{        1. Create a Storage with }
\textcolor{comment}{        dtype =Type.Double [default],}
\textcolor{comment}{    */}
    \hyperlink{classcytnx_1_1Storage}{Storage} A(10);
    cout << A.\hyperlink{classcytnx_1_1Tensor_a9e09106c7529e8be90caa52e1541e498}{dtype\_str}() << endl;

    \hyperlink{classcytnx_1_1Storage}{Storage} B = A;  
    \hyperlink{classcytnx_1_1Storage}{Storage} C = A.\hyperlink{classcytnx_1_1Tensor_a5e2248e9babdb786167ed349df9084ae}{clone}();

    cout << (B == A) << endl; \textcolor{comment}{// true (share same instance)}
    cout << is(B,A) << endl; \textcolor{comment}{// true (share same instance)}
  
    cout << (C == A) << endl;  \textcolor{comment}{// true (the same content.)}
    cout << is(C,A) << endl; \textcolor{comment}{// false (not share same instance)}
 

    \textcolor{keywordflow}{return} 0;
\}

\end{DoxyCodeInclude}
 \subparagraph*{output$>$}


\begin{DoxyVerbInclude}
Double (Float64)
1
1
1
0
\end{DoxyVerbInclude}
 \paragraph*{python A\+PI\+:}


\begin{DoxyCodeInclude}
\textcolor{keyword}{from} cytnx \textcolor{keyword}{import} *


A = Storage(10)
print(A.dtype\_str())

B = A
C = A.clone()

print(B == A) \textcolor{comment}{# true (share same instance)}
print(B \textcolor{keywordflow}{is} A) \textcolor{comment}{# true (share same instance)}

print(C == A)  \textcolor{comment}{# true (the same content.)}
print(C \textcolor{keywordflow}{is} A)  \textcolor{comment}{# false (not share same instance)}
\end{DoxyCodeInclude}
 \subparagraph*{output$>$}


\begin{DoxyVerbInclude}
Double (Float64)
True
True
True
False
\end{DoxyVerbInclude}
 \mbox{\Hypertarget{classcytnx_1_1Storage_a7e854529c99108b0acc3e5e2b185244b}\label{classcytnx_1_1Storage_a7e854529c99108b0acc3e5e2b185244b}} 
\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}!set\+\_\+zeros@{set\+\_\+zeros}}
\index{set\+\_\+zeros@{set\+\_\+zeros}!cytnx\+::\+Storage@{cytnx\+::\+Storage}}
\subsubsection{\texorpdfstring{set\+\_\+zeros()}{set\_zeros()}}
{\footnotesize\ttfamily void cytnx\+::\+Storage\+::set\+\_\+zeros (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



set all the elements to zero. 

\mbox{[}Note\mbox{]} although it is also possible to use Storage.\+fill(0) to set all the elements to zero, using set\+\_\+zeros will have significant faster performance. \mbox{\Hypertarget{classcytnx_1_1Storage_aaf36262622abdab03c90b713c454f78e}\label{classcytnx_1_1Storage_aaf36262622abdab03c90b713c454f78e}} 
\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}!size@{size}}
\index{size@{size}!cytnx\+::\+Storage@{cytnx\+::\+Storage}}
\subsubsection{\texorpdfstring{size()}{size()}}
{\footnotesize\ttfamily const unsigned long long\& cytnx\+::\+Storage\+::size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



the size ( no. of elements ) in the \hyperlink{classcytnx_1_1Storage}{Storage} 

\begin{DoxyReturn}{Returns}
\mbox{[}cytnx\+\_\+uint64\mbox{]} 
\end{DoxyReturn}
\mbox{\Hypertarget{classcytnx_1_1Storage_a2abfcaacf807934be5dd21c254fdb30e}\label{classcytnx_1_1Storage_a2abfcaacf807934be5dd21c254fdb30e}} 
\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}!to@{to}}
\index{to@{to}!cytnx\+::\+Storage@{cytnx\+::\+Storage}}
\subsubsection{\texorpdfstring{to()}{to()}}
{\footnotesize\ttfamily \hyperlink{classcytnx_1_1Storage}{Storage} cytnx\+::\+Storage\+::to (\begin{DoxyParamCaption}\item[{const int \&}]{device }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



move a new \hyperlink{classcytnx_1_1Storage}{Storage} with same content as current \hyperlink{classcytnx_1_1Storage}{Storage} on different deivce. 


\begin{DoxyParams}{Parameters}
{\em device} & the device-\/id. It can be any device defined in \hyperlink{}{cytnx\+::\+Device }\\
\hline
\end{DoxyParams}
\mbox{[}Note\mbox{]} if the 
\begin{DoxyParams}{Parameters}
{\em device} & is the same as the current \hyperlink{classcytnx_1_1Storage}{Storage}\textquotesingle{}s device, return self.\\
\hline
\end{DoxyParams}
see also \hyperlink{classcytnx_1_1Storage_a0bbf2cbefb5d0835bcb4f0d05e400870}{Storage.\+to\+\_\+() } \mbox{\Hypertarget{classcytnx_1_1Storage_a0bbf2cbefb5d0835bcb4f0d05e400870}\label{classcytnx_1_1Storage_a0bbf2cbefb5d0835bcb4f0d05e400870}} 
\index{cytnx\+::\+Storage@{cytnx\+::\+Storage}!to\+\_\+@{to\+\_\+}}
\index{to\+\_\+@{to\+\_\+}!cytnx\+::\+Storage@{cytnx\+::\+Storage}}
\subsubsection{\texorpdfstring{to\+\_\+()}{to\_()}}
{\footnotesize\ttfamily void cytnx\+::\+Storage\+::to\+\_\+ (\begin{DoxyParamCaption}\item[{const int \&}]{device }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



move the current \hyperlink{classcytnx_1_1Storage}{Storage} to different deivce. 


\begin{DoxyParams}{Parameters}
{\em device} & the device-\/id. It can be any device defined in \hyperlink{}{cytnx\+::\+Device }\\
\hline
\end{DoxyParams}
see also \hyperlink{classcytnx_1_1Storage_a2abfcaacf807934be5dd21c254fdb30e}{Storage.\+to() } 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/Storage.\+hpp\end{DoxyCompactItemize}
