\hypertarget{stat_8hpp_source}{}\doxysection{stat.\+hpp}
\label{stat_8hpp_source}\index{include/stat.hpp@{include/stat.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef \_stat\_H\_}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define \_stat\_H\_}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}Type.hpp"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}cytnx\_error.hpp"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}Storage.hpp"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}Tensor.hpp"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{keyword}{namespace }cytnx \{}
\DoxyCodeLine{12   \textcolor{keyword}{namespace }stat \{}
\DoxyCodeLine{13 }
\DoxyCodeLine{15     \textcolor{keyword}{class }\mbox{\hyperlink{classcytnx_1_1stat_1_1Histogram}{Histogram}} \{}
\DoxyCodeLine{16      \textcolor{keyword}{public}:}
\DoxyCodeLine{17       \textcolor{keywordtype}{double} min;}
\DoxyCodeLine{18       \textcolor{keywordtype}{double} max;}
\DoxyCodeLine{19       uint64\_t bins;}
\DoxyCodeLine{20       \mbox{\hyperlink{classcytnx_1_1Storage}{cytnx::Storage}} vars;}
\DoxyCodeLine{21       \mbox{\hyperlink{classcytnx_1_1Storage}{cytnx::Storage}} x;}
\DoxyCodeLine{22 }
\DoxyCodeLine{23       \textcolor{comment}{// std::vector<double> vars;}}
\DoxyCodeLine{24       \textcolor{comment}{// std::vector<double> x;}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26       \textcolor{keywordtype}{double} total\_count;}
\DoxyCodeLine{27 }
\DoxyCodeLine{31       \mbox{\hyperlink{classcytnx_1_1stat_1_1Histogram_a352c96dc863dbe89ed3cd93d9578cf28}{Histogram}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \&Nbins, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \&min\_val, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \&max\_val);}
\DoxyCodeLine{32 }
\DoxyCodeLine{34       \mbox{\hyperlink{classcytnx_1_1stat_1_1Histogram}{Histogram}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1stat_1_1Histogram}{Histogram}} \&rhs) \{}
\DoxyCodeLine{35         this-\/>min = rhs.min;}
\DoxyCodeLine{36         this-\/>max = rhs.max;}
\DoxyCodeLine{37         this-\/>bins = rhs.bins;}
\DoxyCodeLine{38         this-\/>vars = rhs.vars.\mbox{\hyperlink{classcytnx_1_1Storage_aed0530dd20f3fb352d45653ba46a3d50}{clone}}();}
\DoxyCodeLine{39         this-\/>x = rhs.x.\mbox{\hyperlink{classcytnx_1_1Storage_aed0530dd20f3fb352d45653ba46a3d50}{clone}}();}
\DoxyCodeLine{40         this-\/>total\_count = rhs.total\_count;}
\DoxyCodeLine{41       \}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43       \mbox{\hyperlink{classcytnx_1_1stat_1_1Histogram}{Histogram}} \&operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1stat_1_1Histogram}{Histogram}} \&rhs) \{}
\DoxyCodeLine{44         this-\/>min = rhs.min;}
\DoxyCodeLine{45         this-\/>max = rhs.max;}
\DoxyCodeLine{46         this-\/>bins = rhs.bins;}
\DoxyCodeLine{47         this-\/>vars = rhs.vars.\mbox{\hyperlink{classcytnx_1_1Storage_aed0530dd20f3fb352d45653ba46a3d50}{clone}}();}
\DoxyCodeLine{48         this-\/>x = rhs.x.\mbox{\hyperlink{classcytnx_1_1Storage_aed0530dd20f3fb352d45653ba46a3d50}{clone}}();}
\DoxyCodeLine{49         this-\/>total\_count = rhs.total\_count;}
\DoxyCodeLine{50         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{51       \}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54       \textcolor{keywordtype}{void} clear\_vars() \{}
\DoxyCodeLine{55         total\_count = 0;}
\DoxyCodeLine{56         memset(this-\/>vars.data(), 0, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}) * this-\/>vars.\mbox{\hyperlink{classcytnx_1_1Storage_a8e250f87a0ddf93a31ada7b18ae36fa0}{size}}());}
\DoxyCodeLine{57       \}}
\DoxyCodeLine{58 }
\DoxyCodeLine{59       \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{60       \textcolor{keywordtype}{void} accumulate(\textcolor{keyword}{const} std::vector<T> \&data) \{}
\DoxyCodeLine{61         std::vector<T> tmp = data;}
\DoxyCodeLine{62         std::sort(tmp.begin(), tmp.end());}
\DoxyCodeLine{63 }
\DoxyCodeLine{64         uint64\_t cntr = 0;}
\DoxyCodeLine{65         \textcolor{keywordtype}{double} curr\_x = 0;}
\DoxyCodeLine{66         \textcolor{keywordtype}{double} dx = double(max -\/ min) / bins;}
\DoxyCodeLine{67 }
\DoxyCodeLine{68         \textcolor{comment}{// for each elem in data, compare}}
\DoxyCodeLine{69         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} i = 0; i < tmp.size(); i++) \{}
\DoxyCodeLine{70           \textcolor{keywordflow}{while} (cntr <= this-\/>bins) \{}
\DoxyCodeLine{71             \textcolor{keywordflow}{if} (tmp[i] < curr\_x) \{}
\DoxyCodeLine{72               \textcolor{keywordflow}{if} (cntr) \{}
\DoxyCodeLine{73                 vars.at<\textcolor{keywordtype}{double}>(cntr -\/ 1) += 1;}
\DoxyCodeLine{74                 total\_count += 1;}
\DoxyCodeLine{75               \}}
\DoxyCodeLine{76               \textcolor{keywordflow}{break};}
\DoxyCodeLine{77             \}}
\DoxyCodeLine{78             cntr++;}
\DoxyCodeLine{79             curr\_x = cntr * dx;}
\DoxyCodeLine{80           \}}
\DoxyCodeLine{81         \}}
\DoxyCodeLine{82       \}}
\DoxyCodeLine{83 }
\DoxyCodeLine{84       \textcolor{keywordtype}{void} normalize();}
\DoxyCodeLine{85       \textcolor{keywordtype}{void} print() \textcolor{keyword}{const};}
\DoxyCodeLine{86 }
\DoxyCodeLine{87       \textcolor{keyword}{const} Storage \&get\_x()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{88         \textcolor{comment}{// get x}}
\DoxyCodeLine{89         \textcolor{keywordflow}{return} this-\/>x;}
\DoxyCodeLine{90       \}}
\DoxyCodeLine{91       Storage \&get\_x() \{}
\DoxyCodeLine{92         \textcolor{comment}{// get x}}
\DoxyCodeLine{93         \textcolor{keywordflow}{return} this-\/>x;}
\DoxyCodeLine{94       \}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96       cytnx\_uint64 size() \{ \textcolor{keywordflow}{return} this-\/>x.\mbox{\hyperlink{classcytnx_1_1Storage_a8e250f87a0ddf93a31ada7b18ae36fa0}{size}}(); \}}
\DoxyCodeLine{97 }
\DoxyCodeLine{98     \};  \textcolor{comment}{// class histogram}}
\DoxyCodeLine{99 }
\DoxyCodeLine{101     \textcolor{keyword}{class }\mbox{\hyperlink{classcytnx_1_1stat_1_1Histogram2d}{Histogram2d}} \{}
\DoxyCodeLine{102      \textcolor{keyword}{public}:}
\DoxyCodeLine{103       \textcolor{keywordtype}{double} minx, miny;}
\DoxyCodeLine{104       \textcolor{keywordtype}{double} maxx, maxy;}
\DoxyCodeLine{105       uint64\_t binx, biny;}
\DoxyCodeLine{106       \mbox{\hyperlink{classcytnx_1_1Storage}{cytnx::Storage}} vars;}
\DoxyCodeLine{107       \mbox{\hyperlink{classcytnx_1_1Storage}{cytnx::Storage}} x;}
\DoxyCodeLine{108       \mbox{\hyperlink{classcytnx_1_1Storage}{cytnx::Storage}} y;}
\DoxyCodeLine{109 }
\DoxyCodeLine{110       \textcolor{comment}{// std::vector<double> vars;}}
\DoxyCodeLine{111       \textcolor{comment}{// std::vector<double> x;}}
\DoxyCodeLine{112 }
\DoxyCodeLine{113       \textcolor{keywordtype}{double} total\_count;}
\DoxyCodeLine{114 }
\DoxyCodeLine{118       \mbox{\hyperlink{classcytnx_1_1stat_1_1Histogram2d_a9c049e4ebca66b565db0e7d2b133d50c}{Histogram2d}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \&Nbinx, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \&Nbiny,}
\DoxyCodeLine{119                   \textcolor{keyword}{const} \textcolor{keywordtype}{double} \&min\_x, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \&max\_x, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \&min\_y,}
\DoxyCodeLine{120                   \textcolor{keyword}{const} \textcolor{keywordtype}{double} \&max\_y);}
\DoxyCodeLine{121 }
\DoxyCodeLine{123       \mbox{\hyperlink{classcytnx_1_1stat_1_1Histogram2d}{Histogram2d}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1stat_1_1Histogram2d}{Histogram2d}} \&rhs) \{}
\DoxyCodeLine{124         this-\/>minx = rhs.minx;}
\DoxyCodeLine{125         this-\/>maxx = rhs.maxx;}
\DoxyCodeLine{126         this-\/>miny = rhs.miny;}
\DoxyCodeLine{127         this-\/>maxy = rhs.maxy;}
\DoxyCodeLine{128         this-\/>binx = rhs.binx;}
\DoxyCodeLine{129         this-\/>biny = rhs.biny;}
\DoxyCodeLine{130         this-\/>vars = rhs.vars.\mbox{\hyperlink{classcytnx_1_1Storage_aed0530dd20f3fb352d45653ba46a3d50}{clone}}();}
\DoxyCodeLine{131         this-\/>x = rhs.x.\mbox{\hyperlink{classcytnx_1_1Storage_aed0530dd20f3fb352d45653ba46a3d50}{clone}}();}
\DoxyCodeLine{132         this-\/>y = rhs.y.\mbox{\hyperlink{classcytnx_1_1Storage_aed0530dd20f3fb352d45653ba46a3d50}{clone}}();}
\DoxyCodeLine{133         this-\/>total\_count = rhs.total\_count;}
\DoxyCodeLine{134       \}}
\DoxyCodeLine{135 }
\DoxyCodeLine{136       \mbox{\hyperlink{classcytnx_1_1stat_1_1Histogram2d}{Histogram2d}} \&operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1stat_1_1Histogram2d}{Histogram2d}} \&rhs) \{}
\DoxyCodeLine{137         this-\/>minx = rhs.minx;}
\DoxyCodeLine{138         this-\/>maxx = rhs.maxx;}
\DoxyCodeLine{139         this-\/>miny = rhs.miny;}
\DoxyCodeLine{140         this-\/>maxy = rhs.maxy;}
\DoxyCodeLine{141         this-\/>binx = rhs.binx;}
\DoxyCodeLine{142         this-\/>biny = rhs.biny;}
\DoxyCodeLine{143         this-\/>vars = rhs.vars.\mbox{\hyperlink{classcytnx_1_1Storage_aed0530dd20f3fb352d45653ba46a3d50}{clone}}();}
\DoxyCodeLine{144         this-\/>x = rhs.x.\mbox{\hyperlink{classcytnx_1_1Storage_aed0530dd20f3fb352d45653ba46a3d50}{clone}}();}
\DoxyCodeLine{145         this-\/>y = rhs.y.\mbox{\hyperlink{classcytnx_1_1Storage_aed0530dd20f3fb352d45653ba46a3d50}{clone}}();}
\DoxyCodeLine{146         this-\/>total\_count = rhs.total\_count;}
\DoxyCodeLine{147         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{148       \}}
\DoxyCodeLine{150 }
\DoxyCodeLine{151       \textcolor{keywordtype}{void} clear\_vars() \{}
\DoxyCodeLine{152         total\_count = 0;}
\DoxyCodeLine{153         memset(this-\/>vars.data(), 0, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}) * this-\/>vars.\mbox{\hyperlink{classcytnx_1_1Storage_a8e250f87a0ddf93a31ada7b18ae36fa0}{size}}());}
\DoxyCodeLine{154       \}}
\DoxyCodeLine{155 }
\DoxyCodeLine{156       \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{157       \textcolor{keywordtype}{void} accumulate(\textcolor{keyword}{const} std::vector<T> \&data\_x, \textcolor{keyword}{const} std::vector<T> \&data\_y) \{}
\DoxyCodeLine{158         \textcolor{comment}{//[not fin!]}}
\DoxyCodeLine{159         cytnx\_error\_msg(}
\DoxyCodeLine{160           data\_x.size() != data\_y.size(),}
\DoxyCodeLine{161           \textcolor{stringliteral}{"{}[ERROR][Histogram2d::accumulate] data\_x and data\_y should have same size!\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{162 }
\DoxyCodeLine{163         \textcolor{keywordtype}{double} dx = double(maxx -\/ minx) / binx;}
\DoxyCodeLine{164         \textcolor{keywordtype}{double} dy = double(maxy -\/ miny) / biny;}
\DoxyCodeLine{165 }
\DoxyCodeLine{166         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nx, ny;}
\DoxyCodeLine{167 }
\DoxyCodeLine{168         \textcolor{comment}{// for each elem in data, compare}}
\DoxyCodeLine{169         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} i = 0; i < data\_x.size(); i++) \{}
\DoxyCodeLine{170           nx = floor(data\_x[i] / dx);}
\DoxyCodeLine{171           ny = floor(data\_y[i] / dy);}
\DoxyCodeLine{172           vars.at<\textcolor{keywordtype}{double}>(ny * binx + nx) += 1;}
\DoxyCodeLine{173           total\_count += 1;}
\DoxyCodeLine{174         \}}
\DoxyCodeLine{175       \}}
\DoxyCodeLine{176 }
\DoxyCodeLine{177       \textcolor{keywordtype}{void} normalize();}
\DoxyCodeLine{178       \textcolor{keywordtype}{void} print() \textcolor{keyword}{const};}
\DoxyCodeLine{179 }
\DoxyCodeLine{180       \textcolor{keyword}{const} Storage \&get\_x()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{181         \textcolor{comment}{// get x}}
\DoxyCodeLine{182         \textcolor{keywordflow}{return} this-\/>x;}
\DoxyCodeLine{183       \}}
\DoxyCodeLine{184       Storage \&get\_x() \{}
\DoxyCodeLine{185         \textcolor{comment}{// get x}}
\DoxyCodeLine{186         \textcolor{keywordflow}{return} this-\/>x;}
\DoxyCodeLine{187       \}}
\DoxyCodeLine{188 }
\DoxyCodeLine{189       \textcolor{keyword}{const} Storage \&get\_y()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{190         \textcolor{comment}{// get y}}
\DoxyCodeLine{191         \textcolor{keywordflow}{return} this-\/>y;}
\DoxyCodeLine{192       \}}
\DoxyCodeLine{193       Storage \&get\_y() \{}
\DoxyCodeLine{194         \textcolor{comment}{// get y}}
\DoxyCodeLine{195         \textcolor{keywordflow}{return} this-\/>y;}
\DoxyCodeLine{196       \}}
\DoxyCodeLine{197 }
\DoxyCodeLine{198       std::vector<cytnx\_uint64> size() \{}
\DoxyCodeLine{199         \textcolor{keywordflow}{return} std::vector<cytnx\_uint64>(\{this-\/>x.\mbox{\hyperlink{classcytnx_1_1Storage_a8e250f87a0ddf93a31ada7b18ae36fa0}{size}}(), this-\/>y.\mbox{\hyperlink{classcytnx_1_1Storage_a8e250f87a0ddf93a31ada7b18ae36fa0}{size}}()\});}
\DoxyCodeLine{200       \}}
\DoxyCodeLine{201 }
\DoxyCodeLine{202     \};  \textcolor{comment}{// class histogram}}
\DoxyCodeLine{203 }
\DoxyCodeLine{204     \textcolor{comment}{// function, statistical:}}
\DoxyCodeLine{205     \textcolor{comment}{// class Boostrap\{}}
\DoxyCodeLine{206 }
\DoxyCodeLine{207     \textcolor{comment}{//\};//class bootstrap}}
\DoxyCodeLine{208 }
\DoxyCodeLine{209   \}  \textcolor{comment}{// namespace stat}}
\DoxyCodeLine{210 \}  \textcolor{comment}{// namespace cytnx}}
\DoxyCodeLine{211 }
\DoxyCodeLine{212 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
