\hypertarget{MPS_8hpp_source}{}\doxysection{MPS.\+hpp}
\label{MPS_8hpp_source}\index{include/tn\_algo/MPS.hpp@{include/tn\_algo/MPS.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef \_H\_MPS\_}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define \_H\_MPS\_}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}cytnx\_error.hpp"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}Device.hpp"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}intrusive\_ptr\_base.hpp"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}UniTensor.hpp"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include "{}utils/vec\_clone.hpp"{}}}
\DoxyCodeLine{12 \textcolor{comment}{//\#include "{}utils/dynamic\_arg\_resolver.hpp"{}}}
\DoxyCodeLine{13 \textcolor{comment}{//\#include "{}linalg.hpp"{}}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}Accessor.hpp"{}}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <initializer\_list>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include "{}Scalar.hpp"{}}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{keyword}{namespace }cytnx \{}
\DoxyCodeLine{21   \textcolor{keyword}{namespace }tn\_algo \{}
\DoxyCodeLine{22 }
\DoxyCodeLine{24     \textcolor{keyword}{class }MPSType\_class \{}
\DoxyCodeLine{25      \textcolor{keyword}{public}:}
\DoxyCodeLine{26       enum : \textcolor{keywordtype}{int} \{}
\DoxyCodeLine{27         Void = -\/99,}
\DoxyCodeLine{28         RegularMPS = 0,}
\DoxyCodeLine{29         iMPS = 1,}
\DoxyCodeLine{30       \};}
\DoxyCodeLine{31       std::string getname(\textcolor{keyword}{const} \textcolor{keywordtype}{int} \&mps\_type);}
\DoxyCodeLine{32     \};}
\DoxyCodeLine{33     \textcolor{keyword}{extern} MPSType\_class MPSType;}
\DoxyCodeLine{34 }
\DoxyCodeLine{35     \textcolor{keyword}{class }MPS\_impl : \textcolor{keyword}{public} intrusive\_ptr\_base<MPS\_impl> \{}
\DoxyCodeLine{36      \textcolor{keyword}{private}:}
\DoxyCodeLine{37      \textcolor{keyword}{public}:}
\DoxyCodeLine{38       \textcolor{keyword}{friend} \textcolor{keyword}{class }MPS;}
\DoxyCodeLine{39 }
\DoxyCodeLine{40       \textcolor{comment}{// std::vector<cytnx\_int64> phys\_dim;}}
\DoxyCodeLine{41       cytnx\_int64 virt\_dim;  \textcolor{comment}{// maximum}}
\DoxyCodeLine{42       cytnx\_int64 S\_loc;}
\DoxyCodeLine{43 }
\DoxyCodeLine{44       \textcolor{keywordtype}{int} mps\_type\_id;}
\DoxyCodeLine{45 }
\DoxyCodeLine{46       MPS\_impl() : mps\_type\_id(MPSType.Void) \{\}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48       \textcolor{comment}{// place holder for the tensors:}}
\DoxyCodeLine{49       std::vector<UniTensor> \_TNs;}
\DoxyCodeLine{50 }
\DoxyCodeLine{51       std::vector<UniTensor> \&get\_data() \{ \textcolor{keywordflow}{return} this-\/>\_TNs; \}}
\DoxyCodeLine{52 }
\DoxyCodeLine{53       \textcolor{keyword}{virtual} Scalar norm() \textcolor{keyword}{const};}
\DoxyCodeLine{54       \textcolor{keyword}{virtual} boost::intrusive\_ptr<MPS\_impl> clone() \textcolor{keyword}{const};}
\DoxyCodeLine{55       \textcolor{keyword}{virtual} std::ostream \&Print(std::ostream \&os);}
\DoxyCodeLine{56       \textcolor{keyword}{virtual} cytnx\_uint64 size() \{ \textcolor{keywordflow}{return} 0; \};}
\DoxyCodeLine{57       \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Init(\textcolor{keyword}{const} cytnx\_uint64 \&N, \textcolor{keyword}{const} std::vector<cytnx\_uint64> \&phys\_dim,}
\DoxyCodeLine{58                         \textcolor{keyword}{const} cytnx\_uint64 \&virt\_dim, \textcolor{keyword}{const} cytnx\_int64 \&dtype);}
\DoxyCodeLine{59       \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Init\_Msector(\textcolor{keyword}{const} cytnx\_uint64 \&N, \textcolor{keyword}{const} std::vector<cytnx\_uint64> \&phys\_dim,}
\DoxyCodeLine{60                                 \textcolor{keyword}{const} cytnx\_uint64 \&virt\_dim,}
\DoxyCodeLine{61                                 \textcolor{keyword}{const} std::vector<cytnx\_int64> \&select, \textcolor{keyword}{const} cytnx\_int64 \&dtype);}
\DoxyCodeLine{62       \textcolor{comment}{// virtual void Init\_prodstate(const std::vector<cytnx\_uint64> \&phys\_dim, const}}
\DoxyCodeLine{63       \textcolor{comment}{// std::vector<cytnx\_uint64> cstate, const cytnx\_int64 \&dtype);}}
\DoxyCodeLine{64 }
\DoxyCodeLine{65       \textcolor{comment}{// for finite MPS:}}
\DoxyCodeLine{66 }
\DoxyCodeLine{67       \textcolor{comment}{// virtual void Init\_prodstate(const std::vector<cytnx\_uint64> \&phys\_dim, const cytnx\_uint64}}
\DoxyCodeLine{68       \textcolor{comment}{// \&virt\_dim, const std::vector<std::vector<cytnx\_int64> > \&state\_qnums, const cytnx\_int64}}
\DoxyCodeLine{69       \textcolor{comment}{// \&dtype);}}
\DoxyCodeLine{70 }
\DoxyCodeLine{71       \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} Into\_Lortho();}
\DoxyCodeLine{72       \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} S\_mvleft();}
\DoxyCodeLine{73       \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} S\_mvright();}
\DoxyCodeLine{74 }
\DoxyCodeLine{75       \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \_save\_dispatch(std::fstream \&f);}
\DoxyCodeLine{76       \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \_load\_dispatch(std::fstream \&f);}
\DoxyCodeLine{77     \};}
\DoxyCodeLine{78 }
\DoxyCodeLine{79     \textcolor{comment}{// finite size:}}
\DoxyCodeLine{80     \textcolor{keyword}{class }RegularMPS : \textcolor{keyword}{public} MPS\_impl \{}
\DoxyCodeLine{81      \textcolor{keyword}{public}:}
\DoxyCodeLine{82       \textcolor{comment}{// only for this:}}
\DoxyCodeLine{83       RegularMPS() \{}
\DoxyCodeLine{84         this-\/>mps\_type\_id = MPSType.RegularMPS;}
\DoxyCodeLine{85         this-\/>S\_loc = 0;}
\DoxyCodeLine{86         this-\/>virt\_dim = -\/1;}
\DoxyCodeLine{87       \};}
\DoxyCodeLine{88 }
\DoxyCodeLine{89       \textcolor{comment}{// specialization:}}
\DoxyCodeLine{90       std::ostream \&Print(std::ostream \&os);}
\DoxyCodeLine{91       cytnx\_uint64 size() \{ \textcolor{keywordflow}{return} this-\/>\_TNs.size(); \};}
\DoxyCodeLine{92       \textcolor{keywordtype}{void} Init(\textcolor{keyword}{const} cytnx\_uint64 \&N, \textcolor{keyword}{const} std::vector<cytnx\_uint64> \&phys\_dim,}
\DoxyCodeLine{93                 \textcolor{keyword}{const} cytnx\_uint64 \&virt\_dim, \textcolor{keyword}{const} cytnx\_int64 \&dtype);}
\DoxyCodeLine{94       \textcolor{keywordtype}{void} Init\_Msector(\textcolor{keyword}{const} cytnx\_uint64 \&N, \textcolor{keyword}{const} std::vector<cytnx\_uint64> \&phys\_dim,}
\DoxyCodeLine{95                         \textcolor{keyword}{const} cytnx\_uint64 \&virt\_dim, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&select,}
\DoxyCodeLine{96                         \textcolor{keyword}{const} cytnx\_int64 \&dtype);}
\DoxyCodeLine{97       \textcolor{comment}{// void Init\_prodstate(const std::vector<cytnx\_uint64> \&phys\_dim, const}}
\DoxyCodeLine{98       \textcolor{comment}{// std::vector<cytnx\_uint64> cstate, const cytnx\_int64 \&dtype);}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100       \textcolor{comment}{// void Init\_prodstate(const std::vector<cytnx\_uint64> \&phys\_dim, const cytnx\_uint64}}
\DoxyCodeLine{101       \textcolor{comment}{// \&virt\_dim, const std::vector<std::vector<cytnx\_int64> >\&state\_qnums, const cytnx\_int64}}
\DoxyCodeLine{102       \textcolor{comment}{// \&dtype);}}
\DoxyCodeLine{103 }
\DoxyCodeLine{104       \textcolor{keywordtype}{void} Into\_Lortho();}
\DoxyCodeLine{105       \textcolor{keywordtype}{void} S\_mvleft();}
\DoxyCodeLine{106       \textcolor{keywordtype}{void} S\_mvright();}
\DoxyCodeLine{107 }
\DoxyCodeLine{108       Scalar norm() \textcolor{keyword}{const};}
\DoxyCodeLine{109       boost::intrusive\_ptr<MPS\_impl> clone()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{110         boost::intrusive\_ptr<MPS\_impl> out(\textcolor{keyword}{new} RegularMPS());}
\DoxyCodeLine{111         out-\/>S\_loc = this-\/>S\_loc;}
\DoxyCodeLine{112         out-\/>virt\_dim = this-\/>virt\_dim;}
\DoxyCodeLine{113         out-\/>\_TNs = vec\_clone(this-\/>\_TNs);}
\DoxyCodeLine{114         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{115       \}}
\DoxyCodeLine{116 }
\DoxyCodeLine{117       \textcolor{keywordtype}{void} \_save\_dispatch(std::fstream \&f);}
\DoxyCodeLine{118       \textcolor{keywordtype}{void} \_load\_dispatch(std::fstream \&f);}
\DoxyCodeLine{119     \};}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     \textcolor{comment}{// infinite size:}}
\DoxyCodeLine{122     \textcolor{keyword}{class }iMPS : \textcolor{keyword}{public} MPS\_impl \{}
\DoxyCodeLine{123      \textcolor{keyword}{public}:}
\DoxyCodeLine{124       \textcolor{comment}{// only for this:}}
\DoxyCodeLine{125       iMPS() \{}
\DoxyCodeLine{126         this-\/>mps\_type\_id = MPSType.iMPS;}
\DoxyCodeLine{127         this-\/>virt\_dim = -\/1;}
\DoxyCodeLine{128       \};}
\DoxyCodeLine{129 }
\DoxyCodeLine{130       \textcolor{comment}{// specialization:}}
\DoxyCodeLine{131       std::ostream \&Print(std::ostream \&os);}
\DoxyCodeLine{132       cytnx\_uint64 size() \{ \textcolor{keywordflow}{return} this-\/>\_TNs.size(); \};}
\DoxyCodeLine{133       \textcolor{keywordtype}{void} Init(\textcolor{keyword}{const} cytnx\_uint64 \&N, \textcolor{keyword}{const} std::vector<cytnx\_uint64> \&phys\_dim,}
\DoxyCodeLine{134                 \textcolor{keyword}{const} cytnx\_uint64 \&virt\_dim, \textcolor{keyword}{const} cytnx\_int64 \&dtype);}
\DoxyCodeLine{135       \textcolor{keywordtype}{void} Init\_Msector(\textcolor{keyword}{const} cytnx\_uint64 \&N, \textcolor{keyword}{const} std::vector<cytnx\_uint64> \&phys\_dim,}
\DoxyCodeLine{136                         \textcolor{keyword}{const} cytnx\_uint64 \&virt\_dim, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&select,}
\DoxyCodeLine{137                         \textcolor{keyword}{const} cytnx\_int64 \&dtype) \{}
\DoxyCodeLine{138         cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][MPS][type=iMPS] cannot call Init\_Msector\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{139       \}}
\DoxyCodeLine{140       \textcolor{comment}{// void Init\_prodstate(const std::vector<cytnx\_uint64> \&phys\_dim, const}}
\DoxyCodeLine{141       \textcolor{comment}{// std::vector<cytnx\_uint64> cstate, const cytnx\_int64 \&dtype);}}
\DoxyCodeLine{142       \textcolor{comment}{//     cytnx\_error\_msg(true,"{}[ERROR][MPS][type=iMPS] cannot call prodstate\%s"{},"{}\(\backslash\)n"{});}}
\DoxyCodeLine{143       \textcolor{comment}{// \}}}
\DoxyCodeLine{144       \textcolor{keywordtype}{void} Into\_Lortho() \{}
\DoxyCodeLine{145         cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][MPS][type=iMPS] cannot call Into\_Lortho\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{146       \}}
\DoxyCodeLine{147       \textcolor{keywordtype}{void} S\_mvleft() \{}
\DoxyCodeLine{148         cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][MPS][type=iMPS] cannot call S\_mvleft\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{149       \}}
\DoxyCodeLine{150       \textcolor{keywordtype}{void} S\_mvright() \{}
\DoxyCodeLine{151         cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR][MPS][type=iMPS] cannot call S\_mvright\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{152       \}}
\DoxyCodeLine{153       boost::intrusive\_ptr<MPS\_impl> clone()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{154         boost::intrusive\_ptr<MPS\_impl> out(\textcolor{keyword}{new} RegularMPS());}
\DoxyCodeLine{155         out-\/>S\_loc = this-\/>S\_loc;}
\DoxyCodeLine{156         out-\/>virt\_dim = this-\/>virt\_dim;}
\DoxyCodeLine{157         out-\/>\_TNs = vec\_clone(this-\/>\_TNs);}
\DoxyCodeLine{158         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{159       \}}
\DoxyCodeLine{160       Scalar norm() \textcolor{keyword}{const};}
\DoxyCodeLine{161       \textcolor{keywordtype}{void} \_save\_dispatch(std::fstream \&f);}
\DoxyCodeLine{162       \textcolor{keywordtype}{void} \_load\_dispatch(std::fstream \&f);}
\DoxyCodeLine{163     \};}
\DoxyCodeLine{165 }
\DoxyCodeLine{166     \textcolor{comment}{// API}}
\DoxyCodeLine{167     \textcolor{keyword}{class }\mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} \{}
\DoxyCodeLine{168      \textcolor{keyword}{private}:}
\DoxyCodeLine{169      \textcolor{keyword}{public}:}
\DoxyCodeLine{171       boost::intrusive\_ptr<MPS\_impl> \_impl;}
\DoxyCodeLine{172       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}}()}
\DoxyCodeLine{173           : \_impl(\textcolor{keyword}{new} MPS\_impl())\{}
\DoxyCodeLine{174               \textcolor{comment}{// currently default init is RegularMPS;:}}
\DoxyCodeLine{175             \};}
\DoxyCodeLine{176 }
\DoxyCodeLine{177       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}}(\textcolor{keyword}{const} cytnx\_uint64 \&N, \textcolor{keyword}{const} cytnx\_uint64 \&phys\_dim, \textcolor{keyword}{const} cytnx\_uint64 \&virt\_dim,}
\DoxyCodeLine{178           \textcolor{keyword}{const} cytnx\_int64 \&dtype = Type.Double, \textcolor{keyword}{const} cytnx\_int64 \&mps\_type = 0)}
\DoxyCodeLine{179           : \_impl(\textcolor{keyword}{new} MPS\_impl()) \{}
\DoxyCodeLine{180         this-\/>Init(N, phys\_dim, virt\_dim, dtype, mps\_type);}
\DoxyCodeLine{181       \};}
\DoxyCodeLine{182 }
\DoxyCodeLine{183       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}}(\textcolor{keyword}{const} cytnx\_uint64 \&N, \textcolor{keyword}{const} std::vector<cytnx\_uint64> \&vphys\_dim,}
\DoxyCodeLine{184           \textcolor{keyword}{const} cytnx\_uint64 \&virt\_dim, \textcolor{keyword}{const} cytnx\_int64 \&dtype = Type.Double,}
\DoxyCodeLine{185           \textcolor{keyword}{const} cytnx\_int64 \&mps\_type = 0)}
\DoxyCodeLine{186           : \_impl(\textcolor{keyword}{new} MPS\_impl()) \{}
\DoxyCodeLine{187         this-\/>Init(N, vphys\_dim, virt\_dim, dtype, mps\_type);}
\DoxyCodeLine{188       \};}
\DoxyCodeLine{189 }
\DoxyCodeLine{190       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} \&rhs) \{ \_impl = rhs.\_impl; \}}
\DoxyCodeLine{191 }
\DoxyCodeLine{192       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} \&operator=(\textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} \&rhs) \{}
\DoxyCodeLine{193         \_impl = rhs.\_impl;}
\DoxyCodeLine{194         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{195       \}}
\DoxyCodeLine{197 }
\DoxyCodeLine{198       \textcolor{comment}{// Initialization API:}}
\DoxyCodeLine{199       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{200       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} \&Init(\textcolor{keyword}{const} cytnx\_uint64 \&N, \textcolor{keyword}{const} std::vector<cytnx\_uint64> \&vphys\_dim,}
\DoxyCodeLine{201                 \textcolor{keyword}{const} cytnx\_uint64 \&virt\_dim, \textcolor{keyword}{const} cytnx\_int64 \&dtype = Type.Double,}
\DoxyCodeLine{202                 \textcolor{keyword}{const} cytnx\_int64 \&mps\_type = 0) \{}
\DoxyCodeLine{203         \textcolor{keywordflow}{if} (mps\_type == 0) \{}
\DoxyCodeLine{204           this-\/>\_impl = boost::intrusive\_ptr<MPS\_impl>(\textcolor{keyword}{new} RegularMPS());}
\DoxyCodeLine{205         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mps\_type == 1) \{}
\DoxyCodeLine{206           this-\/>\_impl = boost::intrusive\_ptr<MPS\_impl>(\textcolor{keyword}{new} iMPS());}
\DoxyCodeLine{207         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{208           cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR] invalid MPS type.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{209         \}}
\DoxyCodeLine{210         this-\/>\_impl-\/>Init(N, vphys\_dim, virt\_dim, dtype);}
\DoxyCodeLine{211         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{212       \}}
\DoxyCodeLine{213       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} \&Init(\textcolor{keyword}{const} cytnx\_uint64 \&N, \textcolor{keyword}{const} cytnx\_uint64 \&phys\_dim, \textcolor{keyword}{const} cytnx\_uint64 \&virt\_dim,}
\DoxyCodeLine{214                 \textcolor{keyword}{const} cytnx\_int64 \&dtype = Type.Double, \textcolor{keyword}{const} cytnx\_int64 \&mps\_type = 0) \{}
\DoxyCodeLine{215         std::vector<cytnx\_uint64> vphys\_dim(N, phys\_dim);}
\DoxyCodeLine{216 }
\DoxyCodeLine{217         this-\/>Init(N, vphys\_dim, virt\_dim, dtype);}
\DoxyCodeLine{218         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{219       \}}
\DoxyCodeLine{220       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{221 }
\DoxyCodeLine{222       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} \&Init\_Msector(\textcolor{keyword}{const} cytnx\_uint64 \&N, \textcolor{keyword}{const} std::vector<cytnx\_uint64> \&vphys\_dim,}
\DoxyCodeLine{223                         \textcolor{keyword}{const} cytnx\_uint64 \&virt\_dim, \textcolor{keyword}{const} std::vector<cytnx\_int64> \&select,}
\DoxyCodeLine{224                         \textcolor{keyword}{const} cytnx\_int64 \&dtype = Type.Double, \textcolor{keyword}{const} cytnx\_int64 \&mps\_type = 0) \{}
\DoxyCodeLine{225         \textcolor{comment}{// only the select phys index will have non-\/zero element.}}
\DoxyCodeLine{226         \textcolor{keywordflow}{if} (mps\_type == 0) \{}
\DoxyCodeLine{227           this-\/>\_impl = boost::intrusive\_ptr<MPS\_impl>(\textcolor{keyword}{new} RegularMPS());}
\DoxyCodeLine{228         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mps\_type == 1) \{}
\DoxyCodeLine{229           this-\/>\_impl = boost::intrusive\_ptr<MPS\_impl>(\textcolor{keyword}{new} iMPS());}
\DoxyCodeLine{230         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{231           cytnx\_error\_msg(\textcolor{keyword}{true}, \textcolor{stringliteral}{"{}[ERROR] invalid MPS type.\%s"{}}, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{232         \}}
\DoxyCodeLine{233         this-\/>\_impl-\/>Init\_Msector(N, vphys\_dim, virt\_dim, select, dtype);}
\DoxyCodeLine{234         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{235       \}}
\DoxyCodeLine{236 }
\DoxyCodeLine{237       \textcolor{comment}{/*}}
\DoxyCodeLine{238 \textcolor{comment}{      MPS\& Init\_prodstate(const std::vector<cytnx\_uint64> \&phys\_dim, const std::vector<cytnx\_uint64>}}
\DoxyCodeLine{239 \textcolor{comment}{      cstate, const cytnx\_int64 \&dtype)\{}}
\DoxyCodeLine{240 \textcolor{comment}{          // only the select phys index will have non-\/zero element.}}
\DoxyCodeLine{241 \textcolor{comment}{          if(mps\_type==0)\{}}
\DoxyCodeLine{242 \textcolor{comment}{              this-\/>\_impl =boost::intrusive\_ptr<MPS\_impl>(new RegularMPS());}}
\DoxyCodeLine{243 \textcolor{comment}{          \}else if(mps\_type==1)\{}}
\DoxyCodeLine{244 \textcolor{comment}{              this-\/>\_impl =boost::intrusive\_ptr<MPS\_impl>(new iMPS());}}
\DoxyCodeLine{245 \textcolor{comment}{          \}else\{}}
\DoxyCodeLine{246 \textcolor{comment}{              cytnx\_error\_msg(true,"{}[ERROR] invalid MPS type.\%s"{},"{}\(\backslash\)n"{});}}
\DoxyCodeLine{247 \textcolor{comment}{          \}}}
\DoxyCodeLine{248 \textcolor{comment}{          this-\/>\_impl-\/>Init\_prodstate(phys\_dim, cstate, dtype);}}
\DoxyCodeLine{249 \textcolor{comment}{          return *this;}}
\DoxyCodeLine{250 \textcolor{comment}{      \}}}
\DoxyCodeLine{251 \textcolor{comment}{      */}}
\DoxyCodeLine{252 }
\DoxyCodeLine{253       cytnx\_uint64 size() \{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>size(); \}}
\DoxyCodeLine{254 }
\DoxyCodeLine{255       \textcolor{keywordtype}{int} mps\_type()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>mps\_type\_id; \}}
\DoxyCodeLine{256       std::string mps\_type\_str()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} MPSType.getname(this-\/>\_impl-\/>mps\_type\_id); \}}
\DoxyCodeLine{257 }
\DoxyCodeLine{258       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} clone()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{259         \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} out;}
\DoxyCodeLine{260         out.\_impl = this-\/>\_impl-\/>clone();}
\DoxyCodeLine{261         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{262       \}}
\DoxyCodeLine{263 }
\DoxyCodeLine{264       std::vector<UniTensor> \&data() \{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>get\_data(); \};}
\DoxyCodeLine{265 }
\DoxyCodeLine{266       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} \&Into\_Lortho() \{}
\DoxyCodeLine{267         this-\/>\_impl-\/>Into\_Lortho();}
\DoxyCodeLine{268         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{269       \}}
\DoxyCodeLine{270       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} \&S\_mvleft() \{}
\DoxyCodeLine{271         this-\/>\_impl-\/>S\_mvleft();}
\DoxyCodeLine{272         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{273       \}}
\DoxyCodeLine{274       \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} \&S\_mvright() \{}
\DoxyCodeLine{275         this-\/>\_impl-\/>S\_mvright();}
\DoxyCodeLine{276         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{277       \}}
\DoxyCodeLine{278 }
\DoxyCodeLine{279       \mbox{\hyperlink{classcytnx_1_1Scalar}{Scalar}} norm()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>norm(); \}}
\DoxyCodeLine{280 }
\DoxyCodeLine{281       cytnx\_int64 phys\_dim(\textcolor{keyword}{const} cytnx\_int64 \&idx) \{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>\_TNs[idx].shape()[1]; \}}
\DoxyCodeLine{282 }
\DoxyCodeLine{283       cytnx\_int64 \&virt\_dim() \{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>virt\_dim; \}}
\DoxyCodeLine{284 }
\DoxyCodeLine{285       cytnx\_int64 \&S\_loc() \{ \textcolor{keywordflow}{return} this-\/>\_impl-\/>S\_loc; \}}
\DoxyCodeLine{286 }
\DoxyCodeLine{288       \textcolor{keywordtype}{void} \_Save(std::fstream \&f) \textcolor{keyword}{const};}
\DoxyCodeLine{289       \textcolor{keywordtype}{void} \_Load(std::fstream \&f);}
\DoxyCodeLine{291 }
\DoxyCodeLine{292       \textcolor{keywordtype}{void} Save(\textcolor{keyword}{const} std::string \&fname) \textcolor{keyword}{const};}
\DoxyCodeLine{293       \textcolor{keywordtype}{void} Save(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *fname) \textcolor{keyword}{const};}
\DoxyCodeLine{294 }
\DoxyCodeLine{295       \textcolor{keyword}{static} \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} Load(\textcolor{keyword}{const} std::string \&fname);}
\DoxyCodeLine{296       \textcolor{keyword}{static} \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} Load(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *fname);}
\DoxyCodeLine{297     \};}
\DoxyCodeLine{298 }
\DoxyCodeLine{299     std::ostream \&operator<<(std::ostream \&os, \textcolor{keyword}{const} \mbox{\hyperlink{classcytnx_1_1tn__algo_1_1MPS}{MPS}} \&in);}
\DoxyCodeLine{300 }
\DoxyCodeLine{301   \}  \textcolor{comment}{// namespace tn\_algo}}
\DoxyCodeLine{302 \}  \textcolor{comment}{// namespace cytnx}}
\DoxyCodeLine{303 }
\DoxyCodeLine{304 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
